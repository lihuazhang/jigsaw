/* Copyright (C) 2012 Microsoft Corporation */var __LICENSETERMS__='jQuery Observable Subcomponent of JsViews Data change events for data linking See: http://github.com/BorisMoore/jsviews Microsoft grants you the right to use these script files for the sole purpose of either: (i) interacting through your browser with the Microsoft website, subject to the website�s terms of use; or (ii) using the files as bundled with a Microsoft product subject to that product�s license terms. Microsoft reserves all other rights to the files not expressly granted by Microsoft, whether by implication, estoppel or otherwise. The notices and licenses below are for informational purposes only. Copyright (c) Boris Moore and Brad Olenick Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.';(function(a,f){a.observable=function(b){return a.isArray(b)?new d(b):new c(b)};var g=[].splice;function c(a){if(!this.data)return new c(a);this._data=a;return this}a.observable.Object=c;c.prototype={_data:null,data:function(){return this._data},setProperty:function(b,e){if(a.isArray(b))for(var g=0,l=b.length;g<l;g++){var i=b[g];this.setProperty(i.name,i.value)}else if(typeof b==="object")for(var j in b)this.setProperty(j,b[j]);else{var f,d,k=this._data,c=h(k,b);b=c[1];c=c[0];if(c){d=c[b];if(a.isFunction(d)){f=d;d=d.call(c)}if(d!=e){if(f){f.call(c,e);e=f.call(c)}else c[b]=e;a(c).triggerHandler("propertyChange",{path:b,value:e,oldValue:d})}}}return this}};function h(a,b){if(a&&b){var c=b.split(".");b=c.pop();while(a&&c.length)a=a[c.shift()];return [a,b]}return []}function d(a){if(!this.data)return new d(a);this._data=a;return this}function b(c,b){a([c]).triggerHandler("arrayChange",b)}function e(a){if(typeof a!=="number")throw"Invalid index.";}a.observable.Array=d;d.prototype={_data:null,data:function(){return this._data},insert:function(d,c){e(d);if(arguments.length>1){c=a.isArray(c)?c:[c];if(c.length>0){g.apply(this._data,[d,0].concat(c));b(this._data,{change:"insert",index:d,items:c})}}return this},remove:function(c,a){e(c);a=a===f||a===null?1:a;if(a&&c>-1){var d=this._data.slice(c,c+a);a=d.length;if(a){this._data.splice(c,a);b(this._data,{change:"remove",index:c,items:d})}}return this},move:function(c,d,a){e(c);e(d);a=a===f||a===null?1:a;if(a){var g=this._data.slice(c,c+a);this._data.splice(c,a);this._data.splice.apply(this._data,[d,0].concat(g));b(this._data,{change:"move",oldIndex:c,index:d,items:g})}return this},refresh:function(a){var c=this._data.slice(0);g.apply(this._data,[0,this._data.length].concat(a));b(this._data,{change:"refresh",oldItems:c});return this}}})(jQuery);var __LICENSETERMS__='JsRender v1.0pre - (jsrender.js version: does not require jQuery): http://github.com/BorisMoore/jsrenderOptimized version of jQuery Templates, fosr rendering to string, using "codeless" markup.Microsoft grants you the right to use these script files for the sole purpose of either: (i) interacting through your browser with the Microsoft website, subject to the website�s terms of use; or (ii) using the files as bundled with a Microsoft product subject to that product�s license terms. Microsoft reserves all other rights to the files not expressly granted by Microsoft, whether by implication, estoppel or otherwise. The notices and licenses below are for informational purposes only. Copyright (c) Boris Moore Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.';window.JsViews||window.jQuery&&jQuery.views||function(d,k){var b,u,l,a,i,f,h,s,r,c,g=false,n=true,e=d.jQuery,G=d.document,B=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,m=/^(true|false|null|[\d\.]+)|(\w+|\$(view|data|ctx|(\w+)))([\w\.]*)|((['"])(?:\\\1|.)*\7)$/g,D=/(\$?[\w\.\[\]]+)(?:(\()|\s*(===|!==|==|!=|<|>|<=|>=)\s*|\s*(\=)\s*)?|(\,\s*)|\\?(\')|\\?(\")|(\))|(\s+)/g,C=/\r?\n/g,x=/\\(['"])/g,y=/\\?(['"])/g,z=/\x08([^\x08]+)\x08/g,A=0,q={"&":"&amp;","<":"&lt;",">":"&gt;"},v=/[\x00"&'<>]/g,E=Array.prototype.slice;if(e){b=e;b.fn.extend({render:function(c,b,a,d){return f(c,this[0],b,a,d)},template:function(c,a){return b.template(c,this[0],a)}})}else{u=d.$;d.JsViews=l=d.$=b={extend:function(c,b){var a;for(a in b)c[a]=b[a];return c},isArray:Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"},noConflict:function(){if(d.$===l)d.$=u;return l}}}c=b.extend;function o(e,h,b,g,f){b=b||{viewsCount:0,ctx:a.helpers};var d=b&&b.ctx;return {jsViews:"v1.0pre",path:h||"",itemNumber:++b.viewsCount||1,viewsCount:0,tmpl:f,data:g||b.data||{},ctx:e&&e===d?d:d?c(c({},d),e):e||{},parent:b}}c(b,{views:a={templates:{},tags:{"if":function(){var b=this,a=b._view;a.onElse=function(e,b){var c=0,d=b.length;while(d&&!b[c++])if(c===d)return "";a.onElse=k;return f(a.data,e.tmpl,a.ctx,a)};return a.onElse(this,arguments)},"else":function(){var a=this._view;return a.onElse?a.onElse(this,arguments):""},each:function(){var c,a=this,d="",e=arguments,h=e.length,g=a.tmpl,b=a._view;for(c=0;c<h;c++)d+=e[c]?f(e[c],g,a.ctx||b.ctx,b,a._path,a._ctor):"";return h?d:d+f(b.data,g,b.ctx,b,a._path,a.tag)},"=":function(a){return a},"*":function(a){return a}},helpers:{not:function(a){return !a}},allowCode:g,debugMode:n,err:function(b){return a.debugMode?"<br/><b>Error:</b> <em> "+(b.message||b)+". </em>":'""'},setDelimiters:function(c,b){var a=b.charAt(0),d=b.charAt(1);c="\\"+c.charAt(0)+"\\"+c.charAt(1);b="\\"+a+"\\"+d;h=c+"(?:(?:(\\#)?(\\w+(?=[!\\s\\"+a+"]))"+"|(?:(\\=)|(\\*)))"+"\\s*((?:[^\\"+a+"]|\\"+a+"(?!\\"+d+"))*?)"+"(!(\\w*))?"+"|(?:\\/([\\w\\$\\.\\[\\]]+)))"+b;h=new RegExp(h,"g")},registerTags:s=function(b,d){var c;if(typeof b==="object")for(c in b)s(c,b[c]);else a.tags[b]=d;return this},registerHelpers:r=function(b,d){if(typeof b==="object"){var c;for(c in b)r(c,b[c])}else a.helpers[b]=d;return this},encode:function(b,a){return a?(i[b||"html"]||i.html)(a):""},encoders:i={none:function(a){return a},html:function(a){return String(a).replace(v,w)}},renderTag:function(h,g,l,e,b){var f,d,m,j=arguments,i=a.presenters;hash=b._hash,tagFn=a.tags[h];if(!tagFn)return "";e=e&&g.tmpl.nested[e-1];b.tmpl=b.tmpl||e||k;if(i&&i[h]){d=c(c({},b.ctx),b);delete d.ctx;delete d._path;delete d.tmpl;b.ctx=d;b._ctor=h+(hash?"="+hash.slice(0,-1):"");b=c(c({},tagFn),b);tagFn=a.tags.each}b._encode=l;b._view=g;f=tagFn.apply(b,j.length>5?E.call(j,5):[g.data]);return f||(f===k?"":f.toString())}},render:f=function(c,d,g,e,i,n){var j,l,f,m,k,h="";if(arguments.length===2&&c.jsViews){e=c;g=e.ctx;c=e.data}d=b.template(d);if(!d)return "";if(b.isArray(c)){m=new o(g,i,e,c);l=c.length;for(j=0,l=c.length;j<l;j++){f=c[j];k=f?d(f,new o(g,i,m,f,d,this)):"";h+=a.activeViews?"<!--item-->"+k+"<!--/item-->":k}}else h+=d(c,new o(g,i,e,c,d));return a.activeViews?"<!--tmpl("+(i||"")+") "+(n?"tag="+n:d._name)+"-->"+h+"<!--/tmpl-->":h},template:function(d,c){if(c){if(""+c===c)c=t(c);else if(e&&c instanceof b)c=c[0];if(c){if(e&&c.nodeType)c=b.data(c,"tmpl")||b.data(c,"tmpl",t(c.innerHTML));a.templates[c._name=c._name||d||"_"+A++]=c}return c}return d?""+d!==d?d._name?d:b.template(null,d):a.templates[d]||b.template(null,B.test(d)?d:F(d)):null}});a.setDelimiters("{{","}}");function j(h,e,a,c,b,f,d){return a?(c?b?"$view."+b:a:"$data."+a)+(f||""):d||(e||"")}function t(d){var e,k=0,i=[],f=[],c=f,b=[,,f];function l(a){a-=k;if(a)c.push(d.substr(k,a).replace(C,"\\n"))}function o(C,q,f,A,B,d,w,y,v,t){var r,s="",h=0,p=g,o=g;function u(e,a,k,c,q,i,b,d,f,l){return o?(o=!b,o?e:'"'):p?(p=!d,p?e:'"'):c?a.replace(m,j)+c:q?h?"":(r=n,"\b"+a+":"):k?(h++,a.replace(m,j)+"("):f?(h--,")"):a?a.replace(m,j):i?",":l?h?"":r?(r=g,"\b"):",":(o=b,p=d,'"')}f=f||A;l(t);if(B){if(a.allowCode)c.push(["*",d.replace(x,"$1")])}else if(f){if(f==="else"){b=i.pop();c=b[2];q=n}d=d?(d+" ").replace(D,u).replace(z,function(c,a){s+=a+",";return ""}):"";d=d.slice(0,-1);e=[f,w?y||"none":"",q&&[],"{"+s+"_hash:'"+s+"',_path:'"+d+"'}",d];if(q){i.push(b);b=e}c.push(e)}else if(v)b=i.pop();k=t+C.length;if(!b)throw"Expected block tag";c=b[2]}d=d.replace(y,"\\$1");d.replace(h,o);l(d.length);return p(f)}function p(k){var j,a,b,h=[],m=k.length,d="try{var views="+(e?"jQuery":"JsViews")+'.views,tag=views.renderTag,enc=views.encode,html=views.encoders.html,$ctx=$view && $view.ctx,result=""+\n\n';for(b=0;b<m;b++){a=k[b];if(a[0]==="*")d=d.slice(0,b?-1:-3)+";"+a[1]+(b+1<m?"result+=":"");else if(""+a===a)d+='"'+a+'"+';else{var l=a[0],c=a[1],g=a[2],n=a[3],i=a[4],f=i+'||"")+';if(g)h.push(p(g));d+=l==="="?!c||c==="html"?"html("+f:c==="none"?"("+f:'enc("'+c+'",'+f:'tag("'+l+'",$view,"'+(c||"")+'",'+(g?h.length:'""')+","+n+(i?",":"")+i+")+"}}j=new Function("$data, $view",d.slice(0,-1)+";return result;\n\n}catch(e){return views.err(e);}");j.nested=h;return j}function w(a){return q[a]||(q[a]="&#"+a.charCodeAt(0)+";")}function F(a){try{return b(a)}catch(c){}return a}}(window);var __LICENSETERMS__='JsViews v1.0pre jQuery plugin providing interactive data-driven views, based on integration between jQuery Templates and jQuery Data Link. Requires jquery.render.js (optimized version of jQuery Templates, for rendering to string)     See JsRender at http://github.com/BorisMoore/jsrender and jquery.observable.js.     See JsViews at http://github.com/BorisMoore/jsviews Microsoft grants you the right to use these script files for the sole purpose of either: (i) interacting through your browser with the Microsoft website, subject to the website�s terms of use; or (ii) using the files as bundled with a Microsoft product subject to that product�s license terms. Microsoft reserves all other rights to the files not expressly granted by Microsoft, whether by implication, estoppel or otherwise. The notices and licenses below are for informational purposes only. Copyright (c) Boris Moore Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.';(function(a,b){var f=false,e=true,h,c,D,B=a.cleanData,u={value:"val",html:"html",text:"text"},m="_jsvData";function z(p){var w,v,d,x,e,r,h,g,n,j,q=this.target,i=p.target,s=a(i),m=a.view(i),z=this.links,t=m.ctx,y=t.beforeChange,A=z.length;while(A--&&!v){g=z[A];if(!g.filter||g.filter&&s.is(g.filter)){d=g.fromAttr;if(!d){d=c.merge[i.nodeName.toLowerCase()];d=d?d.from.fromAttr:"text"}w=u[d];h=a.isFunction(d)?d(i):w?s[w]():s.attr(d);if((!y||!(v=y.call(m,p)===f))&&h!==b){e=g.to||a.trim(i.getAttribute(c.linkToAttr));if(e){n=g.convert;e=l(e);j=e[0].slice(0,-1);q=m&&m.data||q;j=k(q,m,j);n=e[3];x=a.trim(e[1].slice(0,-1));r={source:i,target:j,convert:n,path:x};if(n)h=o(r,q,m,n,h);if(h!==b&&j){a.observable(j).setProperty(x,h);if(t.afterChange)t.afterChange.call(r,p)}p.stopPropagation()}}if(v)p.stopImmediatePropagation()}}}function x(m,e){var q,i,y,h,b,d,s,k=this,j=k.target,g=a(j),v=m.target,x=e&&e.path||m.path,l=a.view(j),r=l.ctx,t=r.beforeChange,p=n(j,v).paths[x],w=p&&p.length;while(w--){q=p[w];if((!t||!(e&&(y=t.call(this,m,e)===f)))&&(!l||l.onDataChanged(e)!==f)){b=q.attr;d=o(k,k.source,l,q.expr,e&&e.value);if(a.isFunction(d))d=d.call(v);if(!b){b=c.merge[j.nodeName.toLowerCase()];b=b?b.to.toAttr:"text"}if(s=b.indexOf("css-")===0&&b.substr(4)){if(h=g.css(s)!==d)g.css(s,d)}else{i=u[b];if(i){if(h=g[i]()!==d)g[i](d)}else if(h=g.attr(b)!==d)g.attr(b,d)}if(e&&h&&r.afterChange)r.afterChange.call(k,m,e)}}}function y(g,a){var i,d=this.ctx,e=d.beforeChange,h=a?a.change:c.linkToAttr;if((!e||!(i=e.call(this,g,a)===f))&&h!==b){this.onDataChanged(a);if(d.afterChange)d.afterChange.call(this,g,a)}}function j(d){var e,c=d.data,b=d._onArrayChange;if(b){if(b[1]===c)return;a([b[1]]).unbind("arrayChange",b[0])}if(a.isArray(c)){e=function(){y.apply(d,arguments)};a([c]).bind("arrayChange",e);d._onArrayChange=[e,c]}}function t(d,c,f){var b=d.parent&&d.parent.ctx,e=d._ctx;d.ctx=f?e&&b?a.extend({},b,e):b||e:c&&c!==b?(d._ctx=c,b?a.extend({},b,c):c):b}function i(l,n,o,i,d,u,e){var h,g,s,m,r,f,q,b=this;a.extend(b,{views:[],nodes:n?[]:[document.body],tmpl:i||d&&d.tmpl,path:o,parent:d,prevNode:n,parentElem:n&&n.parentNode});if(d){h=d.views;u.push(b);e=e||d.data;if(a.isArray(d.data)){b.index=g=o;h.splice(g,0,b);s=h.length;e=e[g];while(g++<s-1)a.observable(h[g]).setProperty("index",g);b.tag=d.tag}else{if(o){e=p(e,d,o);l=l||e[1];e=e[0]}b.index=h.length;h.push(b);if(l.tag)b.tag=[l.tag];else{i=i.split("=");if(i.shift()==="tag")b.tag=i}}}b.data=e;t(b,l);j(b);if((m=b.tag)&&!a.isArray(e)){f=c.tags[m[0]];if(f&&f.presenter){r=f.ctx||{};q=m[1]?k(d.data,d,"{"+m[1]+"}"):d.ctx;a.extend(q,f.options||{});r[m[0]]=new f.presenter(q,b);b.context(r)}}}function g(f,q,p,A,m,k,y,s){var l,n,j,x,w,E,D,C,B,z,t,h=q,o=A;k=k||{};s=s||0;f=y||f;if(!y&&f.nodeType===1){if(o++===0)h.nodes.push(f);var u=f.getAttribute(c.linkFromAttr),v=f.getAttribute(c.getFromAttr);if(u||v)r(m||q.data,f,v,u,e);f=f.firstChild}else f=f.nextSibling;while(f&&f!==p){if(f.nodeType===1)g(f,h,p,o,m,k);else if(f.nodeType===8&&(l=/^(\/?)(?:(item)|(?:(tmpl)(?:\((.*)\))?(?:\s+([^\s]+))?))$/.exec(f.nodeValue))){w=f.parentNode;if(l[1]){h.nextNode=f;if((z=h.tag)&&(t=h.ctx[z[0]])&&t.onAfterCreate)t.onAfterCreate();if(h.ctx.onAfterCreate)h.ctx.onAfterCreate.call(h,h);if(l[2])h=q;else return f}else{n=n||d(w,"view",e);if(l[2])h=new i(k,f,s++,b,h,n);else{j=a.view(f);if(j&&j.prevNode===f)if(j.data===m)x=j.nextNode;else{j.data=m;j.render(k);return j.nextNode}else j=new i(k,f,l[4],l[5],h,n,m);f=x||g(f,j,p,0)}}}else if(o===0)h.nodes.push(f);f=f.nextSibling}}function p(d,b,c){return Function("$","$data","$view","$ctx","with($data){return ["+c+"];}")(a,d,b,b.ctx)}function o(d,e,b,c,f){try{return Function("$","$data","$view","$ctx","$value","with($data){return "+c+";}").call(d,a,e,b,b.ctx,f)}catch(g){throw g.message;}}function k(c,d,b){try{return b?Function("$","$data","$view","$ctx","with($data){return "+b+";}")(a,c,d,d.ctx):c}catch(e){throw e.message;}}function w(l,m,f,o){var c,k,n,h,j,i,e;if(f){f=a.isArray(f)?f:[f];h=[];j=[];e=f.length;while(e--){c=f[e];if(c.to)h.push({to:c.to,filter:c.filter});if(c.from||c.getFrom)j.push(c)}e=j.length;while(e--){c=j[e];k=c.filter;n=k?l.find(k).add(a(this).filter(k)):l;n.each(function(){r(m,this,c.getFrom,c.from)})}}if(!f||h.length)l.each(function(){if(!f){i=d(this,"to");e=i.length;while(e--){c=i[e];if(c.links===declLinkTo){if(c.target===m)return;q(this,declLinkTo);i.splice(e,1)}}h=declLinkTo;g(this,a.view(this),b,b,m,o)}A(this,m,h)});return l}function r(q,x,u,n){var b,d,h,g,j,r,i,B,p,f,A,m=[],c="";n=l((n?n+",":"")+(u?"|,"+u+",":""),e);while(b=n.shift()){g=b.length;j=b.charAt(g-1);b=b.slice(0,-1);switch(j){case ":":r=a.trim(b);break;case "[":c=a.trim(b);break;case ")":c=c||b;break;case "]":m=[[c,b]];c=c?c+"."+b:b;c+=a.isFunction(q[b])?"()":"";break;case "\r":i=++b;break;case ",":if(b==="|")B=e;else{if(i){f=c.slice(i);f=l(f);for(h=0,g=f.length;h<g;h++){d=a.trim(f[h]);j=d.charAt(d.length-1);d=d.slice(0,-1);if(j==="[")f[h]=p=d;else if(j==="]"){m.push([p,d]);f[h]=p?"."+d:d;f[h]+=a.isFunction(q[d])?"()":"";p=""}}c=c.slice(0,i)+f.join("")+")"}c+=b;A=a.view(x);g=m.length;while(g--){var v=m[g],z=v[1],w=k(q,A,v[0]),y={source:q,target:x},t=z.split("."),o=w;while(t.length>1){o=o[t.shift()];if(o)s(o,y,t.join("."),c,r)}s(w,y,z,c,r,!g&&B)}i=0;m=[];r=c=""}}}}function s(f,l,g,o,m,p){var i,j,b,h=l.target,c=n(h,f),k={attr:m,expr:o};if(c){j=c.paths[g]=c.paths[g]||[];j.push(k);b=c.handler}else{b=function(){x.apply(l,arguments)};if(h){i={};i[g]=[k];d(h,"from",e).push({source:f,paths:i,handler:b})}a(f).bind("propertyChange",b)}if(p)b({target:f,path:g})}function A(c,f,g){var b=function(){z.apply({target:f,links:g},arguments)};d(c,"to",e).push({target:f,links:g,handler:b});a(c).bind("change",b)}function q(f,g){var c,b=d(f,"to"),e=b.length;while(e--){c=b[e];if(c.links===g){a(f).unbind("change",c.handler);b.splice(e,1)}}}function n(f,e){var a,b=d(f,"from"),c=b.length;while(c--){a=b[c];if(a.source===e)return a}}function v(g){var h,e,b,f,d,i,c=a.cache[g[a.expando]];c=c&&c.data;linksAndViews=c&&c[m];if(linksAndViews){if(linksAndViews.to.length)a(g).unbind("change");e=linksAndViews.from;b=e.length;while(b--){h=e[b];a(h.source).unbind("propertyChange",h.handler)}f=linksAndViews.view;if(b=f.length){d=a.view(g);while(b--){i=f[b];if(i.parent===d)d.removeViews(i.index,1)}}}}function d(c,e,d){var b=a.data(c,m)||d&&a.data(c,m,{view:[],from:[],to:[]});return b?b[e]:[]}function l(a,h){var c,d=0,b=0,g=f,e=f;a=a.replace(/\s+/g," ");return a.replace(/(\))|([\:\,])|(\')|(\")|([\(\[\{])|([\}\]])/g,function(f,o,n,j,k,m,l,i){if(e){e=!j;return f}if(g){g=!k;return f}if(o)return --b?f:h&&a.charAt(i+1)===","?(c-=d,d=i,f+"\t"+c+"\r\t"):f;if(n)return b?f:(d=i+1,f+"\t");if(m){if(b++)return f;if(f==="(")c=i;return f!=="["?f:"[\t"}if(l)return --b||f!=="]"?f:"]\t";e=j;g=k;return f}).split("\t")}function C(b){return b.type==="checkbox"?b.checked:a(b).val()}a.extend({view:function(b,o){var c,f,g,k,j,m=/^item|^tmpl(\(\$?[\w\.\(\)\$,\"\']*\))?(\s+[^\s]+)?$/,l=document.body,n=b;if(o){j=b.nextSibling||b.parentNode;while(j!==(b=b.firstChild||b.nextSibling||b.parentNode.nextSibling))if(b.nodeType===8&&m.test(b.nodeValue)){f=a.view(b);if(f.prevNode===b)return f}return}b=b||l;if(h&&!h.views.length)c=h;else{while(!(g=d(j=b.parentNode||l,"view")).length){if(!j||b===l){d(l.parentNode,"view",e).push(c=h=new i);h.ctx={};break}b=j}if(!c&&b===l)c=g[0];while(!c&&b){if(b.nodeType===8)if(/^\/item|^\/tmpl$/.test(b.nodeValue)){k=g.length;while(k--){f=g[k];if(f.nextNode===b){c=b===n&&f;b=f.prevNode;break}}}else if(m.test(b.nodeValue)){k=g.length;while(k--){f=g[k];if(f.prevNode===b){c=f;break}}}b=b.previousSibling}c=c||a.view(j)}return c},cleanData:function(b){var c=b.length;while(c--)v(b[c]);B.call(a,b)}});c=a.views=a.views||{};a.extend(c,{presenters:{},activeViews:true,getProperty:function(c,b){return a.isFunction(b)?b.call(c):b},linkToAttr:"data-to",linkFromAttr:"data-from",getFromAttr:"data-getfrom",merge:{input:{from:{fromAttr:C},to:{toAttr:"value"}}},registerPresenters:registerPresenters=function(e,d){var g,f;if(typeof e==="object")for(g in e)registerPresenters(g,e[g]);else{d.ctx=d.ctx||{};f=(f=d.tag)===b?e:f;if(f){d.tag=f;c.tags[f]=d}plugin=(plugin=d.plugin)===b?e:plugin;if(plugin){a.fn[plugin]=a.fn[plugin]||function(b,a){return this.link(b,d,a)};d.plugin=plugin}c.presenters[e]=d}return this},view:{onDataChanged:function(a){if(a){var b=this,f=a.change,c=a.index,d=a.items;switch(f){case "insert":b.addViews(c,d);break;case "remove":b.removeViews(c,d.length);break;case "move":b.render();break;case "refresh":b.render()}}return e},render:function(){var c=this.prevNode,e=this.nextNode,d=c.parentNode;a(this.nodes).remove();this.removeViews(0,this.views.length);this.nodes=[];a(c).after(a.render(this.data,this.tmpl,this.ctx));d.removeChild(c.nextSibling);d.removeChild(e.previousSibling);g(d,this,e,0,b,b,c,0);j(this);return this},addViews:function(d,i,o){var h,m=i.length,k=this.ctx,l=this.views;if(d&&!l[d-1])return;if(m){if(this.path){h=this.parent;k=p(h.data,h,this.path)[1]}var n=a.render(i,o||this.tmpl,k,this,e),c=d?l[d-1].nextNode:this.prevNode,j=c.nextSibling,f=c.parentNode;a(c).after(n);f.removeChild(c.nextSibling);f.removeChild(j.previousSibling);g(f,this,j,0,b,b,c,d)}return this},removeViews:function(f,l,n){if(l){var h,k,m,i=this.views,o=f+l;while(o-->f){var c=i[o],g=c.views.length,e=c.prevNode,q=c.nextNode,p=[e];if(g)c.removeViews(0,g,n);h=h||d(c.parentElem,"view");g=h.length;while(g--&&k===b)if(h[g]===c)k=g;h.splice(k,1);if(!n){while(e&&e.parentNode&&e!==q){e=e.nextSibling;p.push(e)}a(p).remove()}c.data=b;j(c)}i.splice(f,l);m=i.length;while(f<m)a.observable(i[f]).setProperty("index",f++)}return this},context:function(c){var a=this,d=a.parent,e=d?d.ctx:{};if(!c)a.each(function(a){a.ctx=e;a._ctx=b});else if(c!==a.ctx)a.each(function(b){t(b,c,b!==a)});return this},each:function(a){a(this);var b=this.views.length;while(b--)this.views[b].each(a);return this},content:function(b){return b?a(b,this.nodes):a(this.nodes)}}});a.fn.extend({view:function(b){return a.view(this[0],b)},addLinks:function(c,b,a){return w(this,c,b,a)},link:function(e,c,d){if(!this.length)return this;if(c){c=c.tag&&c===a.views.tags[c.tag]?(d.tag=c.tag,d.tmpl||c.tmpl):a.isPlainObject(c)?(d=c,f):c;if(c&&(c=a.template(c))){q(this[0],declLinkTo);v(this[0]);this.empty();if(e)this.append(a.render(e,c,d))}}return w(this,e,b,d)}});i.prototype=c.view;D=c.decl;declLinkTo=[{filter:"input["+c.linkToAttr+"]"}]})(jQuery)