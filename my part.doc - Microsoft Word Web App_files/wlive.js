/* Copyright (C) 2012 Microsoft Corporation */(function(){var b=window,f=b.jQuery,g=b.Debug,c;if(b.wLive)c=b.wLive;else c=b.wLive={};c.Core={};c.Controls={};var a=b.$Config;a.handlerBaseUrl=a.handlerBaseUrl||"";if(!a.sd){var e=document.domain,d=e.split(".");a.sd=d.length===1?"":"."+d[d.length-2]+".com"}a.mkt=a.mkt||"na";a.prop=a.prop||"X";if(typeof window.SymRealWinOpen!=="undefined")window.open=window.SymRealWinOpen})();(function(){var a=window,e=a.jQuery,g=a.wLive;a.$Version="9.090515.0";a.CompatVersion="9.100709.0";if(!a.$Debug)a.$Debug={enabled:false,trace:function(){}};var b=a.document;a._d=b;a._ce=function(a){return b.createElement(a)};a._ge=function(a){return b.getElementById(a)};a._get=function(a){return b.getElementsByTagName(a)};a._dh=b.head=b.head||a._get("head")[0];g.dh=e("#head")[0]||a._dh;var c;e(document).bind("propertychange",f);function f(){var a=document.title,b=document.location.hash;if(a!=c)if(b&&a.indexOf(b)==a.length-b.length)document.title=c;c=document.title}a.registerNamespace=d;function d(){for(var e=0,i=arguments.length;e<i;e++){var d=this,f=arguments[e].split(".");for(var c=0,h=f.length;c<h;c++){var g=f[c],b=d[g];if(!b)b=d[g]={};if(!b.__namespace){if(c===0&&arguments[e]!=="Sys")a.Sys.__rootNamespaces[Sys.__rootNamespaces.length]=b;b.__namespace=true;b.__typeName=f.slice(0,c+1).join(".");b.getName=function j(){return this.__typeName}}d=b}}return d}d("Sys");if(!a.Sys.__rootNamespaces)a.Sys.__rootNamespaces=[Sys]})();(function(){var d=window,z=d.Debug,a=d.String.prototype;a.endsWith=function u(a){return this.substr(this.length-a.length)==a};a.startsWith=function r(a){return this.substr(0,a.length)==a};a.lTrim=function w(){return this.replace(/^\s*/,"")};a.rTrim=function x(){return this.replace(/\s*$/,"")};a.trim=function y(){return this.replace(/^\s+|\s+$/g,"")};var k=/\{\d+\}/g,i=/\{[a-z|A-Z|\.|\$|\:]+\}/g,c=/[\{\}]/g;a.format=function v(){var b=arguments;function a(d){var a=b[d.replace(c,"")];if(a==null)a="";return a}return this.replace(k,a)};function b(e,d){var c=e.split("."),a=d;for(var b=0;b<c.length;b++){a=a[c[b]];if(typeof a==="undefined")return null}return a}a.itemFormat=function q(f,a,d){a=a||{};d=d||[];function e(k){var l=k.replace(c,""),h,e=l.split(":"),g="",j=b(e[0],f);if(j!=null)g=j;else{var i=b(e[0],a);if(i!=null)g=i.apply(this,d)}if(e.length==2)h=b(e[1],a);return h?h(g):g}return this.replace(i,e)};var e=/[^\w.,-]/g;a.encodeXmlAttribute=a.encodeHtmlAttribute=function m(){return this.replace(e,function(a){return ["&#",a.charCodeAt(0),";"].join("")})};function f(f,b,a){var d=a.s===b;if(!d){b=b||0;var c=f.charCodeAt(b),g,e;a.s=-1;if(c<55296||c>57343)a.c=c;else if(c<=56319){g=c;e=f.charCodeAt(b+1);a.c=(g-55296)*1024+(e-56320)+65536;a.s=b+1}else{a.c=-1;d=true}}return !d}var g=/[^\w .,-]/g;a.encodeXml=a.encodeHtml=function o(){var a={c:0,s:-1};return this.replace(g,function(d,b,c){if(f(c,b,a))return ["&#",a.c,";"].join("");return ""})};var j=/[^\w.%-]/g;a.encodeURIComponent=a.encodeUrl=function t(){return encodeURIComponent(this).replace(j,function(b){var a=b.charCodeAt(0).toString(16);return "%"+(a.length==1?"0"+a:a).toUpperCase()})};var h=/[^\w .,-]/g;a.encodeJson=function p(){return this.replace(h,function(c){var a=c.charCodeAt(0).toString(16),b=(new Array(4-a.length+1)).join("0");return "\\u"+b+a.toUpperCase()})};a.decodeURIComponent=a.decodeUrl=function s(){return decodeURIComponent(this)};var l=/([\\\.\{\}\(\)\[\]\/\+\*\?\|\^\$])/gi;a.escapeRegex=function n(a){return (arguments.length==0?this:a).replace(l,"\\$1")}})();(function(){var w=window,jQuery=w.jQuery;w.wLive=w.wLive;var wl=w.wLive,Debug=window.Debug,_ConstDefaultDeliminator="&",_ConstKeyValueDeliminator="=";wl.truncateEllipsis=function UtilityTruncateEllipsis(b,a){a=Math.max(parseInt(a,10)||1e5,4);return b?b.length>a?b.substring(0,a-3)+"...":b:""};var $Utility=w.$Utility={};$Utility.eval=function(s){eval(s)};$Utility.deserialize=function $Utility$deserialize(e,b,l,i){var c={};b=b||_ConstDefaultDeliminator;if(e){var g=e.split(b),j=g.length,d=0;for(;d<j;d++){var k=g[d],a=k.split(_ConstKeyValueDeliminator);if(a.length>0){var h=a[0].trim();a.splice(0,1);var f=a.join(_ConstKeyValueDeliminator).trim();try{c[h]=i?f:f.decodeUrl()}catch(m){c[h]=""}}}}return c};$Utility.serialize=function $Utility$serialize(d,c,f){c=c||_ConstDefaultDeliminator;var b=[];for(var e in d){var a=d[e];a=a==null?"":a.toString();b.push(e,_ConstKeyValueDeliminator,f?a:a.encodeUrl(),c)}if(b.length>0)b.pop();return b.join("")};$Utility.updateObject=updateObject;function updateObject(d,e){for(var c in e){var a=d[c],b=e[c];if(b.constructor==Array){if(!a||a.constructor!=Array)a=d[c]=[];updateObject(a,b)}else if(typeof b=="object"){if(typeof a!="object")a=d[c]={};updateObject(a,b)}else d[c]=b}}var ajaxInnerHtmlRegex=new RegExp('<script type="text/javascript"( src="([^"]*?)"){0,1}(( loadfirst="true")|( defer="defer")){0,1}( id="[^"]*?"){0,1}>([\\w\\W]*?)</scr'+"ipt>","gim"),debuggerAjaxInnerHtmlRegex=new RegExp("<script","gim");function evalStringsAndAddScripts(c,b){for(var a=0;a<c.length;a++)$Utility.eval(c[a]);for(a=0;a<b.length;a++)if(b[a]&&b[a]!=""){var d=document.createElement("SCRIPT");d.src=b[a];document.body.appendChild(d)}}$Utility.ajaxInnerHtml=function $Utility$ajaxInnerHtml(i,d){ajaxInnerHtmlRegex.lastIndex=0;var b=[],h=[],g=[],f=[],e=[],c=0,a;while(a=ajaxInnerHtmlRegex.exec(d)){b.push(d.substring(c,a.index));if(a[4]&&a[4]!=""){f.push(a[7]);e.push(a[2])}else{h.push(a[7]);g.push(a[2])}c=ajaxInnerHtmlRegex.lastIndex}b.push(d.substring(c));evalStringsAndAddScripts(f,e);i.innerHTML=b.join("");evalStringsAndAddScripts(h,g)};$Utility.generateGuid=function $Utility$generateGuid(){var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var a=Math.floor(Math.random()*16),c=b=="x"?a:a&3|8;return c.toString(16)});return a}})();(function(){var b=window.jQuery,c=b("body"),a=b("<span/>").css({borderLeftColor:"red",borderRightColor:"blue",position:"absolute",top:"-999px"}).appendTo(c);$Utility._isHighContrast=a.css("borderLeftColor")===a.css("borderRightColor");a.remove();if($Utility._isHighContrast)c.addClass("highContrast");$Utility.isHighContrast=function d(){return $Utility._isHighContrast}})();(function(){var a=window,k=a.jQuery,l=a.Debug,i=a.$Utility,m=a.wLive,f=a.$Beacon={},b=[],h=150;f.fire=function(f,e,d,c,a,b){setTimeout(function(){g(f,e,d,c,a,b)},0)};f.fireAndHold=function(c,a){g(c,a);if(!$B.IE){var b=(new Date).getTime()+h;while((new Date).getTime()<b);}};function g(a,i,h,g,f){var b=j();a=c(a,i);a=a.substr(0,Math.min(a.length,2e3));if(!f)a=c(a,{r:Math.random()});d(b,e(h,b),e(g,b));b.src=a}function j(){var a,e=b.length;for(var c=0;c<e;c++){var d=b[c];if(!d.inUse){a=d;break}}if(!a){a=new Image;b.push(a)}a.inUse=true;return a}function e(a,b){return function(){d(b,null,null);b.inUse=false;if(a)a()}}function d(a,c,b){a.onload=c;a.onabort=a.onerror=b}function c(a,c){a=a||"";if(c){var e=i.serialize(c),b="?";if(a.indexOf("?")>=0){var d=a.charAt(a.length-1);b=d=="?"||d=="&"?"":"&"}a+=b+e}return a}})();(function(){var b=window,g=b.Debug,a=Function,c=a.prototype;if(!a.createCallback)a.createCallback=function d(b,a){return function(){return b.apply(this,a||[])}};if(!a.createDelegate)a.createDelegate=function e(b,a){return function(){return a.apply(b,arguments)}};if(!c.invoke)c.invoke=function f(){this.apply(null,arguments)};b.$CD=Function.createDelegate;b.$CC=Function.createCallback})();(function(){var w=window,_object=w.Object;if(!_object.isString)_object.isString=function $Object$isString(a){return typeof a==="string"||a&&a.constructor===String};if(!_object.isArray)_object.isArray=function $Object$isArray(a){return a instanceof Array};if(!_object.isFunction)_object.isFunction=function $Object$isFunction(a){return typeof a==="function"};if(!_object.isObject)_object.isObject=function $Object$isObject(a){return a&&typeof a==="object"};if(!_object.isBoolean)_object.isBoolean=function $Object$isBoolean(a){return typeof a==="boolean"||a&&a.constructor===Boolean};if(!_object.isNumber)_object.isNumber=function $Object$isNumber(a){return typeof a==="number"||a&&a.constructor===Number};if(!_object.isNull)_object.isNull=function $Object$isNull(a){return null==a||undefined==a};if(!_object.fromJSON)_object.fromJSON=function $Object$fromJSON(text){try{if(typeof JSON!=="undefined"&&JSON.parse)return JSON.parse(text);else if(/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return eval("("+text+")")}catch(a){}return null};if(!_object.toJSON)_object.toJSON=function $Object$toJSON(a){if(a==="")return "";if(typeof JSON!=="undefined"&&JSON.stringify)return JSON.stringify(a);var d=_object.toJSON,b="null";if(!_object.isNull(a))if(_object.isArray(a)){b=[];for(var c=0;c<a.length;c++)b.push(d(a[c]));b="["+b.join(",")+"]"}else if(_object.isObject(a)){b=[];for(var e in a)b.push('"'+e.encodeJson()+'":'+d(a[e]));b="{"+b.join(",")+"}"}else if(_object.isString(a))b='"'+a.encodeJson()+'"';else if(!_object.isFunction(a))b=a.toString();return b}})();(function(){var b=window,k=b.Debug,j=b.jQuery,a=b.Array.prototype;if(!a.addRange)a.addRange=function c(a){a&&this.push.apply(this,a);return this};if(!a.exists)a.exists=function f(a){return this.indexOf(a)>=0};if(!a.contains)a.contains=a.exists;if(!a.clone)a.clone=function i(){return [].addRange(this)};if(!a.indexOf)a.indexOf=function e(c,a){var b=this.length;if((a=a||0)<0)a=Math.max(0,b+a);while(a<b)if(this[a++]===c)return a-1;return -1};if(!a.forEach)a.forEach=function d(c,b){var d=this.length;for(var a=0;a<d;a++)c.call(b,this[a],a,this)};if(!a.insert)a.insert=function g(a,b){this.splice(a,0,b)};if(!a.remove)a.remove=function h(b){var a=this.indexOf(b);if(a>=0)this.splice(a,1);return a>=0}})();(function(){var a=window,c=a.jQuery;function b(a){return function(){for(var c=arguments.length,b=0;b<c;b+=a)this[arguments[b]]=arguments[b+a-1]}}a.$Flags=b(2);a.$Enum=b(1)})();(function(){var d=window,e=d.jQuery,b={};function c(a){var c=b[a];if(!c)b[a]=c=new RegExp("\\b"+a+"\\b","ig");return c}var a=d.$css={has:function(a,e){var d=false;if(a&&a.className){var b=c(e);b.lastIndex=0;try{d=b.test(a.className)}catch(f){}}return d},remove:function(c,b){a.swap(c,b)},swap:function(d,e,b){b=b||"";if(a.has(d,e))d.className=d.className.replace(c(e),b).replace(/^\s|\s\s|\s$/g,function(a){return a.substr(1)})},add:function(b,c){if(b)if(b.className){if(!a.has(b,c))b.className+=" "+c}else b.className=c}}})();(function(){var d=window,f=d.jQuery,b=window.setTimeout,a=[];window.smartSetTimeout=function e(d,g,f){function h(){e(d,0,f)}if(g)b(h,g);else{if(f)a.splice(0,0,d);else a.push(d);if(a.length==1)b(c,0)}};function c(){var f=a.length;if(f>0){try{a.pop()()}catch(g){var e=d.$WebWatson;if(e)e.submitFromException(g)}if(f>1)b(c,0)}}})();(function(){var b=window,u=b.jQuery,C=b.Debug,t=b.$Config,s=b.$Beacon,D=b.wLive,c=b.$WebWatson={},w=b.$CC,x=b.$CD,v=b.$BSI,e=u(window);c.CB={};var a=c.CB,o=3,i=10,n=50,f={First:"34",AfterUnload:"35",Multiple:"36",Download:"55"},d=0,j=false;window.onerror=g;e.bind("beforeunload",l);e.bind("unload",m);a.IsHidden=function(b,a){return a=="Error loading script"};c.foundException=function z(){return d>0};c.resetException=function A(){d=0};c.submitFromException=function y(a,b,h,e,i,f){if(a&&!a.traced){a.traced=1;var j=a.lineNumber||0,d=a.message||a.description||(typeof a=="string"?a:""),k=a.stack,c;try{c=a.fileName||document.location.href}catch(l){}if(b)d+="@"+b;g(d,c,j,e,h,k,1,i,f)}};c.submit=g;function g(c,e,k,g,b,D,C,B,E){var u=t,A=u.BSI||{},h=A.Watson||{},H=A.Scenario||{};if(h&&h.enabled&&d<o){d++;b=b||(d>1?f.Multiple:f.First);var w=c&&c.target;if(!e&&w&&w.tagName=="SCRIPT"){e=w.src;b=f.Download;if(w.getAttribute("hideError")=="true")B=true}var p=u.hn,n=r(!u.isSecure,C?C+2:2),i=D||(n?n.join("\n"):""),y=D||(n?n[0]:"unknown"),l=y?y.toString():y,z,m,G,q;try{z=a.GetActions&&a.GetActions()}catch(I){}try{G=a.IsIgnored&&a.IsIgnored(b,c,e,k,p,l,i,g)}catch(I){}try{q=B||a.IsHidden&&a.IsHidden(b,c,e,k,p,l,i,g)}catch(I){}m=z?z.join("\n"):"";if(!q&&a.ErrorPresentation)try{a.ErrorPresentation(b,c,e,k,p,l,i,m,g)}catch(I){}if(!G){var x={sr:h.sr,biciNoLDParse:1,ec:b,pn:A.pn,msg:c,url:e,ln:k,ih:q,an:j,ac:m,ad:g,cs:i.replace(/[ \t]+/ig," ")};x=v.addHandlerDPs(x);var F=u.handlerBaseUrl+"/handlers/Watson.mvc";if(h.url)F=h.url;s.fire(F,x,null,null,false,true);if(a.ErrorOccurred)try{a.ErrorOccurred(c,e,k,b,p,l,i,m,g,q)}catch(I){}}}if(H.enabled&&$ScenarioQoS)if(E)$ScenarioQoS.stopScenario(E,false,b);else if(!B)$ScenarioQoS.stopAllScenarios("na",false,b)}c.wrapCallback=function B(f,a,e){a=a?a:this;var d=w(f,e||Array.prototype.slice.call(arguments,3)),b=x(a,d);if($B.IE)return b;else return function(){try{return b()}catch(a){c.submitFromException(a)}}};function r(l,g){var c;try{c=a.GetStack&&a.GetStack()}catch(o){}if(!c){c=[];var b=arguments.callee;while(g>0){b=b?b.caller:b;g--}var h=0;while(b&&h<i){c.push(b);b=b.caller;h++}}var n=c.length,j=[];for(var f=0;f<n&&f<i;f++){var d=c[f],e="InvalidMethod()";try{e=d.toString()}catch(o){}var m=l?q(e,d.args||d.arguments):"";e=e.replace(/\s\s*/ig," ");j.push(k(d)+"("+m+")")}return j}function l(){j=true}function q(b,g){var c=b.substring(b.indexOf("(")+1,b.indexOf(")")),e=c?c.split(","):[],f=e.length,d=[];for(var a=0;a<f;a++)d.push(e[a]+"="+p(g[a]));return d.join(",")}function p(b){var c=typeof b,a;if(b==null)a="null";else if(c=="string")a="'"+h(b,13)+"'";else if(c=="function")a=k(b);else if(c=="object")if(b.toString&&!$B.Safari)a=b.toString();else a=c;else if(c=="boolean"||c=="number")a=b.toString();else a="["+c+"]";return a}function h(a,b){if(a&&a.length>b)a=a.substr(0,b-3)+"...";return a}function k(d){var c=a.GetMethodName&&a.GetMethodName(d);if(d&&!c){var b=d&&d.toString?d.toString():"InvalidMethod()",e=b.indexOf(")")+1,g=b.indexOf(" ")==8?9:0;c=b.substring(g,e);if(c.indexOf("function")==0){var f=e+n;b=b.replace(/\s\s*/ig," ");c=h(b,f)+(f<b.length?"}":"")}}return c}function m(){e.unbind("beforeunload",l);e.bind("unload",m)}})();(function(){var b=window,h=b.jQuery,f=b.$WebWatson,e=b.$Static;if(!b.$Do)b.$Do={q:[],w:undefined};var a=window.$Do;a.r=[];a.removeItems=[];a.lock=0;var c=h(document);c.bind("keydown",d);c.bind("mousedown",d);function d(){a.w=undefined}a.register=function j(b,h,g){if(a.r[b])return;a.r[b]={method:h,skipTimeout:g};a.lock++;try{var e=0;for(;e<a.q.length;e++){var c=a.q[e];if(c.id==b&&a.c(b,c.c,0,c.a))a.removeItems.push(c)}if(a.w){var d=a.w;if(d.id==b){a.w=null;a.c(b,d.c,0,d.a)}}}finally{a.lock--;if(a.lock==0){for(var f=0;f<a.removeItems.length;f++)a.q.remove(a.removeItems[f]);a.removeItems=[]}}};a.unregister=function i(b){if(a.r[b])delete a.r[b]};a.c=function k(d,b,k,h,j){var c=a.r&&a.r[d];b=b?b:this;function i(){var a=!!c.method,d=a?c.method:h[2];f.wrapCallback(d,b,g(h,!a))()}if(c)if(c.skipTimeout)i();else setTimeout(i,0);else if(!!e){var l=e.exec(d);if(k&&2==l)if(j)a.w={id:d,c:b,a:arguments};else a.q.push({id:d,c:b,a:h})}return c};function g(b,a){return Array.prototype.slice.call(b,a?3:2)}})();(function(){var e=window,r=e.jQuery,b=e.$Utility,s=e.Debug,a=e.$Cookie={},g="wlxS",f="wlxP",h,c,d;a.setPersistentCookie=function l(b,a){j(b,a,1)};a.getPersistentCookie=function k(a){return i(a,1)};a.setSessionCookie=function n(b,a){j(b,a,0)};a.getSessionCookie=function m(a){return i(a,0)};function j(j,e,i){var h=i?f:g,c=b.deserialize(a.getCookie(h,1));if(e===null||e===undefined)delete c[j];else c[j]=e;var d=new Date;a.setCookie(h,b.serialize(c),$Config.sd,0,i?new Date(d.getFullYear()+1,d.getMonth(),d.getDay()):0,1)}function i(h,d){var c=d?f:g,e=b.deserialize(a.getCookie(c,1));return e[h]}a.getCookie=function p(f,a){var g=document.cookie;if(g==h){if(a&&d)return d[f];else if(!a&&c)return c[f]}else{c=0;d=0;h=g}var e=b.deserialize(document.cookie,";",true,a);if(a)d=e;else c=e;return e[f]};a.deleteCookie=function o(c,b,d){a.setCookie(c,"",b,d,new Date(2e3,1,1))};a.setCookie=function q(h,g,d,e,a,f){var c={};c[h]=g;document.cookie="{0};path={1};{2}{3}".format(b.serialize(c,null,f),e?e:"/",d?"domain="+d+";":"",a?"expires="+a.toUTCString()+";":"")};$Do.register("$Cookie");$Do.register("$Cookie.setCookie")})();(function(){var a=window,d=a.jQuery,b=a.$HelpContext={},c=a.$Config;b.attachContextTo=function(d,b,a){if(b&&d.length>0)d[0].href=c.hc.url+"&errorCode="+(b+"").encodeUrl()+(a?"&errorMessage="+a.encodeUrl():"")};$Do.register("$HelpContext")})();(function(){var a=window,b=a.jQuery,g=a.$Beacon,h=a.$Cookie,j=a.Debug,e=a.smartSetTimeout,f=a.$Version,d=a.wLive,c=a.$Network=new i;a.$LightNetwork=c;function i(){var j=this,q=$B.IE,t=[],k={},m={},i,n,r=true;j.requiresDomainLowering=function(a){r=a};j.getCookie=function(a){return h.getCookie(a,1)};j.fetchXML=function(j,a,h,q,g,i,n){var e,c=l(j),o;h=h||"GET";function r(b){if(g)for(var a in g)b.setRequestHeader(a,g[a])}function t(b){if(a)a(b,i)}if(c===p)e=b.ajax({url:j,type:h,data:q,beforeSend:r,complete:t});else{var d=k[c]=k[c]||[],f={url:j,cb:a,v:h,postString:q,headers:g,c:i,cbp:n};if(o=m[c]){if(d.ready){o.contentWindow.fetchXML(f,null,null,a,n);return e}else if(d.fail){if(a)a({status:5e3},i);return e}d.push(f)}else{d.push(f);s(c,f)}}return e};j.fetchCSS=function(f,e,b){var a=b||document.createElement("link"),h=setTimeout(c,9e3);if(!b){a.rel="stylesheet";a.type="text/css"}function c(){clearTimeout(h);if(!q)a.readyState="complete";a.onreadystatechange=function(){if(a&&a.onreadystatechange&&("loaded"===a.readyState||"complete"===a.readyState)){if(e)e(a);a.onreadystatechange=null}};a.href=f;if(!b){var c=d.dh;c.appendChild(a)}if(!q)a.onreadystatechange()}g.fire(f,0,c,c,1);return a};function w(d){if(d.indexOf("window.")<0)return false;var c=d.split("."),a=window;for(var b=1;b<c.length;b++){a=a[c[b]];if(a===undefined)return false}return true}j.fetchScript=function(i,f,c){var h=d.dh,a=document.createElement("script");function g(){if(!a.handled)if("complete"===a.readyState||"loaded"===a.readyState){a.handled=true;b(a).unbind(".fetch");if(c&&!t[c]&&!w(c)){h.removeChild(a);j.fetchScript(i,f)}else if(f)f(a)}}function k(a){g();if(c)a.stopPropagation()}if(!q)a.readyState="loaded";a.async=true;a.type="text/javascript";b(a).bind("readystatechange.fetch",g).bind("load.fetch",g).bind("error.fetch",k);e(function(){a.src=i;h.appendChild(a)});return a};j.registerScript=function(a){t[a]=true};function s(a,d){o();var b=document.createElement("iframe");b.style.display="none";function e(){var c=false;try{var a=b.contentWindow||b.contentDocument.parentWindow;if(a&&a.fetchXML){j.Proxy._registerProxy(a);c=true}}catch(d){}return c}function g(){var b=k[a],c;b.attempts=(b.attempts||0)+1;if(b.attempts>2&&!b.fail&&!b.ready){if(!e()){b.fail=true;while(c=b.pop())if(c.cb)c.cb({status:5e3},c.c);$WebWatson.submitFromException(new Error("xmlProxy from "+a+" failed."))}}else if(!b.ready&&!e())s(a,d)}function h(){if(!k[a].ready&&!k[a].fail)g()}if(a.endsWith(i)||a.indexOf(":")>0&&a.substring(0,a.indexOf(":")).endsWith(i)){document.body.insertBefore(b,document.body.firstChild);var l=c.xmlProxyTimeout||3e4;setTimeout(h,l);m[a]=b;b.src=location.protocol+"//"+a+"/xmlProxy.htm?vn="+f+"&domain="+i}else if(d.cb)d.cb({status:5e3},d.c)}j.Proxy={_registerProxy:function(f){var b,e=l(f.location.href,false),c=m[e],a=k[e],d=f["frameElement"];if(!a.ready){if(c!=d)c=m[e]=d;a.fail=false;a.ready=true}d.onload=null;while(b=a.pop())c.contentWindow.fetchXML(b,null,null,b.cb,b.cbp)}};function o(){if(!r){i=document.domain;return}i=p;if(i.indexOf(":")>0)i=i.substring(0,i.indexOf(":"));if($Config.domain&&!$Config.domain.endsWith("."))document.domain=$Config.domain;else if(i.endsWith(".com")){var a=i.indexOf(".");if(a>0){document.domain=i;try{while(a>=0){i=i.substring(a+1);if(i!="com"){document.domain=i;a=i.indexOf(".")}else a=-1}}catch(b){}}}else throw new Error("Invalid $Config.domain");i=document.domain;o=function(){}}if($Config.applyAppDomain)o();var x=/^(?:http|https|ftp):\/\/([-.a-z0-9]+(?::[0-9]+)?)(?:\/|$)/i,v=/^((?:http|https|ftp):\/\/[-.a-z0-9]+(?::[0-9]+)?)(?:\/|$)/i,u=/\/[^\/]*\/\.\./;function l(a,b){a=j.resolveUrl(a).toLowerCase();return String(a).search(b?v:x)<0?"":RegExp.$1}j.extractHost=l;j.resolveUrl=function(b,c){b=b?b.toString():"";if(!c)if(!n){var d=a._ge("base");if(d&&d.href!="")c=n=d.href;else{var e=location.protocol+"//"+location.host+location.pathname;c=n=e.substring(0,e.lastIndexOf(location.protocol==="file:"?"\\":"/")+1)}}else c=n;else c=c.substring(0,c.toString().lastIndexOf("/")+1);if(b.startsWith("/"))b=location.protocol+"//"+location.host+b;if(b.indexOf("//")===-1)b=c+b;function f(a){while(u.test(a))a=a.replace(u,"");return a}return f(b)};var p=l(document.location.href);j.currentDomain=p}})();(function(){var d=window,Cb=d.Debug,o=d.jQuery,E=d.$Beacon,u=d.$Cookie,eb=d.$Utility,a=window.$BSI;if(!a.headTime)a.headTime=(new Date).getTime();var q=[],Y=[],x="LD",Bb="#",e="&",p="?",s="~",ib=":",m="",O=".com",H="-int.com",y={},v={},g,f=1,t,B,D,db,T,J,z,j,C,h=d.$Config,c=h.BSI,b=c.BICI,X=h.sd.endsWith(H)?H:O,k=[],Z=c.ignoreWindowOnload,l=0;function kb(){var a=o(document),e=o(d);a.bind("click",Q);a.bind("mousedown",I);a.bind("mouseup",N);a.bind("keydown",M);a.bind("keyup",R);a.bind("touchstart",G);a.bind("touchend",K);l=1;if(!c.ignoreWindowOnload)if(c.useJQueryReady)e.ready(function(){setTimeout(A,0)});else e.bind("load",A);e.bind("unload",V);if(b&&b.capture)v=fb()}a.informLoaded=function sb(g,e){h=d.$Config;c=h.BSI;b=c.BICI;document.body.id=c.pn?c.pn.encodeHtmlAttribute():m;if(a.headTime==J)return;var f=n();J=a.headTime;l=0;k=[];if(e)a.addLogParams({x:"1"});W(q,e);r("L",P(v),f);v={};if(b&&b.beaconUrl)E.fire(b.beaconUrl,y);y={}};a.informPVHead=function tb(){U();a.headTime=n();l=1};a.addBeaconParams=function nb(a){L(y,a)};a.addLogParams=function rb(a){L(v,a)};a.addLoadedCallback=function mb(a){q.push(a)};a.removeLoadedCallback=function lb(a){setTimeout(function(){for(var b=0,c=q.length;b<c;b++)if(q[b]==a){q.splice(b,1);return}},0)};a.isLoading=function zb(){return l};a.addNavCallback=function ob(a){Y.push(a)};a.navigateTo=function xb(c,b,d){if(d)a.currentScenarioObject=d;if(a.informNav(c,0,0,0,0,0,0,b))return;try{if(b)window.open(c,b);else window.location.href=c}catch(e){}};a.addLoadEvent=function qb(a){if(l)k.push(a)};a.eventLoaded=function vb(b){for(var a=0,c=k.length;a<c;a++)if(k[a]==b){k.splice(a,1);bb();break}};a.addHandlerDPs=function pb(a){a["biciPrevious"]=c.biciPrevious;a["mmn"]=h.mmn;return a};a.addLDToHash=function ub(a){a["bicild"]=u.getCookie(x,1);u.deleteCookie(x,$Config.sd);return a};a.informNav=function yb(k,t,d,x,D,K,I,J){f=f&&!D&&(!d||d.getAttribute("target")!="_blank");var B=n(),l=d?d.href:0,G=d?d.innerHTML:0;i();F();t=t||jb(d);k=k||m;var w=$U.doesMatchHost(k,"live"+X),H=$U.isAbsoluteUrl(k)&&$U.doesMatchHost(k,"g.live"+X);r("N",s+s+t.encodeUrl()+s+gb(),B);z=z||f;if(b&&b.urlHash){var A=b.urlHash+B;if(b.fid)A+=e+b.fid+e+(f?"1":"0")+(!x?"1":"0");u.setCookie("LN",A,$Config.sd)}var v=W(Y,k,d,x,f,w,K,I,J);if(!v&&$B.IE&&$B.V<9&&typeof ieImgAnchorFix==="function"&&d)ieImgAnchorFix(d);var y=["WLXID=",c.xid,"&RID=",c.rid,"&TID=",a.headTime,"&lid=",t].join(m);if(H){if(d&&b&&b.enableGlinkExtra){var q;if(l.indexOf(p)<0)q=p+p;else if(l.indexOf(p+p)<0&&l.indexOf(e+e)<0)q=e+e;else q=e;d.href=l+q+y}}else if(!w)if(b&&b.enableGlinkCall)E.fireAndHold("//g.live"+O+"/_9uxp9"+h.mkt+"/mike?"+k.encodeUrl()+e+e+y);if(d&&l!=d.href){j=d;C=l;if(g==3){if(!$B.Safari&&!$B.Firefox)o(d).bind("mouseout",i)}else setTimeout(i,100);S(d,G)}return v};function fb(){var a={sw:screen.width,sh:screen.height,c:screen.colorDepth};if(document.documentElement.clientWidth){a.bw=document.documentElement.clientWidth;a.bh=document.documentElement.clientHeight}return a}function i(){if(j&&j.href!=C){var a=j.innerHTML;j.href=C;S(j,a);o(j).unbind("mouseout",i);j=0}}function S(a,b){if(a&&a.innerHTML!=b)a.innerHTML=b}a.reportEvent=function wb(d,c){var b=s+d+P(c);if(!r("E",b)){a.flush();r("E",b)}};a.flush=function Ab(){E.fire(h.handlerBaseUrl+"/Handlers/NoOp.mvc",a.addLDToHash({}))};function I(a){i();cb(a)}function Q(a){if(a.which==2||t||db)return;ab(a);f=!t&&!B&&!D;g=1;w(a.target,null,a);f=1}function N(a){cb(a);if(g!=1||t){f=0;w(a.target,g==3,a);f=1}}function M(a){if(a.keyCode==93){g=3;w(a.target,1,a)}}function R(b){var a=b.keyCode;if(a==27||a==18||a==13)i()}function G(){i();T=n()}function K(a){if(n()-T>1e3){f=0;g=3;w(a.target,null,a);f=1}}function cb(a){g=a.which;ab(a)}function ab(a){B=a.shiftKey;t=a.ctrlKey;D=a.altKey;db=a.metaKey}function w(e,l,n){i();while(e){if(e.tagName=="A"){var c;try{c=e.href}catch(o){}if(c){if(h.AjaxHistory&&h.AjaxHistory.fullAjax&&c.indexOf("#")==-1){var f;if(d.$PF)f=d.$PF.getAppFrameDocument();var b=f?f.location.href:document.location.href,k=b.indexOf("#");if(k>-1)b=b.substr(0,k);var j=b.indexOf("?");if(j>-1)b=b.substr(0,j);b+="?";if(c.toLowerCase().indexOf(b)==0)c=e.href="#"+c.substr(b.length)}var g=false;if($U.isLinkABookmark(c)){var m=$U.getUrlFragment(c);if(m.indexOf("=")>-1)g=true}else g=true;if(g)a.informNav(c,0,e,l,null,n)}break}e=e.parentNode}}function jb(a){var c=m;while(a&&a.getAttribute){var b=a.getAttribute("lid");if(b){c=b;break}a=a.parentNode}return c}function P(b){var c=m;if(b)for(var d in b){var a=b[d];a=a.encodeUrl?a.encodeUrl():a;c+=s+d+ib+a}return c}function F(){if(l&&!c.ignoreWindowOnload)a.informLoaded(1,1)}function gb(){var a="U";if(g==3)a="R";else if(g==1)a="L";else if(g==2)a="M";if(t)a+="C";if(D)a+="A";if(B)a+="S";return a}function L(c,a){for(var b in a)c[b]=a[b]}function A(){Z=1;bb()}function bb(){if(Z&&k.length==0)a.informLoaded()}function V(){U();i();var a=o(document);a.unbind("click",Q);a.unbind("mousedown",I);a.unbind("mouseup",N);a.unbind("keydown",M);a.unbind("keyup",R);a.unbind("touchstart",G);a.unbind("touchend",K);var b=o(d);if(!c.ignoreWindowOnload)b.unbind("load",A);b.unbind("unload",V)}function U(){F();if(!z)r("U")}function n(){return (new Date).getTime()}function hb(b){return (b?b:n())-a.headTime}function r(l,k,n){if(b&&b.enableLD){var j=l+hb(n)+(k?k:m),f=u.getCookie(x,1),g=eb.deserialize(f,e,0,1),i=[c.xid,c.rid,h.di,a.headTime].join("_"),d=g[i];if(d)d+="|"+j;else d=j;g[i]=d;f=eb.serialize(g,e,1);if(f.length>512)return 0;u.setCookie(x,f,$Config.sd,0,new Date(2020,1,1),1)}return 1}function W(f){var a=0,c=f.clone(),g=c.length,b=false,e=d.$WebWatson;if(e)for(;a<g;a++)b=e.wrapCallback(c[a],0,Array.prototype.slice.call(arguments,1))()||b;return b}kb();$Do.register("$BSI.addNavCallback",a.addNavCallback);$Do.register("$BSI")})();(function(){var d=window,z=d.jQuery,y=d.$Beacon,h=d.$Cookie,n=d.$Network,e=d.$ScenarioQoS={},f=$Config,s=f.BSI||{},a=s.Scenario||{},i="Sce",c="na",b="$",m="ok",q=3;d.wLive.ScenarioQoSStats={d:[],add:function(c,g,f){if(c&&g&&f&&a.ids&&a.guids){var h=a.ids.split(b),k=a.guids.split(b),j=h.length;c.scenarioId=f.id;c.transactionGuid=f.guid;for(var e=0;e<j;e++)if(h[e]===c.scenarioId&&k[e]===c.transactionGuid){var i=d.wLive.ScenarioQoSStats,l=new Date;c.clientStart=g;c.clientLength=l.getTime()-g;i.d.push(c);break}}}};var l=d.wLive.ScenarioQoSStats;e.addScenarioToHttpHeader=function t(b,a){if(a){b["scenarioid"]=a.id||c;b["transactionguid"]=a.guid||c;b["scenariopropertyid"]=a.propertyId||c}};e.getScenarioObject=function u(i){if(a.enabled&&a.ids&&a.guids&&a.startTimes&&a.propertyIds){var d=a.ids.split(b),e=a.guids.split(b),g=a.startTimes.split(b),h=a.propertyIds.split(b),f=d.length;for(var c=0;c<f;c++)if(e[c]===i)return j(d[c],e[c],h[c],g[c])}return null};e.startScenario=function w(c,b){var d=(new Date).getTime(),e=$Utility.generateGuid();a.ids=g(a.ids,c);a.propertyIds=g(a.propertyIds,b);a.startTimes=g(a.startTimes,d);a.guids=g(a.guids,e);return j(c,e,b,d)};e.stopScenario=function x(q,r,w){if(a.enabled&&a.ids&&a.guids&&a.startTimes&&a.propertyIds){var u=r===false?false:true,g=q.id,o=q.guid,h=a.ids.split(b),l=a.guids.split(b),i=a.startTimes.split(b),j=a.propertyIds.split(b),t=h.length;for(var d=0;d<t;d++)if(h[d]===g&&l[d]===o){var e=k(g,o),s=(new Date).getTime()-i[d],y=u?m:w||c;e.apiArray.push(g);e.durationArray.push(s);e.errArray.push(y);e.dependentArray.push(c);e.startTimeArray.push(i[d]);var x={sc:g,ppd:j[d],api:e.apiArray.join(b),dur:e.durationArray.join(b),err:e.errArray.join(b),dep:e.dependentArray.join(b),stt:e.startTimeArray.join(b)},v=$Utility.serialize(x);n.fetchXML(f.handlerBaseUrl+"/Handlers/ScenarioQos.mvc",null,"POST",v);h.splice(d,1);l.splice(d,1);i.splice(d,1);j.splice(d,1);a.ids=h.join(b);a.guids=l.join(b);a.startTimes=i.join(b);a.propertyIds=j.join(b);p(g,o);break}}};e.stopAllScenarios=function v(g,h,k){if(a.enabled&&a.ids&&a.guids){var f=a.ids.split(b),l=a.guids.split(b),i=f.length,j=h===false?false:true;for(var d=0;d<i;d++)if(g===c||g===f[d])e.stopScenario({id:f[d],guid:l[d]},j,k)}};function r(){if(a.enabled)if(a.ids&&a.guids&&a.startTimes&&a.propertyIds){var j=a.ids.split(b),A=a.guids.split(b),w=a.startTimes.split(b),x=a.propertyIds.split(b),l=j.length,v=[],t=[],r=[],m=[];for(var c=l-1;c>=0;c--){var g=j[c],y=w[c],p=x[c],u=A[c];if(c>=l-q){v.push(g);t.push(u);r.push(y);m.push(p)}var d=k(g,u);if(d.apiArray.length!=0){var B={sc:g,ppd:p,api:d.apiArray.join(b),dur:d.durationArray.join(b),err:d.errArray.join(b),dep:d.dependentArray.join(b),stt:d.startTimeArray.join(b)},z=$Utility.serialize(B);n.fetchXML(f.handlerBaseUrl+"/Handlers/ScenarioQos.mvc",null,"POST",z)}}var s=v.join(b)+"&"+r.join(b)+"&"+m.join(b)+"&"+t.join(b);if($BSI.currentScenarioObject)s=$BSI.currentScenarioObject.id+"&"+$BSI.currentScenarioObject.startTime+"&"+$BSI.currentScenarioObject.propertyId+"&"+$BSI.currentScenarioObject.guid;var e=new Date;e.setSeconds(e.getSeconds()+5);h.setCookie(i,s.encodeUrl(),f.sd,null,e,1);setTimeout(o,500)}else h.deleteCookie(i,f.sd)}function o(){if(h)h.deleteCookie(i,f.sd)}function p(e,f){var b=l.d,c=b.length;for(var a=0;a<c;a++){var d=b[a];if(d.scenarioId===e&&d.transactionGuid===f){b.splice(a,1);a--;c--}}}function k(n,q){var h=[],g=[],i=[],e=[],f=[],d=l.d,j=d.length;for(var b=0;b<j;b++){var a=d[b];if(a.scenarioId===n&&a.transactionGuid===q){var k=a.api||c,o=a.clientStart,p=a.error||m;h.push(k);g.push(a.clientLength);i.push(p);e.push(a.dependent||c);f.push(o)}}return {apiArray:h,durationArray:g,errArray:i,dependentArray:e,startTimeArray:f}}function g(a,c){if(a)a=a+b+c.toString();else a=c.toString();return a}function j(c,e,b,d){var a={id:c,propertyId:b,guid:e,startTime:d};return a}$BSI.addNavCallback(r)})();(function(){var a=window,b=a.jQuery;a.sutra=function(g,f,e){if(a.$Sutra){var d=b(g);if(!d.attr("sutra")||!e)d.attr("sutra",c(f))}};a.sutra.load=function(d,c){if(a.$Sutra){b(document.body).attr(d,c);b(document.body).removeAttr("sutravisited")}};a.unsutra=function(c){if(a.$Sutra)b(c).removeAttr("sutra")};function c(e){var d=e.split("."),b=a;for(var c=0,f=d.length;c<f;c++)b=b[d[c]];return b}})();(function(){var a=window;a.wLive.PageStats={d:[],o:$BSI.headTime,add:function(b,c){var d=a.wLive.PageStats;c=c||d.o;b=b||{url:"Missing page stats.",tasks:[],executionTimeMs:0,schedulerTimeMs:0};var e=new Date;b.clientStart=c;b.clientLength=e.getTime()-c;b.clientTime=e;d.d.push(b);jQuery(d).trigger("go")}}})();(function(){var l=window,ub=l.jQuery,x=l.$Beacon,y=l.$Cookie,W=l.$Utility,Gb=l.Debug,I="BP",yb="-",cb=40,S="wlidperf",nb="wl_preperf",p="FR",w="ST",q=null,h="",bb=5e3,a=$CSIPerf;a.GT1Param=null;a.payloadLength=0;a.TTxDeferred=ub.Deferred();var Fb=[],i=0,Eb=q,z={},F,s,r={},c=l.$Config,d=c.BSI||{},j=d.SBSPLT||{},b=d.CSIPerf||{},Q=b.IDSS||{},C=b.Trace||{},E=b.page||{},O=b.WLXFD||{},m=y.getCookie,V=y.setCookie,J=W.serialize,v=W.deserialize,g=v(m(S,1)),k=v(m(nb,1)),A=d.ir,u=h;function db(s,i,w){var d=i[p]||"NA*NA*",f=d.split("*");f[2]=u;d=f.join("*");u=h;var a=ob(i),y=tb(a.time),x=v(m("ANON",1))["A"]||h,e=l.$WebWatson,j=e&&e.foundException()?1:0,t=n(g.latency),r=n(k.thr),q=d+":"+o(c.prop,20)+"*"+o(s),b={ANON:x,NL:t,TP:r,CL:c.mmn||h,MA:c.mkt,B:c.build,TR:q,PLT:a.time,IR:A&&!a.nostart&&!w?1:0,EX:j};Z(b,a.lapseReport,y);eb(b);return b}function o(a,b){b=b||cb;var c=a.length;a=c>b?a.substr(c-b):a;return a.encodeUrl()}function tb(a){return i>0&&!f(a)&&a>0?{tprs:Math.round(i/1024*8/(a/1e3)),size:Math.round(i/1024*10)/10}:q}function Z(a,b,c){if(k.plt)a.PLM=k.plt;if(k.com)a.PCT=k.com;if(k.req)a.PCD=k.req;if(c)a.SZ=c.size,a.TPRS=c.tprs;if(b)for(var d=0;d<b.length;d++){var e=b[d];a[e.key]=e.val}}function ob(e){if(a._ttg)a.lapse.push({s:"ttg",t:a._ttg});var b=E.timeStamp;if(f(b)||0==b)b=G();var c=e.ST||0,d=b-c,g=ib(c,b,a.lapse);return {nostart:c==0,time:d>0?d:0,lapseReport:g}}function n(b){var a=parseInt(b);return isNaN(a)?0:a}function f(a){return "undefined"==typeof a||!a||h==a}function L(){var a={latency:g.latency,throughput:g.throughput};R(a);g=a}function U(){P();L();y.deleteCookie(I,c.sd)}function H(){try{var a=window.location;return a.hostname+a.pathname}catch(b){return document.domain}}function ib(e,h,a){var c=[];if(a&&a.length>1&&h-e>0){a[0]={s:"Start",t:e};for(var b=0;b<a.length-1;b++){var i=a[b],d=a[b+1];if(!f(d)){var g=d.t-e;if(g>0)c[c.length]={key:"L."+d.s,val:g}}}}return c}function lb(c,e,b,j){c=c||H();i=n(b.p);if(f(i)||i<=0)i=f(e)?0:n(e);var d=g[w],h=g[p];if(h&&d){b[p]="0*"+h+"*";b[w]=d;A=1;L();a.TTxDeferred.resolve(d)}a.GT1Param=db(c,b,j)}function gb(a){a[p]=h;a[w]=h;B(a)}function P(){i=0,E.timeStamp=0,z={},a.csd={},a.lapse=[{}];a._ttg=0;a.payloadLength=0;j.rt=0}function qb(c,d){if(!b.enabled){U();return}if(f(c))c=H();var a=t();a[p]=c;a[w]=G();a.p=f(d)?0:n(d);B(a)}function ab(){var d=window.performance;if(d){var a=d.timing;if(a){var b=a.navigationStart;e("jsPlt",b,a.loadEventEnd);e("1Pnt",b,a.msFirstPaint);e("domIn",b,a.domInteractive);e("rdir",a.redirectStart,a.redirectEnd);e("dns",a.domainLookupStart,a.domainLookupEnd);e("tcp",a.connectStart,a.connectEnd);e("req",a.requestStart,a.responseEnd);e("resp",a.responseStart,a.responseEnd)}var c=d.navigation;if(c){$CSIPerf.addCsd("navType",c.type);$CSIPerf.addCsd("redirectCount",c.redirectCount)}}}function e(c,a,b){if(a&&b&&b>a)$CSIPerf.addCsd(c,b-a)}function sb(e){if(!b.enabled){U();return}var c=t();ab();lb(d.pn,a.payloadLength,c,e)}function jb(){if(b.enabled){var c=a.GT1Param,d=K(c)||!c.IR?"nostart":J(c);if(Q.enabled)$BSI.addBeaconParams({csiperf:d})}}function hb(){if(b.enabled){var d=a.GT1Param;if(O.enabled&&j.enabled&&d){delete d.ANON;delete d.MA;delete d.CL;d.RT=j.rt;d.bicild="";x.fire(c.handlerBaseUrl+"/Handlers/PerfMonitor.mvc",$BSI.addHandlerDPs(d),j.render?rb:0,0,1)}}a.GT1Param=null}function N(a,b){if(a){var c=a.indexOf(" PLT: ");if(c>-1)a=a.substr(0,c);a+=b}else a=b;return a}function rb(){var a=m("SBSPLT");if(a){var b=" PLT: "+parseInt(a)+"ms";try{window.top.document.title=N(window.top.document.title,b)}catch(c){document.title=N(document.title,b)}}}function eb(b){if(!K(a.csd))D(b,a.csd);if(!K(z))D(b,z)}function K(a){if(a)for(var b in a)return false;return true}function G(){return (new Date).getTime()}function mb(f){c=$Config;d=c.BSI||{};j=d.SBSPLT||{};b=d.CSIPerf||{};Q=b.IDSS||{};C=b.Trace||{};E=b.page||{};O=b.WLXFD||{};_csiPerfConfigOmniture=b.Omniture||{};if(f);if(b.disableTimers)return;if(!b.skipStopTimer){sb(f);jb();hb();if(b.enabled&&!b.pltDetectionDisabled){var a=t(),e=c.prop;if(a.l!=e){a.l=e;B(a);setTimeout(Y,bb)}}}gb(t());P();F=(new Date).getTime()}function t(){var a=m(I,1);if(a==s)return r;s=a;r=v(a);return r}function B(a){r=a;s=J(a);V(I,s,c.sd,q,q,1)}function Y(){var b=(new Date).getTime(),d={bicild:"",v:c.build};x.fire(c.handlerBaseUrl+"/Handlers/Plt.mvc",d,a,a,1);function a(){var a=(new Date).getTime()-b;if(m("pltmode",1)=="1"){g.latency=a;R(g);y.deleteCookie("pltmode",c.sd,"/")}}}function R(b){var a=new Date;V(S,J(b),c.sd,q,new Date(a.getUTCFullYear()+1,a.getUTCMonth(),a.getUTCDay()),1)}function kb(l,i,g,k,e){if(!g&&e&&!b.disableTimers){var j=f(d.pn)?H():d.pn;a.setPerformanceId(u||fb(i));var h=o(c.prop,20)+"*"+o(j);qb(h,a.payloadLength);A=1}}function fb(a){var c=h;while(a&&a.getAttribute){var b=a.getAttribute("pid");if(b){c=b;break}a=a.parentNode}return c}a.lapseTimer=function Ab(d,b){var c;if(b&&b>0)c=b;else c=n(G());a.lapse.push({s:d,t:c})};a.setUploadTP=function zb(e,c,a,b){var f={dir:"up",sz:e,ti:c,d:b,pn:d.pn,ext:a};M(f)};a.setDownloadTP=function xb(a){var b={dir:"down",pn:d.pn,rate:a};M(b)};function M(a){if(b.enabled&&C.enabled&&j.enabled)x.fire(c.handlerBaseUrl+"/Handlers/Bandwidth.mvc",$BSI.addLDToHash($BSI.addHandlerDPs(a)))}a.startTrace=function Bb(b,a,c){return new pb(b,a,c)};a.endTrace=function Cb(){};function pb(i,h,k){var a=this,f,e=(new Date).getTime(),g={};a.lapse=[];a.addCsd=function n(a,b){T(g,a,b)};a.addLapse=function l(b){a.lapse.push({s:b,t:(new Date).getTime()})};a.endTrace=function m(){if(!f){f=1;if(b.enabled&&C.enabled&&j.enabled){var n=(new Date).getTime(),l={tc:i,tcs:h,ti:n-e,th:e-$BSI.headTime,to:F?e-F:-1};X(l,a.lapse,e,n);D(l,g);var m=c.handlerBaseUrl+"/Handlers/Trace.mvc";if(k){l.wli="csi";m=d.BICI.beaconUrl}x.fire(m,$BSI.addLDToHash($BSI.addHandlerDPs(l)))}}}}a.setPerformanceId=function wb(a){u=o(a,20)};a.addCsd=function Db(a,b){T(z,a,b)};a.clearTTxDeferred=function vb(){a.TTxDeferred=null};function T(a,b,c){a[b]=c}function D(c,a){for(var b in a)c["C."+b]=a[b]}function X(e,b,f){var d=b.length,a=0;for(;a<d;a++){var c=b[a];e["L."+c.s]=c.t-f}}$BSI.addLoadedCallback(mb);$BSI.addNavCallback(kb)})();(function(){var a=window,h=a.jQuery,f=a.$BSI,e=a.$Utility,d="|",c=["h","o","u","q1","q2","q3","q4","q5"],b=c.length;f.addNavCallback(g);function g(p,i){var k=i&&i.getAttribute("wrap");if(k){var g=a.$Config,n=g.WS||{},m=n.SL||{},l=m.url;if(l){var h=k.split(d),o=h.slice(b).join(d),j={l:o,p:g.di,mkt:g.mkt},f;for(f=0;f<b;f++)if(h[f])j[c[f]]=h[f];i.href=l+"?"+e.serialize(j)}}}})();(function(){var c=window,a=c.jQuery,e=c.Debug,b=c.$css;b.getCN=function d(f,g,e){var c=[];if(e&&e.getElementsByTagName){var d=e.getElementsByTagName(g);for(var a=0;a<d.length;a++)if(b.has(d[a],f))c[c.length]=d[a]}return c};b.addHideBorder=function(c,b){b=b||this;a(b).addClass("c_nobdr")};b.removeHideBorder=function(c,b){b=b||this;a(b).removeClass("c_nobdr")};b.addPressedState=function(c,b){b=b||this;a(b).addClass("t_prs")};b.removePressedState=function(c,b){b=b||this;a(b).removeClass("t_prs")};var f=c.$edh={e:function(a,c){var d=c||"inline";if(a.nodeName.toLowerCase()=="span"&&a.className.indexOf("c_ld")!=-1){var b=a.lastChild;if(b){a.parentNode.insertBefore(b,a);b.style.display=d;a.parentNode.removeChild(a)}}},d:function(a){if(a.nodeName.toLowerCase()=="a"&&!(a.parentNode.nodeName.toLowerCase()=="span"&&a.parentNode.className.indexOf("c_ld")!=-1)){var b=document.createElement("span");b.innerHTML=a.innerHTML;b.className=a.className?a.className+" c_ld":"c_ld";var c=a.getAttribute("title");if(c)b.setAttribute("title",c);a.style.display="none";a.parentNode.insertBefore(b,a);b.appendChild(a)}}};if($B&&$B.SF_iPhone)a(function(){if(a(".sc").length>0)a(c.document).bind("touchmove",function(b){if(a(b.target).closest(".sc").length===0)b.preventDefault()})})})();(function(){var a=window;a.$f={cancelEvent:function(b){b=b||a.event;if(b.stopPropagation){b.preventDefault();b.stopPropagation()}else b.returnValue=false;return false},getSelectedText:function(){if(document.selection)return document.selection.createRange();else{var b;try{b=a.getSelection().getRangeAt(0)}catch(c){b=a.document.createRange()}return b}},createIframe:function(){var a=document.createElement("IFRAME");a.frameBorder="no";a.src="javascript:''";a.scrolling="no";return a},px:function(a){return a+"px"},updateTitle:function(a){try{top.document.title=top.document.title.replace(/.*?( PLT: [0-9]+ms)?$/i,a+"$1")}catch(b){}},replaceQs:function(a,e,h){var f="([?|&])"+e+"=([^&]+)",g=new RegExp(f,"i"),c=a,d="",b=a.indexOf("#");if(b>-1){c=a.substr(0,b);d=a.substr(b)}return c.replace(g,"$1"+e+"="+h)+d},doc:document,docEl:document.documentElement,getDocType:function(){var d=$f.doc,c=d.doctype,b=d.all,a;if(c)a=c.publicId;else if(b&&b.length)a=b[0].nodeValue;return a||""},createLoading:function(a,g,b,e,i,d,k){var p=a,m;if(typeof a==="object"){p=a.returnMarkup;g=a.type;b=a.width;e=a.height;i=a.size;d=a.color;k=a.text;m=a.useTransparentFallback}g=g||$f.loadingType.spinning;b=b||"20px";e=e||b;i=i||"3px";d=d&&d.toLowerCase()||"#666";var o="c_spinningDots",r=$Config.imgsBase+"/common/",c;if(g==$f.loadingType.flying){o="c_flyingDots";c="flyingdots.gif"}else{c="spinner_";c+=d=="#fff"?"white_":"grey_";if(b=="60px")c+="120";else if(b=="30px")c+="60";else{c+="40";if(m&&d!="#fff")c+="_transparent"}c+=".gif"}var n=r+c,j=document.createElement("div");jQuery(j).css({width:b,height:e,"font-size":i});j.className=o+" c_loadingDots c_dotsPlaying";var f;if($B.IE&&$B.V<=9)f='<div class="c_loadingFallback"><img src="'+n+'" alt="" width="'+b+'" height="'+e+'" /></div>';else f='<div class="c_loadingFallback" style="background-image:url('+n+");background-size:"+b+" "+e+'"></div>';f+='<div class="c_loadingTracks">';for(var l=5;l>0;l--)f+='<div class="c_loadingTrack c_loadingTrack'+l+'"><div class="c_loadingDot" style="background-color:'+d+'"></div></div>';f+="</div>";j.innerHTML=f;var h=jQuery("<div></div>").append(j);if(g==$f.loadingType.flying)h.css({width:b});if(k)h.append('<span class="c_loadingText">'+k.encodeHtml()+"</span>");if(p){var q=jQuery("<span></span>").append(h),s=q.html();q.remove();return s}return h[0]},loadingType:{spinning:0,flying:1},hideLoading:function(a){a.hide();a.removeClass("c_dotsPlaying")},showLoading:function(a){a.show();a.addClass("c_dotsPlaying")}};$Do.register("$f")})();(function(){var b=window,c=b.jQuery,a=b.$f;a.dockIt=function(k,B,b,f,l,G,z,e){var j=0;l=l||false;b=typeof b=="undefined"?0:b;f=f||{x:0,y:0};e=e||{};if(typeof f!="object"){j=f;f={x:0,y:0}}e.top=e.top||0;e.bottom=e.bottom||0;e.left=e.left||0;e.right=e.right||0;var q=k.offsetParent,A=q==document.body||q==a.docEl,g=a.getLocation(k,l),c=a.getLocation(B,l,A),t=f.x*($B.rtl?-1:1),d={x:g.bodyX+t,y:g.bodyY+f.y,width:g.width,height:g.height,targetLoc:c,spaceY:0},h,i;if(!z){var C=a.clientHeight(),D=a.clientWidth(),w=c.addScrollTop!=-1?a.scrollTop():0,u=a.scrollLeft(),s=g.width+t,r=g.height+f.y,n=C+w-c.bottom-e.bottom,m=c.top-w-e.top,E=D+u-c.right-e.right,F=c.left-u-e.left,p=n>r,o=m>r,v=E>s,x=F>s;if(!p&&o){if(b<2){b+=2;i=1}else if(b==4||b==6){b+=1;i=1}d.spaceY=m}else if(!o&&p){if(b>=2&&b<4){b-=2;i=1}else if(b==5||b==7){b-=1;i=1}d.spaceY=n}else if(b<2||b==4||b==6)d.spaceY=n;else d.spaceY=m;if(!v&&x){if($B.rtl){if(b>=4&&b<6){b+=2;h=1}else if(b==1||b==3){b-=1;h=1}}else if(b>5){b-=2;h=1}else if(b==0||b==2){b+=1;h=1}}else if(!x&&v)if($B.rtl){if(b>5){b-=2;h=1}else if(b==0||b==2){b+=1;h=1}}else if(b>=4&&b<6){b+=2;h=1}else if(b==1||b==3){b-=1;h=1}}var y=b%2;if(G){d.x=f.x;d.y=f.y+c.bottom}else if(b>=0)if(b<4){d.x+=y?$B.rtl?c.left:c.right-g.width:$B.rtl?c.right-g.width:c.left;d.y+=b<2?c.bottom+j:c.top-g.height-j}else{if($B.rtl)if(b<6)b+=2;else b-=2;d.x+=b<6?c.left-g.width-j:c.right+j;d.y+=y?c.bottom-g.height:c.top}if($B.Mobile&&!o&&!p)d.y=a.scrollTop();if(h)d.x+=f.x*-2;if(i)d.y+=f.y*-2;k.style.left=d.x+"px";k.style.top=d.y+"px";return d};a.getLocation=function(c,h,n){var l=false,g=a.getStyle,j="offsetTop",i="offsetLeft",m="position",b={x:c[i],y:c[j],top:0,right:0,bottom:0,left:0,bodyX:0,bodyY:0,width:c.offsetWidth,height:c.offsetHeight},d=c;while(d=d.offsetParent){l=g(d,m)=="relative";if(h!=2){b.bodyX-=d[i];b.bodyY-=d[j]}if(l){var o=a.toInt(g(d,"padding-left")),p=a.toInt(g(d,"padding-top"));b.x=h==1?b.x:o;b.y=h==1?b.y:p}b.x+=d[i];b.y+=d[j]}c=c.parentNode;var e=0,k=0;while(c&&c!=document.body){var f=g(c,m);if(f=="relative"){k=1;c=c.parentNode;continue}if(f=="fixed")e=1;if(n||!k&&f!="absolute")b.y-=a.toInt(c.scrollTop);else if(f=="fixed")e=-1;c=c.parentNode}if(e==1)b.y+=a.toInt(a.scrollTop());b.left=b.x;b.top=b.y;b.right=b.x+b.width;b.bottom=b.y+b.height;b.addScrollTop=e;return b};a.toInt=function(a){a=parseInt(a);return isNaN(a)?0:a};a.locCompare=function(a,b){if(a.bodyX!=b.bodyX||a.bodyY!=b.bodyY||a.top!=b.top||a.left!=b.left||a.bottom!=b.bottom||a.right!=b.right)return 1;return 0};a.getStyle=function(d,b){var e="";if(a.doc.defaultView&&a.doc.defaultView.getComputedStyle){var f=a.doc.defaultView.getComputedStyle(d,"");e=f?f.getPropertyValue(b):""}else if(d.currentStyle){if(b.indexOf("-")>=0){var c=b.split("-");c[1]=c[1].substr(0,1).toUpperCase()+c[1].substr(1);b=c.join("")}e=d.currentStyle[b]}return e};a.isChildOf=function(b,a){try{while(a&&a!==b&&a!=document)a=a.parentNode;return a===b}catch(c){}};a.pn=function(a,c){var d=$css.has(a,c),b=d?a:null;while(!b&&(a=a.parentNode)&&typeof a!="undefined")if($css.has(a,c))b=a;return b};a.docHeight=function(){var c=a.doc.documentElement.clientHeight,b=a.doc.body.clientHeight,d=b!=undefined?b:window.innerHeight+window.scrollMaxY;return Math.max(d,c)};a.docWidth=function(){var b=a.doc.body.clientWidth;return b!=undefined?b:document.width};a.scrollTop=function(){var b=a.toInt(a.docEl.scrollTop),c=a.toInt(window.scrollY);return Math.max(b,c)};a.scrollLeft=function(){var b=a.toInt(a.docEl.scrollLeft),c=a.toInt(window.scrollX);return Math.max(b,c)};a.clientHeight=function(){return a.docEl.clientHeight-($B.IE?16:0)};a.clientWidth=function(){return a.docEl.clientWidth-($B.IE?16:0)}})();(function(){var a=window,i=a.jQuery,j=a.$Utility,k=a.Debug,f,c,b,d,h="http://",g="https://";function e(){f=a.$Config;c=f.Ssl||{};b=c.imu;d=c.d}e();a.$ssl={ensureSSLImageUrl:function(a){if(!d)if(document.location.href.toLowerCase().startsWith(g))if(a.toLowerCase().startsWith(h)&&b)a=b+a.encodeUrl();return a},copyOutConfig:function(a){a.$Config.Ssl={};i.extend(a.$Config.Ssl,$Config.Ssl,true);a.$ssl.resetCachedValues()},resetCachedValues:e}})();(function(){var h=window,d=h.jQuery,v=h.$WebWatson,e="px",k="mouseover",l="unload",f="style",j="width",m="parentNode",n="INPUT",q="h/c4.png,h/c4_rtl.png,",s=30,t=35,r=300,u=17,i=$B.Mobile,p=$B.IE_M6,g=$f.doc;function c(q,p,nb,Ec,Yb,Dc,eb,Sc,xc,Ub,Lb,Lc,Qc,Wb,Rc,Mc,Pc,mc,Hc){var T=null,oc="nextSibling",bb="className",H="visibility",I="display",zb="hidden",Ab="block",rc="visible",Bb="none",wb="position",Rb="height",db="left",ib="top",mb="click",vb="keydown",sc="keyup",P="blur",yb="focus",ub="focusin",sb="focusout",tb="mouseout",qb="mousedown",nc="resize",Hb="dragstart",fc="mousewheel",bc="DOMMouseScroll",kb="t_seli",Fb="t_hov",Ob="c_shad",cc="c_mf",Gb="c_m_scroll",Db,w=d(q),zc=d(p),S=T,L,W,K,gb,E,B,z,Q,O=1,fb,Y=1,y,R=q[f],x={display:0,visibility:0},J=x,hb=0,D,X=0,N,wc,G,F,Sb,Mb=320,ab=[],Ic=1e3,ob,Uc=$f.docEl,Nb=0,Ac=$f.docWidth(),Qb={},lc=q.offsetParent,vc=lc==document.body||lc==$f.docEl,A={},Kb,xb=p,pb,jc,hc=mc?d(mc):zc.parent(),Vb,cb,Z=!i&&!($B.IE&&$B.V<=9)&&!$B.SF_iPhone,rb=150,ic=20,lb=$B.BlackBerry,o=this;if(nb===undefined)nb=T;o.isHoverMenu=0;o.tempHoverCloseDelay=0;o.parentEl=T;o.keepHoverMenuOpen=0;function Tc(){Db=true;q.binding=o;b(h,l,o.dispose);b(q,vb,Cb);b(p,vb,Cb);b(p,P,U);b(p,mb,Nc);b(g,qb,C);b(g,mb,C);b(g,"touchend",C);b(g,sc,uc);b(g,fc,C);if($B.Firefox)b(g,bc,C);N=p.tagName==n;o.isHoverMenu=(eb=="mouseover"||eb=="focus")&&!N;if(!Ub){Ub=250;ob=1e3}Lb=Lb||200;if(o.isHoverMenu){b(p,tb,o.menuOnmouseout);b(p,k,o.menuOnmouseover);b(q,tb,o.menuOnmouseout);b(q,k,o.menuOnmouseover);b(p,yb,o.menuOnmouseover)}else if(eb&&!Pc)h.setTimeout(function(){b(p,eb,o.toggleState)},0);if(i&&!($B.IE&&$B.V<7)){z=g.createElement("div");z[bb]="c_m_sbox";yc(z,50);if((lb||$B.S60_Symbian)&&h["$Config"]&&$Config.ImagesBaseUrl)z[f].background="url("+$Config.ImagesBaseUrl+"/imgs/black_50.png)";g.body.insertBefore(z,g.body.firstChild);b(z,mb,C)}R[H]=zb;R[I]=Ab;pc();Xb();b(h,nc,Cc)}o.dispose=function(){a(q,vb,Cb);a(p,vb,Cb);a(p,P,U);a(g,qb,C);a(g,mb,C);a(g,sc,uc);a(h,nc,Cc);a(g,fc,C);if($B.Firefox)a(g,bc,C);if(o.isHoverMenu){a(p,tb,o.menuOnmouseout);a(p,k,o.menuOnmouseover);a(q,tb,o.menuOnmouseout);a(q,k,o.menuOnmouseover);a(p,yb,o.menuOnmouseover)}else if(eb)a(p,eb,o.toggleState);if(z)a(z,mb,C);if(Q)a(Q,yb,tc);if(!i)for(var b=0;b<E.length;b++){a(E[b],ub,V);a(E[b],sb,V)}a(K,P,U);a(gb,P,U);q.binding=p.menu=T;if(c.current==o)c.current=null;if(Z)jb();a(h,l,o.dispose)};function pc(){var k=q.getElementsByTagName("*"),l;Sb=0;E=[];for(var j=0,p=k.length;j<p;j++){var c=k[j];if(c.tagName=="A"||c.tagName==n||c.tagName=="SPAN"&&$css.has(c,"c-NavLinkDisabled")){var g=ac(c);if(g==q||g.binding&&g.binding.isOpen()){E.push(c);var o,e=c[m];try{o=e.tagName=="LI"||e.tagName=="DIV"}catch(r){}if(o){if(!i){a(c,ub,V);a(c,sb,V);a(c,Hb,$f.cancelEvent);b(c,ub,V);b(c,sb,V);b(c,Hb,$f.cancelEvent);if($B.RE_WebKit&&!c.getAttribute("tabindex"))c.setAttribute("tabindex",1);c[f].zoom="0";if($css.has(c,"uxfa_ml")||$css.has(c,"c_ml"))Sb=1;if(h.$Sutra&&$Sutra.Shared&&$Sutra.Shared.MenuItemLink&&!e.getAttribute("sutra"))sutra(e,"$Sutra.Shared.MenuItemLink")}if(e.style.display!="none"){pb=pb||e;jc=e}if(!fb&&$css.has(c,Fb))G=c;if(D&&D.id==c.id){l=1;M(E.length)}}}}}X=E.length;if(X>0){if(Y&&y)Jb();Y=0;K=E[0];gb=E[X-1];b(K,P,U);b(gb,P,U);d(pb).addClass("c_m_firstchild");d(jc).addClass("c_m_lastchild")}else{Ib();Y=1}if(!l&&G)M(-1)}o.update=function(e){fb=true;a(K,P,U);a(gb,P,U);for(var c=0;c<E.length;c++){var b=E[c];a(b,ub,V);a(b,sb,V);a(b,Hb,$f.cancelEvent);$css.remove(b,kb);d(b).parent().removeClass("c_m_firstchild");d(b).parent().removeClass("c_m_lastchild")}pc();if(!e){var f=Z;Z=false;Xb();Z=f}fb=false;if(F)setTimeout(function(){F.update(e)},0)};o.deactivate=function(){clearTimeout(cb);clearTimeout(Vb);jb();Db=false};o.activate=function(){Db=true};o.convertToSubMenu=function(a){o.setLoc(a)};o.convertFromSubMenu=function(a){o.setLoc(a)};function V(a){if(!N){a=a||event;var b=a.target||a.srcElement;if(b.nodeName=="A")if(a.type=="focusin")setTimeout(function(){$css.add(b,kb)},0);else setTimeout(function(){$css.remove(b,kb)},0)}}function Cc(b){O=1;if(!$css.has(q,"noresize")){var a=$f.docWidth();if(Ac!=a){Ac=a;Eb(b,1)}}}function Xb(){if(Y)return;var g=ac(p);if(g&&g!=p)F=g.binding;else if(xc!=undefined)nb=xc;if(Wb){if(fb){q[f][j]="auto";$css.remove(q,"c_m_maxw")}if(q.offsetWidth>Wb){q[f][j]=Wb+e;$css.add(q,"c_m_maxw")}}var c=3,d=c,k=$B.rtl,l=1;if(!B&&i)Oc();if(!Q&&!i){Q=$f.createIframe();J=Q[f];J[wb]=$f.getStyle(q,wb);q[m].insertBefore(Q,q);b(Q,yb,tc)}xb=Rc||p;if($css.has(p,"c_m_usep"))xb=p[m];if(!lb){var n;if(h.$WLXIM&&h.$WLXIM.isSidebarOpened())n={right:r};A=$f.dockIt(q,xb,nb,Ec,Yb,Sc,Lc,n);Qb=A.targetLoc}if(i){var a=$f.docWidth(),s=$f.docHeight(),t=Mb,u=h.screen[j],v=0;if(z){z[f][Rb]=s?s+e:"100%";z[f][j]=a?a+e:"100%"}if(!a||a>u&&!$B.SF_iPhone)a=u;k=0;if(a>Mb&&!lb){var w=$f.getLocation(p,Yb,vc);if(w.left>a/2){v=a-Mb;k=1}l=0}else{t=a;d=0}A.x=v;q[f][db]=A.x+e;R[j]=x[j]=t-2+e;if(lb)q[f][ib]=Nb+e;Gc()}var C=function(){A.height+=i&&l?c*2:0;x[H]=zb;if(!i)x[j]=A.width+e;x[Rb]=A.height+e;x[db]=A.x+(k?-d:d)+e;x[ib]=A.y+(i&&l?-c:c)+e;x[H]=rc};if(i&&!lb&&!$B.S60_Symbian)setTimeout(C,0);if(Q){J[H]=zb;J[j]=A.width+e;J[Rb]=A.height+e;J[db]=A.x+e;J[ib]=A.y+e}O=0;if(!y)Ib();else if(fb)o.show(0,1)}function Oc(){B=q;while(B[bb]!=Ob&&B[oc])B=B[oc];if(!B||B[bb]!=Ob){B=g.createElement("div");x=B[f];x[wb]=$f.getStyle(q,wb);x[ib]=0;x[db]=0;B[bb]=Ob;q[m].appendChild(B)}x=B[f];x[I]=Bb;x.backgroundColor="#000";yc(B,20)}function Gc(){var e=0,b=[],f=q.getElementsByTagName("UL"),a;for(var c=0;c<f.length;c++){a=f[c];if($css.has(a,"c_gll")){b.push(a);Kc(a);if(a.offsetTop>a.previousSibling.offsetTop)e=1}}if(e)for(var d=0;d<b.length;d++)Jc(b[d])}function Ib(){if(!Db)return;if(Z){clearTimeout(Vb);clearTimeout(cb);cb=setTimeout(function(){ec();Zb();w.animate({height:0},rb);clearTimeout(cb);cb=setTimeout(Bc,rb+ic)},10)}else{Bc();if(!i)Zb()}if(z)z[f][I]=Bb;M(-1)}function Bc(){if(!y){jb();J[H]=x[H]=R[H]=zb;x[I]=Bb;if(O){R[ib]=x[ib]=0;R[db]=x[db]=0}}}function ec(){w.css({overflow:"hidden"});w.removeClass("pause")}function jb(){w.css({overflow:"",height:"auto"});w.addClass("pause")}function dc(a){a=a||w.height();var b=A.spaceY-u;if(a>=b&&!Sb){w.css("max-height",b+e);w.addClass(Gb);if(!w.hasClass("c_mfw")){var c=w.width()+16;w.css("min-width",c+e)}}}function Zb(){if(w.hasClass(Gb)){w.css({"max-height":"","min-width":"",width:"auto"});w.removeClass(Gb)}}function Jb(){if(z)z[f][I]=Ab;J[I]=x[I]=R[I]=Ab;if(Z){clearTimeout(cb);jb();var a=w.height();ec();w.css({height:0});w.animate({height:a},rb);dc(a);Vb=setTimeout(jb,rb+ic)}else if(!i)dc();J[H]=x[H]=R[H]=rc;if(G==K)M(0);if($B.IE&&$B.V<=8){w.find(".c_ms").each(function(){var a=d(this);a.css("width",a.parents("ul").width()-s+e)});w.find(".c_ml").each(function(){var a=d(this);a.css("width",a.parents("ul").width()-t+e)})}}o.hide=Eb;function Eb(b,a){if(a||qc()&&y){Tb=(new Date).getTime();y=0;if(!N)setTimeout(function(){zc.blur()},0);if(!Y)Ib();c.current=F;if(F){if(F.isHoverMenu)F.tempHoverCloseDelay=Ic;if($B.IE&&L)p.focus();setTimeout(function(){F.update(1)},0)}hc.removeClass(cc);gc();if($B.IE&&$B.V<=8){w.find(".c_ms").each(function(){d(this).css("width","")});w.find(".c_ml").each(function(){d(this).css("width","")})}}}o.show=function(g,f){var d;if(!pb&&!w.hasClass("c_msem"))return;if(!f){var e=$f.scrollTop();if(Nb!=e||!Qb||$f.locCompare(Qb,$f.getLocation(xb,Yb,vc))){Nb=e;O=1}if(!y&&(O||Qc)){Xb();d=1}}if(!F&&c.current!=o)c.closeAll();y=1;if(!Y)if(d)setTimeout(Jb,0);else Jb();if(F)F.update(1);if(!fb&&!g&&!o.isHoverMenu)try{p.focus()}catch(i){}hc.addClass(cc);gc();if(h.$PF&&!Kb){var a=_ge($PF.fid);if(a)try{b(a.contentWindow.document,qb,C);b(a.contentWindow,l,kc);Kb=1}catch(i){}}c.current=o};function kc(){var b=_ge($PF.fid);if(b)try{a(b.contentWindow.document,qb,C);a(b.contentWindow,l,kc);c.closeCurrent();Kb=0}catch(d){}}var Tb=0;o.toggleState=function(){if(qc()){Tb=(new Date).getTime();!y&&!Pb()?o.show():Eb(0,1)}};function qc(){return (new Date).getTime()-Tb>150}o.isOpen=function(){return y};function gc(){for(var a=0,b=ab.length;a<b;a++)try{ab[a]()}catch(c){v.submitFromException(c,T,99)}}o.addStateListener=function(a){ab.push(a)};o.removeStateListener=function(b){for(var a=0,c=ab.length;a<c;a++)if(ab[a]==b){ab.splice(a,1);return}};o.setOffset=function(a){Ec=a;O=1};o.invalidatePosition=function(){O=1};o.setLoc=function(a){nb=a;O=1};o.menuOnmouseover=function(){if(p.unhover){clearTimeout(p.unhover);p.unhover=T}if(!y&&!p.hover){var a=Ub;if(c.tempOpenDelayTimer&&ob)a=1;p.hover=setTimeout(function(){o.show()},a)}};o.menuOnmouseout=function(){if(p.hover){clearTimeout(p.hover);p.hover=T}if(y&&!p.unhover&&!o.keepHoverMenuOpen){o.tempHoverCloseDelay=o.tempHoverCloseDelay||Lb;p.unhover=setTimeout(function(){Eb()},o.tempHoverCloseDelay);o.tempHoverCloseDelay=0;if(ob){clearTimeout(c.tempOpenDelayTimer);c.tempOpenDelayTimer=setTimeout(function(){c.tempOpenDelayTimer=null},ob)}}};function Jc(a){a[f][I]=Bb;a.previousSibling[bb]=""}function Kc(a){a[f][I]=Ab;a.previousSibling[bb]="c_gl"}function Nc(){if(!N&&o.isHoverMenu){var a=p.getAttribute("href");if((!a||a.endsWith("#"))&&y&&!Dc)try{K.focus()}catch(c){}}}function C(b){b=b||event;var a=b.target||b.srcElement;if(y&&a&&!$f.isChildOf(q,a)&&p!=a&&!$f.isChildOf(p,a))o.hide()}function uc(a){a=a||event;var d=27,c=a.target||a.srcElement,b=a.keyCode||a.which;if(b==9)W=0;if(y)if(b==d){wc=c.value;o.hide()}else if(!L&&(S==p||b==9&&!$f.isChildOf(q,S))&&K&&!Dc)try{K.focus()}catch(e){}if(N&&c==p)if(!y&&c.value!=wc&&!Pb())o.show();else if(y&&Pb())o.hide()}function Pb(){return !Mc&&N&&p.value==""?true:false}o.getSelectedEl=function(){return D?D:G};function Cb(a){a=a||event;var e=a.target||a.srcElement,b=a.keyCode||a.which,f=0;W=b==9;L=a.shiftKey;S=e;if(N){if(e==p){if(b==40)Fc(1);else if(b==38)Fc(-1);else if(b==13){if(e.value!=""||Hc)if(D){D.focus();if($B.RE_WebKit)d(D).click();d(o).trigger("EnterEvent",D)}else if(G){try{G.focus()}catch(g){}d(G).click();d(o).trigger("EnterEvent",G)}}else if(W&&!L){d(o).trigger("TabEvent",a);M(-1);c.closeCurrent()}else if(b==27&&y)f=1}else if(W)if(!L)if(S!=gb)M(hb+1);else M(-1);else if(L)M(hb-1);if(f)return $f.cancelEvent(a)}}function Fc(b){if(X){var a=hb+b;if(a>=X)a=0;else if(a<0)a=X-1;M(a)}}function M(a){if(X){if(D)$css.remove(D,kb);hb=a;if(hb>-1){D=E[hb];$css.add(D,kb);$css.remove(G,Fb)}else{D=T;$css.add(G,Fb)}}}function U(){if(W&&L&&S==p){o.hide();o.menuOnmouseout()}else if(!Y&&(!L&&W&&S==gb||L&&W&&S==K)){o.hide();o.menuOnmouseout()}else if(!y&&S==p)o.menuOnmouseout()}function tc(){var a=W&&!L?K:p;try{a.focus()}catch(c){}}function yc(c,b){var a="opacity";if($B.IE&&$B.V<=9)a="filter";c[f][a]=a=="filter"?"alpha(opacity="+b+")":.01*b}function ac(a){var b=a.binding&&a.binding.toggleState?a:null;while(!b&&(a=a.parentNode)&&typeof a!="undefined")if(a.binding&&a.binding.toggleState)b=a;return b}Tc()}c.closeCurrent=function(){if(c.current)c.current.hide(0,1)};c.current=null;c.closeAll=function(){while(c.current)c.closeCurrent()};c.chevronTypes={SmallLeftDark:["125,17,6,8","&#9668;"],SmallLeftLight:["125,33,6,8","&#9668;"],SmallRightDark:["154,17,6,8","&#9658;"],SmallRightLight:["154,33,6,8","&#9658;"],SmallUpDark:["57,17,8,8","&#9650;"],SmallUpLight:["57,33,8,8","&#9650;"],SmallDownDark:["94,17,8,8","&#9660;"],SmallDownLight:["94,33,8,8","&#9660;"],MediumLeftDark:["115,17,9,11","&#9668;"],MediumLeftLight:["115,33,9,11","&#9668;"],MediumRightDark:["145,17,9,11","&#9658;"],MediumRightLight:["145,33,9,11","&#9658;"],MediumUpDark:["45,17,11,9","&#9650;"],MediumUpLight:["45,33,11,9","&#9650;"],MediumDownDark:["82,17,11,9","&#9660;"],MediumDownLight:["82,33,11,9","&#9660;"],LargeLeftDark:["103,17,11,15","&#9668;"],LargeLeftLight:["103,33,11,15","&#9668;"],LargeRightDark:["132,17,11,15","&#9658;"],LargeRightLight:["132,33,11,15","&#9658;"],LargeUpDark:["29,17,15,11","&#9650;"],LargeUpLight:["29,33,15,11","&#9650;"],LargeDownDark:["66,17,15,11","&#9660;"],LargeDownLight:["66,33,15,11","&#9660;"],EllipsisDark:["194,1,14,5",""],EllipsisLight:["194,17,14,5",""],SmallCheckDark:["1,1,12,11",""],SmallCheckLight:["1,17,12,11",""],LargeCheckDark:["14,1,14,12",""],LargeCheckLight:["14,17,14,12",""],LargeDotDark:["209,1,8,8",""],LargeDotLight:["209,17,8,8",""]};c.createChevron=function(a,f){if(p||i)return a[1];var e=a[0]+",",c=$IS.CreateFromConfig(q,e,$Config.imgsBase);if(f){var b=d("<span></span>").append(c),g=b.html();b.remove();return g}return c};c.emptyFunction=function(){};(function(){if($B.Chrome||$B.Safari){b(h,l,o);b(g,k,c.emptyFunction)}})();function o(){if($B.Chrome||$B.Safari){a(g,k,c.emptyFunction);a(h,l,o)}}function b(a,b,c){if(a)d(a).bind(b,c)}function a(a,b,c){if(a)d(a).unbind(b,c)}c.bind=function(p,o,l,a,j,n,e,f,b,d,h,k,g,i){var m={offset:l,alt:a==undefined?0:a,nofocus:j,posabs:n,defaultLoc:e,hoverDelay:f,hoverCloseDelay:b,forceDispose:d,parentEl:h,menuEl:k,eventType:g,sourceEl:i};return c.create(p,o,m)};c.create=function(i,H,a){i=i||event;a=a||{};var I=i.target||i.srcElement,o=["c_ml","c_mcp","c_m"],r=I,E=a.offset,G=a.alt==undefined?1:a.alt,C=a.nofocus,F=a.posabs,y=a.defaultLoc,z=a.hoverDelay,v=a.hoverCloseDelay,k=a.forceDispose,g=a.parentEl,b=a.menuEl,h=a.eventType,d=a.sourceEl,t=a.skipEdgeDetection,x=a.noDockCache,B=a.maxWidth,D=a.dockEl,u=a.showOnEmptyInput,w=a.pressedStateEl,s=a.allowClickOnEmptyInput;d=d||$f.pn(r,o[0]);if(d&&(typeof d.menu==="undefined"||d.menu===null||k)){g=g||$f.pn(r,o[1])||d[m];if(g){if(p&&g.tagName=="LI"&&$css.has(g[m],"c_m"))g[f][j]=g.offsetWidth+e;var l=g.childNodes,q=l.length;while(q--&&!b)b=$css.has(l[q],o[2])?l[q]:null;if(k&&b&&b.binding)b.binding.dispose();return A()}}function A(){var g=false,j=0,e=1,f=2,a=j;if(b.binding)a=e;else if(b&&d){h=h||i.type;b.binding=new c(b,d,H,E,G,C,h,F,y,z,v,t,x,B,D,u,k,w,s);a=e;if((h=="mouseover"||h=="focus")&&d.tagName!=n)a=f;d.menu=b.binding;g=true}if(a==e)b.binding.toggleState();else if(a==f)b.binding.menuOnmouseover();return g}return false};h.$menu=c})();(function(){var b=window,a=b.jQuery,h=b.$Config,q=b.$Do,z=b.$Cookie,M=a(b),i,l,I,A=document.createElement("div"),y=a(A);A.className="headerBarBG";var s=[],eb="SelectClick.MetroHeader.Nav",ob="c_h_mail",rb="c_h_ppl",hb="c_h_cal",jb="c_h_sd",db="c_h_dfe",ab="c_h_dfi",tb="c_clogot",kb="c_clogoc",ub="c_hiconm",vb="c_hiconc",nb="c_coh",Z="c_cof",K="c_memenu",gb="c_melink",U="c_himla",V="c_himlo",T="c_memenuic",bb="c_profile",S="c_hli",R="c_wimnetsub",pb="c_signout",ib="c_wimneton_FB",fb="c_wimnetoff_FB",c={};c[ob]="Mail";c[rb]="People";c[hb]="Calendar";c[jb]="SkyDrive";c[db]="DogExt";c[ab]="DogInt";c[tb]="Home";c[kb]="Switcher";c[ub]="webIM";c[vb]="gear";c[nb]="help";c[Z]="feedb";c[gb]="me";c[U]="presence";c[V]="presence";c[T]="c_memenuic";c[bb]="profile";c[S]="account";c[R]="3pchatm";c[pb]="signout";c[ib]="fbchat";c[fb]="fbchat";var v=a("#c_signin"),N=function(){for(var c=0;c<s.length;c++)s[c].unbind("click");v.unbind();a(".c_clogo").unbind();a(b).unbind("unload",N)};a(".c_clogo a").attr("onclick","");b.$header={};var j,d,n,g,k;b.$header.showAppBar=function(o,h,l){if(h){if(j){k.unbind();g.remove();d.remove();n=j=null}j=document.createElement("div");j.id="c_headerBar";document.body.appendChild(j);d=a(j);n=$f.createIframe();n.id="c_headerBarIframe";document.body.appendChild(n);g=a(n);var m='<div><ul class="c_h_ttl">'+h.innerHTML+'</ul><div class="c_clr"></div></div>';j.innerHTML=m;k=d.find("a");k.each(function(){var b=a(this);e(b,b.attr("id"))});if(b.$Sutra&&$Sutra.Shared&&$Sutra.Shared.HeaderTile){k.each(function(){sutra(this,"$Sutra.Shared.HeaderTile")});if(b.$Sutra&&$Sutra.Shared&&$Sutra.Shared.HeaderTiles)sutra(a("#c_headerBar div")[0],"$Sutra.Shared.HeaderTiles")}a(h).remove()}var c;k.bind("mousedown",function(){if(c)c.removeClass("c_hbf");c=a(this);c.addClass("c_hbf")});d.show();g.show();setTimeout(function(){d.css("top","0");g.css("top","0");g.css("height",d.outerHeight()+"px");if(l)try{k[0].focus()}catch(a){}},0);var f=function(b){if(b.type!="keydown"||b.which==27){y.remove();if($B.IE&&$B.V<=9){d.hide();g.hide();i()}else{var a=d.outerHeight()*-1;d.css("top",a+"px");g.css("top",a+"px");setTimeout(i,250)}}};a(o).bind("keydown.header",f);a(b).bind("keydown.header",f);a(document).bind("click.header",f);a(document).bind("touchend.header",f);document.body.appendChild(A);y.width(M.width()).height(M.height());var i=function(){d.hide();g.hide();y.remove();k.unbind();a(document).unbind(".header");if(c)c.removeClass("c_hbf")}};a("#c_clogoc").bind("click",function(){b.top.$header.showAppBar(b,_ge("c_h_ttl"),I);if(b.top.$HeaderWebIM)b.top.$HeaderWebIM.setUnreadCountEl(b.top.jQuery("#c_headerBar #c_murc")[0]);return false});a("#c_clogoc").bind({keydown:G,keyup:G});function G(a){if(a.which==13)I=a.type=="keydown"}b.$header.showLoading=function(){if(!i){i=a($f.createLoading(0,$f.loadingType.flying,"100%","4px",0,"#fff"));i.addClass("c_h_flyingDots");a("#c_cb0").append(i)}$f.showLoading(i)};b.$header.hideLoading=function(){if(i)$f.hideLoading(i)};b.$header.getDummyHeader=function(){if(!l){l=document.createElement("ul");l.className="c_mcp t_hdbg c_c";var a=document.createElement("li");a.style.listStyle="none";l.appendChild(a);document.body.appendChild(l)}return l};var Y=function(d){if(b.$PF){var a=encodeURIComponent($PF.getCurrentUrl()),c=$f.replaceQs(v.attr("href"),"wreply",a);$BSI.navigateTo(c,"_top");return $f.cancelEvent(d)}};v.bind("click",Y);a(b).bind("unload",N);var f=[],yb,x,u,t,H,J,xb,qb=function(b,c,a){this.execute=function(d){if(d.href.indexOf("?rru=home")>-1)d.href=d.href.replace(c,a);else d.href=d.href.replace(b,a)}},wb=function(b,a){this.execute=function(c){var e="://"+a,d="://"+b+a;c.href=c.href.replace(e,d)}},O=function(a,b,c){this.execute=function(g){var d=g.href;if(d.indexOf(b)>-1&&d.indexOf("#")<0&&!d.match(/[\?|&|\/]cid/))if(c){var f="."+h.d,i=f+"/"+a;if(b.toLowerCase()=="profile"&&d.indexOf("/home")>0)f+="/home";g.href=d.replace(f,i)}else{var j="cid="+a,e="?";if(d.indexOf(e)>-1)e="&";g.href=d+e+j}}},lb=function(b,a){this.execute=function(c){if(b&&c.href.indexOf("?rru=inbox")>-1)c.href=b;else if(a&&c.href.indexOf("?rru=contacts")>-1)c.href=a}},Q=function(d){b.$theme=d.$theme;var c=d._ge("themecss");if(c){var a=document.createElement("style");document.head.appendChild(a);if(a.styleSheet&&c.styleSheet)a.styleSheet.cssText=c.styleSheet.cssText;else a.innerHTML=c.innerHTML}};b.$header.copyThemeToOuterFrame=Q;var e=function(a,b,d){if(a&&Boolean(c[b])){a.bind("click",function(){var a=c[b];if(Boolean(d))a=a+d;$BSI.reportEvent(eb,{MetroHeaderNav:a})});s.push(a)}};b.$header.reportBSIMenu=e;var X=function(b){var d=b.getAttribute("hid");if(Boolean(c[d]))e(a(b),d,"A")};q.register("$Header.MenuBind",X);var cb=function(){e(a("#c_h_theme_m_ul"),K)};q.register("$Header.ThemesMenuBind",cb);var W=function(b){e(a(b),K)};q.register("$Header.LinkedIdMenuBind",W);if(h.Header){x=h.Header.MailLink;u=h.Header.ContactsLink;t=h.Header.HotmailDomain;J=h.Header.OldHomeDomain;H=h.Header.OldHotmailDomain}var sb=t;if(x||u)f[f.length]=new lb(x,u);else if(sb)f[f.length]=new qb(H,J,t);var r=b.$HIC&&$HIC.c;if(r&&r.length>0){f[f.length]=new O("cid-"+r,"profile",true);f[f.length]=new O(r,"skydrive")}var o=[],B=[],L=b._ge("c_header");if(L){var P=$css.getCN("c_hleft","div",L)[0];if(P)B=P.getElementsByTagName("a")}for(var D=B.length-1;D>=0;D--){var p=B[D];o.push(p);e(a(p),p.id);if(b.$Sutra&&$Sutra.Shared&&$Sutra.Shared.HeaderLink)sutra(p,"$Sutra.Shared.HeaderLink")}e(a("#c_clogot"),"c_clogot");e(a("#c_clogoc"),"c_clogoc");e(a("#c_hiconm"),"c_hiconm");e(a("#c_hiconc"),"c_hiconc");var zb=a("#c_hmc").find("a").each(function(){o.insert(0,this)}),m,C;for(var F=o.length-1;F>=0;F--){m=o[F];if(m.href.indexOf("//g.live")>-1||m.href.indexOf(h.sd)<0&&!m.target)m.target="_top";for(var E=f.length-1;E>=0;E--){C=f[E];if(C)C.execute(m)}}if(!b.$HIC)return;var w="HIC";function mb(){var e=window.location.host.split("."),d="."+e[e.length-2]+".com",c=new Date,b=$HIC,f=z.getCookie(w,1)||"",a=f.split("|");c.setDate(c.getDate()+b.e);if(a[0]!=b.c)a=[];a[0]=b.c||a[0]||"";a[1]=b.m||b.m===0?b.m:a[1]||"";a[2]=b.l||b.l===0?b.l:a[2]||"";a[3]=b.cl||a[3]||"";a[4]=b.dg||b.dg===0?b.dg:a[4]||"";a[5]=b.scl||a[5]||"";if(a[0])z.setCookie(w,a.join("|"),d,0,c,1);else z.deleteCookie(w,d)}q.register("$Header.UpdateCookie",mb)})();(function(){var a=window,s=a.jQuery,b=a.$Config,o=a.$Network,e,c=-1,h=0,i=a._ge("c_melink"),f,d,g,q=false,j=12,l=6;if(b&&b.Header&&b.Header.baseUrl)c=0;function m(g){var o=b.Themes,c=[];c.push('<div id="c_h_theme_m" class="c_om noresize t_hovl"><ul class="c_oblock c_ot" id="c_h_theme_m_ul" serviceurl="');c.push(o.ThemeService.encodeHtmlAttribute());c.push('">');var q='<li class="c_omti">',m="</li>",k=true,r=g?Math.min(j,g.length):j,p=l-1;for(var i=0;i<r;i++){var n=i%l;if(n==0)c.push(q);var f=g?g[i]:null;c.push('<a href="#" onclick="return false;" info="');if(f)c.push((f[0]+"|"+f[1]+"|"+f[2]+"|"+f[3]).encodeHtmlAttribute());c.push('" class="c_thmb" title="');if(f)c.push(f[4].encodeHtmlAttribute());c.push('">');if(!f)c.push('<div class="c_noimg"></div>');c.push("</a>");k=n==p;if(k)c.push(m)}if(!k)c.push(m);c.push('</ul><span class="c_ms"></span></div>');d.innerHTML=c.join("");e=a._ge("c_h_theme_m");sutra(e,"$Sutra.Shared.ThemesPicker");if(a.$Sutra&&$Sutra.Shared&&$Sutra.Shared.ThemesThumb)s(".c_thmb",e).each(function(){sutra(this,"$Sutra.Shared.ThemesThumb")});if(g)a.$theme.bind(e,$menu.themeAreaId);e.style.display="block";h=1}function p(b){if(b){c=0;g=0;d=null}if(c==0){if(!h||b){f=a._ge("c_theme_menu");if(f||d){d=d||f.parentNode;f=null;m()}}if(h){if($BSI.isLoading())$BSI.addLoadedCallback(k);else k();if(i&&i.menu)i.menu.update()}}else if(c==1&&a.$theme)a.$theme.beforeMenuShow()}function k(){if(c==1)return;c=1;$menu.themeAreaId="c_h_theme_m_ul";$menu.disableThumbs=0;if(!g){g=1;var e=b.handlerBaseUrl,d=a.$PF&&$PF.getAppFrameWindow();if(d)try{e=d.location.protocol+"//"+$U.getHost(d.location.href)}catch(f){}o.fetchScript(e+"/Handlers/ThemePickerJS.mvc"+b.Themes.ThemeJSParms,n);o.fetchScript(b.Header.baseUrl+"themes.js",n)}setTimeout(r,5)}function r(){(function b(){if("undefined"==typeof a.$theme)$menu.themeCallback=b;else{a.$theme.renderThemePicker=function(a){if(q){var g=a.length;window.themejs=null;var b=1,c,d,e=g-1;for(var f=b;f<a.length;f++){c=Math.floor(Math.random()*e)+b;d=Math.floor(Math.random()*e)+b;var h=a[c];a[c]=a[d];a[d]=h}}m(a);$Do.when("$Header.ThemesMenuBind")};$Do.register("$theme.renderThemePicker",a.$theme.renderThemePicker)}})()}$Do.register("$ThemeMenuInit",p);function n(){}})();(function(){var a=window,b=a.jQuery,e=a.$Config;function d(){var d=this,f=false,j,h,k,l="c_memenu",i="c_melinkspan",g="c_melink",m,c,n;function o(){b(a).unbind(".me")}b(a).bind("unload.me",o);d.copyAndInitializeMenu=function(h){var e=_ge(l),r=h._ge(l);n=h._ge(i);var t=a!=h&&(!e||!e.initialized||!r.isCopied);if(t)f=false;if(!f){var q=_ge(i);c=e||r;if(t){if(e){b(e).remove();c=r}var v=_ge(g);if(v)b(v).remove();var u=$header.getDummyHeader().firstChild,s=h.$f.getLocation(h._ge(i),1,1),k=document.createElement("ul"),j=document.createElement("a");k.innerHTML=c.innerHTML;k.className=c.className;k.id=c.id;k.initialized=1;r.isCopied=1;j.style.position="absolute";j.style.top=s.bottom+"px";j.style.left=($B.rtl?s.left:s.right)+"px";j.style.height=0;j.style.padding=0;j.id=g;c=k;m=j;u.appendChild(j);u.appendChild(k);a.$header.copyThemeToOuterFrame(h);var p=a.$Config.Header,o=h.$Config.Header;p.SwitchLinkedIdUrl=o.SwitchLinkedIdUrl;p.MemberName=o.MemberName;p.SwitchIdString=o.SwitchIdString;p.CurrentIdString=o.CurrentIdString;p.LinkedIdUrl=o.LinkedIdUrl;b(a).bind("resize.me",function(){k.initialized=0})}else if(e&&q&&e.parentNode!=q.parentNode){$css.add(e,"uxfa_m c_m t_hovl");q.parentNode.insertBefore(e,q.nextSibling);m=_ge(g)}d.init();$Do.when("$HeaderWebIM.Initialize");h.$Do.when("$LinkedId.DownloadLinkedId")}};d.openMenu=function(a){if(c.binding)c.binding.toggleState();else $menu.create(a,0,{sourceEl:m,menuEl:c,pressedStateEl:n});$Do.when("$MeControl.RecalcMenuWidth")};d.createMeICs=function(){var g=_ge("c_memenuic");if(g){var j=a["$ic"],d=e.cid,h=d?"11:"+d:"",f=j.ic.createICFromTemplate("MeControlXXL",0,0,0,0,0,d,"","",h,null,"",0,0,0,0);if(f){var c=b(g);c.html(f.html);var i=c.find("img");i.attr("title",c.attr("title"))}}};d.recalcMenuWidth=function(){if($B.IE&&$B.V<9){if(j&&h&&k){var a=h.width()+k.width()+1;if(a!=10)j.css("width",a+"px")}var b=_ge(g).menu;if(b)b.update()}};$Do.register("$MeControl.RecalcMenuWidth",d.recalcMenuWidth);d.init=function p(){if(!f){j=b("#c_memenu");h=b("#c_memenu_right");k=b("#c_memenu_left");$Do.when("$ic",0,d.createMeICs);$Do.register("$MeControl.RecalcMenuWidth",d.recalcMenuWidth);if(a.$header){a.$header.reportBSIMenu(b("#c_himla"),"c_himla");a.$header.reportBSIMenu(b("#c_himlo"),"c_himlo");a.$header.reportBSIMenu(b("#c_memenuic"),"c_memenuic");a.$header.reportBSIMenu(b("#c_profile"),"c_profile");a.$header.reportBSIMenu(b("#c_hli"),"c_hli");a.$header.reportBSIMenu(b("#c_wimnetsub"),"c_wimnetsub");a.$header.reportBSIMenu(b("#c_signout"),"c_signout");a.$header.reportBSIMenu(b("#c_himla"),"c_himla")}sutra(_ge(l),"$Sutra.Shared.MeControlMenu");sutra(_ge("c_profile"),"$Sutra.Shared.Profile");sutra(_ge("c_hli"),"$Sutra.Shared.Account");sutra(_ge("c_signout"),"$Sutra.Shared.SignOut");f=true}}}var c=_ge("c_melink");if(c){_$meLink=b(c);_$meLink.mouseover(function(){window.top.$MeControl.copyAndInitializeMenu(a)});_$meLink.focus(function(){window.top.$MeControl.copyAndInitializeMenu(a)});a.$header.reportBSIMenu(_$meLink,"c_melink")}a.$MeControl=new d})();(function(){var a=window,b=a.jQuery,p=a.$Network,m=a.$WebWatson,s=a.Debug,f=[],q="mouseover",r="focus",i="unload",h="c_linkedid";b(a).bind(i,e);function d(c){$menu.closeCurrent();var b=a.$Logout;if(b&&b.doLogout)b.doLogout(c)}var c=a._ge("c_signout");if(c)b(c).bind("click",d);function k(n){try{var t=a._ge("c_memenu"),s=a._ge(h);if(!t||s)return;var j=a._ge("c_wimlink").parentNode,g=j,q=n.CIDLIST,i=n.CredNameList,e=Math.min(q.length,i.length),o=$Config.Header.MemberName;while(e--){var l=document.createElement("li"),c=document.createElement("a");c.href=$Config.Header.SwitchLinkedIdUrl+"&cid="+q[e];c.target="_top";b(c).bind("click",d);f.push(c);c.innerHTML=i[e];if(e==1)c.id=h;var k=_ge("c_wimlink").firstChild.cloneNode(true);if(i[e]===o)c.title=$Config.Header.CurrentIdString.replace("{0}",o);else{c.title=$Config.Header.SwitchIdString.replace("{0}",i[e]);k.style.visibility="hidden"}if(c.firstChild)c.insertBefore(k,c.firstChild);else c.appendChild(k);sutra(c,"$Sutra.Shared.LinkedAccount");l.appendChild(c);j.parentNode.insertBefore(l,g.nextSibling);g=l;$Do.when("$Header.LinkedIdMenuBind",0,c)}if(g!=j){var p=document.createElement("span");p.className="c_ms";g.appendChild(p)}var r=a._ge("c_melink").menu;if(r)r.update()}catch(u){m.submitFromException(u)}}$Do.register("$LinkedId.BuildLinkedIdMenu",k);var n=a._ge("c_me"),j,g;if(window.$Config&&$Config.Header&&$Config.Header.LinkedIdUrl)if(n){$Do.register("$LinkedId.DownloadLinkedId",l);g=1}function e(){b(a).unbind(i,e);if(c)b(c).unbind("click",d);for(var h=0;h<f.length;h++)b(f[h]).unbind("click",d);if(g)$Do.unregister("$LinkedId.DownloadLinkedId")}function l(){if(!j){j=1;e();p.fetchScript($Config.Header.LinkedIdUrl,o)}}function o(){}})();(function(){var b=window,a=b.jQuery,y=$Config,c=b.$footer={},v,x=_ge("uxp_ftr_control"),e=a("#m_wf"),B=a("#m_wh"),j="uxp_ftr_ff",u,D=B.height(),s,k,p;if(y.wla)$Network.fetchScript($Config.wla,function(){},"window.live.shared.strings.footer");if(!e.length)e=a(x).parent();var C="SelectClick.Footer.Nav",d={};d["uxp_ftr_link_legal"]="Terms";d["uxp_ftr_link_privacy"]="Privacy";d["uxp_ftr_link_developers"]="Dev";d["uxp_ftr_link_intl1"]="Intl";d["uxp_ftr_link_custom3"]="CoB1";d["uxp_ftr_link_custom4"]="CoB2";d["uxp_ftr_link_abuse"]="Abuse";d["uxp_ftr_link_language"]="Lang";var i=b._ge("uxp_ftr_control_mini"),r=b._ge("uxp_ftr_hidechevron"),q=b._ge("uxp_ftr_control_cc"),h=b._ge("uxp_ftr_link_language"),l={loading:0,saving:1};c.dispose=function K(){if(i){a(document).unbind("click",n);a(i).unbind();a(r).unbind()}a(h).unbind();a("#uxp_ftr_control a").unbind(".ftr");a(b).unbind("unload",c.dispose);a(b).unbind("resize",g);a(document).unbind(".footerResize")};c.pageContentDiv=_ge("c_content")||_ge("BelowHeader");if(!c.pageContentDiv)c.pageContentDiv=e.prev(".MainLayoutIndented")[0];function G(){return new XMLHttpRequest}function A(){var c=G(),i=f("LanguagePicker.Client.Title"),h='<div class="loadingArea"><table class="loadingTable"><tr><td class="loadingSpinner" id="lpSpinner"></td><td class="lpLoading">'+f("LanguagePicker.Client.Loading")+"</td></tr></table></div>",e=wLive.Controls.Notifications,d=e.createFlyout({title:i,content:h,anchor:_ge("uxp_ftr_link_language"),buttons:{action:f("LanguagePicker.Client.Save")},options:{dismissOnButtonClick:false,moreCss:"languagePickerFlyout"}});s=d;a(d).bind({"buttonclick.flyout":function(p,n,j){if(j==="action"){var k=a(d.content()).find("form"),h=k[0].elements,i=h.language.value,g=h.canary.value,m=a(d.content()).find(".UserContent").html('<div class="loadingArea"><table class="loadingTable"><tr><td class="loadingSpinner" id="lpSpinner"></td><td class="lpLoading">'+f("LanguagePicker.Client.Saving")+"</td></tr></table></div>");a("button.default").hide();if(b.$f){var e=a($f.createLoading(0,$f.loadingType.spinning,"25px","25px"));a("#lpSpinner").append(e);$f.showLoading(e)}var c=new XMLHttpRequest;c.onreadystatechange=function(){if(c.readyState==4&&c.status==200){d.dismiss();if(b.$PF)b.top.location=b.$PF.getCurrentUrl();var a=c.responseText,f=b.top.location.href.toString(),e=$f.replaceQs(f,"mkt",a);try{b.top.location.href=e}catch(g){}}else if(c.readyState==4&&c.status!=200){d.dismiss();o(l.saving)}};c.open("POST","/handlers/languagesave.mvc?canary="+encodeURIComponent(g)+"&lang="+i,true);c.send("canary="+encodeURIComponent(g)+"&lang="+i)}}});d.show().then(function(){});e.getQueue().start();if(b.$f){var g=a($f.createLoading(0,$f.loadingType.spinning,"25px","25px"));a("#lpSpinner").append(g);$f.showLoading(g)}c.onreadystatechange=function(){if(c.readyState==4&&c.status==200)z(c.responseText);else if(c.readyState==4&&c.status!=200){d.dismiss();o(l.loading)}};c.open("GET","/handlers/languagepicker.mvc",true);c.send();return false}function f(c){var a="";if(b.GetString)a=b.GetString("live.shared.strings."+c);return a}function o(d){var a="";if(d===l.loading)a=f("LanguagePicker.Client.Error.Loading");else a=f("LanguagePicker.Client.Error.Saving");var b=wLive.Controls.Notifications,c=b.createTopBar({content:a,dismissalMode:"Explicit",buttons:{action:f("LanguagePicker.Client.Close")}});c.show();b.getQueue().start()}function z(b){var c=a(s.content()).find(".UserContent").html('<div><form name="langPicker" action="/handlers/languagesave.mvc" method="POST">'+b+"</form></div>");a("button.default").show()}function m(b,a,c){q.style.display=a;if(c){b.returnValue=false;return false}}function E(a){return m(a,"none",true)}function F(a){return m(a,"",true)}function w(b,c){return b&&(b.id===c||w(a(b).parent(),c))}function n(a){if(q.style.display===""&&!w(a.target,i.id))return m(a,"none",false)}c.adjustFooter=function I(){var d=c.pageContentDiv;if(x&&d){var f=$f.clientHeight(),b=d.scrollHeight;if(!k||k!=f||p!=b){k=f;p=b;u=e.outerHeight();a(c).trigger("beforeResize");b=d.scrollHeight;var g=b+D;if(e.hasClass(j))g+=u;if(g<$f.docHeight())e.addClass(j);else e.removeClass(j);a(c).trigger("afterResize")}}};function g(){clearTimeout(v);v=setTimeout(c.adjustFooter,50)}function H(){var b=d[a(this).attr("id")];if(b)$BSI.reportEvent(C,{FooterNav:b})}function t(a){if(b.$Sutra&&$Sutra.Shared&&$Sutra.Shared.FooterLink)sutra(a,"$Sutra.Shared.FooterLink")}if(i){a(document).bind("click",n);a(i).bind("click",F);a(r).bind("click",E)}a("#uxp_ftr_control a").each(function(){var b=this;a(b).bind("click.ftr",H);t(b)});t(_ge("uxp_ftr_link_trademark"));if(y.ff){e.css("padding-top",0);a(b).bind("resize",g);a(document).bind({"keydown.footerResize":g,"mousedown.footerResize":g,"mousewheel.footerResize":g,"DOMMouseScroll.footerResize":g});c.adjustFooter()}if(!$Config.LP||!$Config.LP.bypassLanguageFlyout){if(h)h.href="#";a(h).bind("click",A)}a(b).bind("unload",c.dispose)})();(function(){var e=window,g=e.$leftNav={},f=$Config.LeftNav||{},i=f.ActiveLinkId,j,c=jQuery("#c_ln"),h,d,k,n=parseInt(c.css("padding-top")),a,b;function q(){if(c.length){d=jQuery(e.$footer);k=jQuery("#uxp_ftr_control");h=_ge("c_base");jQuery(e).bind("unload.leftNav",p);jQuery(".c_n .c_gl").bind("click",o);if(i)b=jQuery("#"+i);else{var j=jQuery(".c_n .active > a");b=j.length?j:jQuery(".c_n .active > .link")}if(b){if(!b.hasClass("c_gl"))a=jQuery(b.parents("ul")[0]);else a=b.siblings("ul");if(f.AutoExpand)a.show();b.parent().addClass("active");b.parents("ul").show()}if(f.FullHeight){d.bind("beforeResize.leftNav",l);d.bind("afterResize.leftNav",m);g.adjustHeight()}c.find("a").bind("dragstart.ln",$f.cancelEvent)}}function p(){jQuery(e).unbind(".leftNav");jQuery(d).unbind(".leftNav");jQuery(".c_n .c_gl").unbind();c.find("a").unbind(".ln")}g.adjustHeight=function r(){if(h&&c.length){var a=h.scrollHeight-k.height()-n;c.css("height",a+"px")}};function o(){var c=jQuery(this);if(!c.attr("href")){var b=c.siblings("ul");if(!a)a=b;if(a[0]==b[0])a.toggle();else{a.hide();b.show();a=b}}}function l(){c.css("height","auto")}function m(){clearTimeout(j);j=setTimeout(g.adjustHeight,100)}q()})();(function(){var a=window,b=a.$newScript;})();(function(){var c=window,b=0,a=6;c.CollapsingMenu=function d(n,t,d,i,l,f,j,o){var p=o?$menu.chevronTypes.SmallDownLight:$menu.chevronTypes.SmallDownDark,q=$menu.createChevron(p,true),r=$B.rtl&&$B.IE_M6?$menu.createChevron($menu.chevronTypes.SmallLeftDark,true):$menu.createChevron($menu.chevronTypes.SmallRightDark,true),c=d.lastChild.childNodes[1],s=d.firstChild,e=false;if(!f){f=c.parentNode;e=true}this.redraw=function(p,l){var g=$css.getCN("c_collRem","a",c)[0];if(g){var b=g.parentNode;b.parentNode.removeChild(b)}var a=d.childNodes.length-1;while(a<n&&c.childNodes.length!=0){m(c.firstChild,false);d.insertBefore(c.firstChild,d.lastChild);a++}while(a>n){h();a--}c.parentNode.style.display=i;while(!l&&k())if(!h())break;var j=jQuery(c).children();if(j.filter(":visible").length===0)c.parentNode.style.display="none";else{var o=e;c.parentNode.style.display=i;f=c.parentNode;e=false;if(k())h();e=o}if(c.binding)c.binding.update()};function k(){var b;if(j)b=j();else{var c,a=e?f.previousSibling:f;if(a){if($B.ltr)c=d.parentNode.offsetWidth+g(d.parentNode)<a.offsetWidth+g(a)+l+20;else c=g(d.parentNode)>g(a)-(l+20);b=d.childNodes.length>t&&c||s.offsetTop<a.offsetTop-a.offsetHeight}}return b}function g(a){var b=a.offsetLeft;while(a.nodeName.toLowerCase()!="body"&&a.nodeName.toLowerCase()!="html"){a=a.offsetParent;if(a)b+=a.offsetLeft;else break}return b}function h(){var b=false,a=d.lastChild.previousSibling;if(a){m(a,true);c.insertBefore(a,c.firstChild);b=true}return b}function m(i,e){var c=jQuery(i),f=c.find("a.c_ml")[0],d=f&&f.menu;if(c.hasClass("c_sm"))if(e){if(d)d.deactivate();c.children("a").hide();c.children("ul").css("visibility","");c.find("ul li:last-child").append('<span class="c_ms"> </span>')}else{if(d)d.activate();c.children("a").css("display","");c.find("ul li:last-child .c_ms").remove()}else if(c.children(".c_m").length>0){var g=c.find("span.c_chev");if(g.length){var h=e?r:q;g[0].innerHTML=" "+h}if(d)if(e)d.convertToSubMenu(a);else d.convertFromSubMenu(b)}}}})();(function(){var f=window,c=f.jQuery,g=f.wLive.Controls,i=f.$edh,j=0;g.NavItem=e;function e(){}e._getItemId=function(){return "c_ci"+j++};g.NavLink=b;function b(d,b){var a=this;a._id=e._getItemId();a.$obj=c(d).first();a._isDisposed=false;if(b){a._$a=a.$obj.children("a").first();if(a._$a.length==0)a._$a=null;else a.id=a._$a.attr("id");sutra(a._$a,"$Sutra.Shared.NavLink",true);a._$span=a.$obj.children("span:not(.is_c)").first();if(a._$span.length==0)a._$span=null;a._$imageStrip=a.$obj.children("span.is_c").first();if(a._$imageStrip.length==0)a._$imageStrip=null;a._$sep=a.$obj.children("span.c_ms").first();if(a._$sep.length==0)a._$sep=null;a._$rchev=a.$obj.children("span.c_rchev").first();if(a._$rchev.length==0)a._$rchev=null}else h(a,false)}var a=b.prototype;a.setHtml=function(b){var a=this;d(a);a._$a.html(b);sutra(a._$a,"$Sutra.Shared.NavLink",true);if(a._$span){a._$a.detach();a._$span.html(b);a._$span.append(a._$a)}return a};a.setUrl=function(a){return this.setProperty("href",a)};a.setId=function(b){var a=this;a.id=b;return a.setProperty("id",b)};a.setProperty=function(c,b){var a=this;d(a);a._$a.attr(c,b);return a};a.enable=function(){var a=this;if(a._$span){i.e(a._$span[0]);a._$a=a.$obj.find("a").first();sutra(a._$a,"$Sutra.Shared.NavLink",true);a._$span=null}return a};a.disable=function(){var a=this;if(a._$a){i.d(a._$a[0]);a._$span=a.$obj.find("span").first()}return a};function d(a){if(!a._$a||a._$a.length==0){a._$a=c("<a></a>");sutra(a._$a,"$Sutra.Shared.NavLink",true);a.$obj.append(a._$a);a._isDisposed=false}}a.removeClick=function(){var a=this;if(a._aclickHandler&&a._$a)a._$a.unbind("click",a._aclickHandler);return a};a.addClick=function(c,b){var a=this;d(a);a.removeClick();if(!b)a.setUrl("#");a._aclickHandler=function(b){var a;try{a=c(b)}catch(d){$WebWatson.submitFromException(d);return false}return a};a._$a.click(a._aclickHandler);return a};a.addSeparator=function(){var a=this;if(!a._$sep){a._$sep=c('<span class="c_ms"></span>');a.$obj.append(a._$sep)}a._$sep.css("display","");return a};a.removeSeparator=function(){var a=this;if(a._$sep)a._$sep.hide();return a};a.addRChev=function(){var a=this;if(!a._$rchev){a._$rchev=c('<span class="c_rchev"></span>');a.$obj.append(a._$rchev);a._$rchev.html($menu.createChevron($menu.chevronTypes.SmallRightDark,true))}a._$rchev.show();return a};a.removeRChev=function(){var a=this;if(a._$rchev)a._$rchev.hide();return a};a.addImageStrip=function(d,b){var a=this;if(!a._$imageStrip){a._$imageStrip=c(d);if(b)a._$a.append(a._$imageStrip);else{a._$imageStrip.append(" ");a._$a.prepend(a._$imageStrip)}}return a};function h(a,b){if(b)a.$obj=null;a._$a=null;a._$span=null;a._$sep=null;a._$rchev=null;a._$imageStrip=null}a.dispose=function(){var a=this;if(!a._isDisposed){a.removeClick();h(a,true);a._isDisposed=true}};b.defaultOptions={html:"",separator:false,url:"#",id:"",click:null,container:"<li></li>",imageStrip:null};b.create=function(e){var a=c.extend({},b.defaultOptions,e),d=new b(a.container);d.setHtml(a.html);d.setUrl(a.url);d.setId(a.id);if(a.separator)d.addSeparator();if(a.click)d.addClick(a.click,a.url);if(a.imageStrip)d.addImageStrip(a.imageStrip);return d}})();(function(){ObservableArray=function(a){this.array=a};var k=ObservableArray.prototype;k.insert=function(b,d){var c=this;if(b>=0&&b<=c.array.length)a([c.array]).triggerHandler("arrayChange",["insert",b,d])};k.push=function(b){var a=this;a.insert(a.array.length,b)};k.remove=function(b){var c=this;if(b>=0&&b<c.array.length){var d=c.array[b];a([c.array]).triggerHandler("arrayChange",["remove",b,d])}};k.clear=function(){var a=this;while(a.array.length)a.remove(a.array.length-1)};k.length=function(){return this.array.length};Observable=function(a){this.obj=a};var D=Observable.prototype;D.setProperty=function(b,c){var d=this,e=d.obj[b];if(c!=e){d.obj[b]=c;a(d.obj).trigger("propertyChanged",[b,c,e])}};var C=window,a=C.jQuery,b=C.wLive.Controls,r=b.NavLink,A="c_m",o="c_sm",F="c_cmore",m="c_mcp",L=0,J=6;b.MenuDataModel=H;function H(){var a=this;a._isItemsHashDirty=true;a._itemsHashTable={};a._list=[];a.list=[]}b.Menu=e;function e(m,i,n,e,l){var c=this;c._id=b.NavItem._getItemId();var d=new b.MenuDataModel;c._items=[];c.$obj=a(m).first();e=e||{};if(!i){var o=$Config.isLightTheme?$menu.chevronTypes.SmallDownDark:$menu.chevronTypes.SmallDownLight,h=$menu.createChevron(o,true),g,f;if(l){g='<span class="c_mlu">'+h+"  &nbsp;</span>";f=""}else{g='<span class="c_mlu"></span>';f='<span class="c_chev"> '+h+"</span>"}var k='<a href="#" class="uxfa_ml c_ml" onclick="return false">'+g+f+'</a><ul class="uxfa_m '+A+' t_hovl"></ul>';if(n)c.$obj.append(k);else c.$obj.html(k)}c._$a=c.$obj.children("a.c_ml").first();c._navLink=new r(c.$obj,true);c._$mspan=c._$a.children("span.c_mlu").first();c._$chev=c._$a.children("span.c_chev").first();c._$ul=c.$obj.children("ul");if(c._$ul.length==0){c._$ul=a('<ul class="uxfa_m '+A+' t_hovl"></ul>');c.$obj.append(c._$ul)}c.id=c._$ul.attr("id");c._menu=c._$ul[0].binding;q(c);d._list=c._items;c._$a.bind("click.menu",function(a){a.preventDefault();j(a)});c._$a.bind("mousedown.menu",j);sutra(c._$a,"$Sutra.Shared.MenuLink",true);sutra(c._$ul,"$Sutra.Shared.MenuList",true);function j(a){if(!c._menu)if(!i){e.defaultLoc=L;if($menu.create(a,J,e))c._menu=c._$ul[0].binding}else c._menu=c._$ul[0].binding}c._dataModel=d;u(c,d._list);d.list=new ObservableArray(d._list)}var c=e.prototype;c.makeSubMenu=function(){var b=this,a=$menu.chevronTypes.SmallRightDark;if($B.rtl)a=$menu.chevronTypes.SmallLeftDark;b._$chev.html(" "+$menu.createChevron(a,true));return b};c.setHtml=function(b){var a=this;a._$mspan.html(b);return a};c.setId=function(b){var a=this;a._$ul.attr("id",b);a.id=b;return a};c.getDataModel=function(){return this._dataModel};c.getMenu=function(){return this._menu};c.getLink=function(){return this._navLink};c.add=c.push=function(c,e,d){var b=this;t(b,c,e);if(!d&&!c._$a.hasClass("c_ml"))a(c._$a).bind("click",$menu.closeAll);if(b._menu)b._menu.update();return b};c.remove=function(e,d,f){var b=this,c=s(b,e,d,f);a(c._$a).unbind("onclick",$menu.closeAll);if(b._menu)b._menu.update();return c};c.clear=function(){var a=this;B(a);if(a._menu)a._menu.update();return a};c.dispose=function(){var a=this;a._$a.unbind(".menu");a.clear();if(a._menu)a._menu.dispose()};e.defaultOptions={html:"",id:"",subMenu:false,container:'<li class="'+m+'"></li>',menuParams:null,linkId:""};e.create=function(d){var b=a.extend({},e.defaultOptions,d),c=new e(b.container);c.setHtml(b.html);c.setId(b.id);c._$a.attr("id",b.linkId);if(b.subMenu)c.makeSubMenu();return c};b.SplitMenuDataModel=E;function E(){var a=this;a.menu={}}b.SplitMenu=g;function g(f,d){var c=this;c._id=b.NavItem._getItemId();c._dataModel=new b.SplitMenuDataModel;c.$obj=a(f).first();c._$a=new r(c.$obj,d);if(d)c._$sep=c.$obj.children(".c_ms");else{c._$a.setHtml("&nbsp;");c._$sep=a('<span class="c_ms"> </span>');c.$obj.append(c._$sep);c.$obj.addClass(o+" "+m)}c._$menu=new e(c.$obj,d,true,{dockEl:c.$obj.get()[0]},true);c._dataModel.menu=c._$menu}var l=g.prototype;l.getDataModel=function(){return this._dataModel};l.dispose=function(){var a=this;if(a._$menu)a._$menu.dispose()};l.setProperty=function(c,b){var a=this;a.$obj.attr(c,b);return a};l.getMenu=function(){return this._$menu};l.getLink=function(){return this._$a};g.defaultOptions={id:"",linkId:"",container:"<li></li>"};g.create=function(d){var b=a.extend({},g.defaultOptions,d),c=new g(b.container);c.setProperty("id",b.id);c._$a.setId(b.linkId);return c};b.CommandBarDataModel=v;function v(c){var b=this;b._isItemsHashDirty=true;b._itemsHashTable={};b._logo=c&&c.logo||{containerWidth:"220px",imageStrip:"",text:"",title:"",url:"",hasPropertyText:false};b._list=[];b.isLightTheme=c&&c.isLightTheme;b.getIndexById=function(e){if(b._isItemsHashDirty)for(var a=0;a<b._list.length;a++){var d=b._list[a]._id,c=b._list[a].id;b._itemsHashTable[d]=a;b._itemsHashTable[c]=a}return b._itemsHashTable[e]};b.getItemById=function(c){var a=b.getIndexById(c);return b._list[a]};b.getItemByIndex=function(a){return this._list[a]};b._dispose=function d(){a(b.logo).unbind();a([b.list]).unbind();a(b.list).unbind()}}var N=v.prototype;b.CommandBar=j;function j(g,f,e){var c=this;c._id=b.NavItem._getItemId();c._needsToRender=false;c.$obj=a(g);var d=new b.CommandBarDataModel(e);sutra(c.$obj,"$Sutra.Shared.CommandBarControl",true);c._items=[];if(!f)c.$obj.html('<div class="c_clogo"><a href="#"><h1><span class="c_clogoimg"></span><span class="c_clogot"></span></h1></a></div><ul class="c_cc"></ul><div class="c_cme">></div>');c._$logo=c.$obj.children(".c_clogo");c._$logoImage=c._$logo.find(".c_clogoimg");c._$logoText=c._$logo.find("span.c_clogot");c._$logoLink=c._$logo.find("a");c._$ul=c.$obj.children("ul");sutra(c._$ul,"$Sutra.Shared.CommandBar",true);if(c._$logoImage.length==0){c._$logoImage=a('<span class="c_clogoimg"></span>');c._$logoText.parent().prepend(c._$logoImage)}q(c,"$Sutra.Shared.CommandItem");d._list=c._items;d._logo.imageStrip=c._$logoImage.html();c._dataModel=d;h(c._$logoText,d._logo,"text","innerHTML");h(c._$logoText,d._logo,"hasPropertyText",M,"function");h(c._$logoLink,d._logo,"url","href");h(c._$logoLink,d._logo,"title","title");h(c._$logoImage,d._logo,"imageStrip",K,"function");h(c._$logo,d._logo,"containerWidth",$B.IE_M6?"width":"min-width","style");u(c,d._list);d.logo=new Observable(d._logo);d.list=new ObservableArray(d._list)}function M(a,b){if(b)a.hide();else a.show()}function K(a,b){a.empty();a.append(b)}function h(b,f,e,c,d){a(f).bind("propertyChanged",function(h,f,a){if(e==f)if(d=="style")b.css(c,a);else if(d=="function")c(b,a);else b.attr(c,a)})}function u(b,c){a([c]).bind("arrayChange",function(f,e,c,d){if(!b._needsToRender)a(b).trigger("beforeRender");clearTimeout(b._renderTimeout);b._needsToRender=true;b._renderTimeout=setTimeout(function(){if(b._needsToRender&&b.render)b.render()},500);if(e=="insert")b.add(d,c);else if(e=="remove")b.remove(c,true,d)})}var d=j.prototype;d.add=d.push=function(a,c){var b=this;sutra(a.$obj,"$Sutra.Shared.CommandItem",true);t(b,a,c);return b};d.remove=function(b,a,c){return s(this,b,a,c)};d.addLightHover=function(){this.$obj.addClass("c_clih")};d.removeLightHover=function(){this.$obj.removeClass("c_clih")};j.defaultOptions={container:'<div class="c_c c_cbb c_ccptc"></div>'};j.create=function(c){var b=a.extend({},j.defaultOptions,c),d=new j(b.container);return d};d.render=function(){var b=this;clearTimeout(b._renderTimeout);a(b).trigger("afterRender");b._needsToRender=false};d.getDataModel=function(){var a=this;return a._dataModel};d.dispose=function(){var a=this;for(var b=0,c=a._items.length;b<c;b++)z(a,a._items[b],true);a._dataModel._dispose()};b.BreadcrumbBar=i;function i(e,d){var c=this;c._id=b.NavItem._getItemId();c.$obj=a(e);sutra(c.$obj,"$Sutra.Shared.BreadcrumbBar",true);c._items=[];if(!d)c.$obj.html("<ul></ul>");c._$ul=c.$obj.children("ul").first();q(c)}var f=i.prototype;f.get=d.get=c.get=function(a){return this._items[a]};f.add=f.push=function(b){var a=this,c=a._items.length;if(c>0){var d=a._items[c-1];d.addRChev().enable()}sutra(b.$obj,"$Sutra.Shared.Breadcrumb",true);b.setProperty("dir",$B.rtl?"rtl":"ltr");t(a,b);y(a);return a};f.remove=function(b,c){var a=this,d=s(a,b,c);if(b==a._items.length)y(a);return d};f.count=d.count=c.count=function(){return this._items.length};f.clear=d.clear=function(){var a=this;B(a);return a};f.dispose=function(){var a=this;a.clear()};i.defaultOptions={container:'<div class="c_bcb t_lnkpi"></div>'};i.create=function(c){var b=a.extend({},i.defaultOptions,c),d=new i(b.container);return d};var n=[],p;function x(){if(!p)p=setTimeout(I,0)}function I(){p=0;var b=n.length;for(var a=0;a<b;a++)n[a]();n.splice(0,b)}function w(a){n.push(a)}function q(b,c){var d=b._$ul.children("li");d.each(function(){var d=a(this);if(d.hasClass(o))b._items.push(new g(d,true));else if(d.hasClass(m)){if(!d.hasClass(F))b._items.push(new e(d,true))}else b._items.push(new r(d,true));if(c)sutra(this,c,true)})}function G(c){var b=c._items;for(var a=0;a<b.length;a++)c._$ul.append(b[a].$obj)}function t(c,b,d){if(!d&&d!=0)d=c._items.length;w(function e(){if(b.$obj){var g=c._$ul.children(),f=g[d];if(g.length==0||!f)c._$ul.append(b.$obj);else a(f).before(b.$obj);var e=b.$obj.css("display");if(e=="list-item"||e=="block"&&$B.IE_M7)b.$obj.css("display","");if(b.$obj.hasClass(m)&&!b.$obj.hasClass(o))G(b)}});c._items.splice(d,0,b);if(c._dataModel)c._dataModel._isItemsHashDirty=true;x()}function z(b,a,c){if(a&&!a._isDisposed){if(a.$obj){a.$obj.remove();if(b._dataModel)b._dataModel.isItemsHashDirty=true;b._$ul=b.$obj.children("ul")}if(c)a.dispose()}}function s(b,d,c){var a=b._items.splice(d,1)[0];if(!a._isDisposed){w(function e(){z(b,a,c)});x()}return a}function B(a){var b=a._items;if(b)for(var c=0;c<b.length;c++)b[c].dispose();a._items=[];a._$ul&&a._$ul.html("");return a}function y(c){var b=c._items,a=b.length;if(a>0)b[a-1].disable().removeRChev()._$span.addClass("link")}})();(function(){var b=window,a=b.jQuery,G=b.$edh,c=a(b),k={},v,E="resize",u="wlResize",s="c_cb0",x="c_cf",w="c_clh",j="visibility",m="hidden",e="visible",J=300,F=$B.rtl?"left":"right",y=_ge(s),d={},f,i,q,r,o;if(y)d=b.$CommandBar=k[s]=new wLive.Controls.CommandBar("#"+s,true,y.dataModel);else b.$CommandBar=d;d.showOptionsMenu=function P(q,f){var i=_ge("c_copt"),h=f._ge("c_copt"),d=i||h,l=f._ge("c_hiconc"),n,k;if(b!=f&&(!i||!h.isCopied||!o)){if(i){a(i).remove();d=h}var m=$header.getDummyHeader().firstChild,j=f.$f.getLocation(l,1,1),g=document.createElement("ul"),e=document.createElement("a");g.innerHTML=d.innerHTML.replace(/window\./g,"_ge($PF.fid).contentWindow.");g.className=d.className;g.id=d.id;h.isCopied=1;o=1;e.style.position="absolute";e.style.top=j.bottom+"px";e.style.left=($B.rtl?j.left:j.right)+"px";e.style.height=0;e.style.padding=0;d=g;n=e;m.appendChild(e);m.appendChild(g);b.$Config.Themes=f.$Config.Themes;k=1;b.$header.copyThemeToOuterFrame(f);c.bind("resize.cb",function(){o=0});b.$header.reportBSIMenu(a("#c_cof"),"c_cof");b.$header.reportBSIMenu(a("#c_coh"),"c_coh")}if(d.binding)d.binding.toggleState();else{var p=l.parentNode;$menu.create(q,1,{sourceEl:n,menuEl:d,pressedStateEl:p})}if($Config.Themes.ThemeService)$Do.when("$ThemeMenuInit",0,k)};d.getInstanceById=function O(a){if(!k[a]){var b=_ge("#"+a);if(b)k[a]=new wLive.Controls.CommandBar("#"+a,true,b.dataModel)}return k[a]};d.invalidateOptionsMenu=function N(a){var b=a._ge("c_copt");b.isCopied=false};var h={},l,n=0;h.Start=function(){c.bind(E,C)};h.Stop=function(){c.unbind(E,C)};function C(){r=0;if(!l){g=true;l=$f.docWidth()}if(!n){n=1;z()}}var g=false;function z(){var c=$f.docWidth();if(c!=l){g=true;l=c;setTimeout(z,10)}else if(g){n=0;g=false;a(b).trigger(u)}else n=0}function B(){var c=J-a("#c_cb0 .c_cme").outerWidth();a("#c_cb0 .c_cc").css("padding-"+F,c+"px");a(b).trigger("resize")}function K(){a("#c_cb0 .c_cc").css("padding-"+F,0);a(b).trigger("resize")}function H(){$Do.when("$WLXIM.SidebarCreated",0,function(){if($WLXIM.isSidebarOpened())B();a($WLXIM.sidebar).bind("onSidebarOpenedEvent",B);a($WLXIM.sidebar).bind("onSidebarClosedEvent",K)});var p=$css.getCN("c_c","div",document);for(var o=0;o<p.length;o++){var g=p[o],l=a(g),k=l.children(".c_cc")[0],j=d.getInstanceById(g.id);if(!l.hasClass("c_ncolapse")){var s=j&&!j.getDataModel().isLightTheme,v=$B.IE_M6?"block":$B.IE_M7?"inline":"inline-block";g.collapse=new CollapsingMenu(g.m,g.i,k,v,14,0,M(g.id),s);if(g.r)g.collapse.redraw();g.DisableCommand=function(a){var b=g.getElementsByTagName("a")[a];G.d(b)};g.EnableCommand=function(a){var b=g.getElementsByTagName("a")[a].parentNode;G.e(b)};g.dispose=function(){c.unbind("unload",g.dispose)};var n=window.$Config;if(n&&n.CommandBar&&n.CommandBar.resize){c.bind(u,g.collapse.redraw);if(j){f=a("#c_cb0 h1");i=a("#c_clogoc");q=i.siblings(".c_ms");_$emptyLogoLink=a("#c_cb0.c_cle a.c_clogot");I(l);if(_$emptyLogoLink.length){_$emptyLogoLink.unbind();_$emptyLogoLink.bind("click",function(){return false})}a(j).bind("beforeRender",function(a){g.style.overflow=m;k.style.overflow=m;g.collapse.redraw(a,true)});a(j).bind("afterRender",function(){g.collapse.redraw();g.style.overflow=e;k.style.overflow=e});var r=a("#c_cb0 h1 .c_clogot");f.bind("keydown",L);f.hover(D,t);r.focus(D);r.blur(function(a){t(a,true)});a("#c_cb0 h1 #c_clogoc").blur(t)}h.Start();g.dispose=function(){h.Stop();c.unbind(u,g.collapse.redraw);if(j){a("a",l).unbind();a(j).unbind();a("#c_clogoc").unbind();j.dispose();if(b.$WLXIM&&$WLXIM.sidebar)try{a($WLXIM.sidebar).unbind()}catch(d){}}c.unbind("resize.cb");c.unbind("unload",g.dispose)};j&&j.render()}c.bind("unload",g.dispose)}k.style.overflow=e}}function I(a){a.delegate("a",{"mousedown.cb":A,"focus.cb":A,"blur.cb":p,"mouseup.cb":p,"mouseleave.cb":p,"dragstart.cb":$f.cancelEvent})}function L(a){v=a.shiftKey}function D(){f.addClass(w);i.css(j,e);q.css(j,e)}function t(b,a){if(b.type!="blur"||v&&a||!v&&!a){f.removeClass(w);i.css(j,m);q.css(j,m)}}function A(){if($B.IE&&$B.V<=8)this.hideFocus=true;a(this).addClass(x)}function p(){a(this).removeClass(x)}function M(b){return function(){var c="#"+b,f=a(c),e;if(f.length){var d=r;if(!d){var g=a(c+" .c_cme"),h=g.outerWidth();d=a(c).outerWidth()-a(c+" .c_clogo").outerWidth()-h}if(d>0){r=d;e=a(c+" .c_cc").outerWidth()>d}}return e}}d.init=H;a(document).ready(function(){setTimeout(H,0)})})();(function(){var a=window,c=a.$AdServeMsngr=new b;function b(){var b=this,e=0,d=[],c=false;b.toFrame=function(b,c,d,a){g(b,c,d,"htof",a)};b.toHost=function(b,c,a){g(null,b,c,"ftoh",a)};function g(g,j,e,h,d){if(h=="htof"&&!g||!d||!j)return;e=e?b.serialize(e,"##","$$"):"";var i=b.serialize({frameName:g,message:e,fn:j},":",";");if(a["postMessage"]){var k=h=="htof"?a.frames[g]:a.parent;if(k)k.postMessage(i,"*")}else{var c=d.split("/");if(h=="ftoh"&&!(c.length>=3&&(c[0]=="http:"||c[0]=="https:")&&(c[2].indexOf(".live.com")!=-1||c[2].indexOf(".live-int.com")!=-1)))return;f(d+(d.indexOf("?")!=-1?"&":"?")+"c={cachebrk}"+"#"+i)}}function f(i){if(!c){c=true;var j="adNegFrm";e=e==0?1:0;i=i.replace("{cachebrk}",e);if(!a.frames[j]){var g=document.createElement("iframe");g.id=g.name=j;b.attachDOMEvent(g,"load",h);g.src=i;var k="adservtmp",f=document.getElementById(k);if(!f){f=document.createElement("div");f.setAttribute("id",k);f.style.display="none";document.body.appendChild(f)}f.appendChild(g)}else a.frames[j].location.replace(i)}else d.push(i)}function h(){c=false;if(d.length>0)f(d.shift())}b.receiveMessage=function(l){var g=l||event;if(!g||!g.data||!g.origin)return;var e=g.origin,d=null;if(a["$AdConfig"]&&(e.endsWith(".wlxrs.com")||e.endsWith(".wlxrs-int.com")||e.endsWith(".shared-dev.live-int.com")))d="ftoh";else if(a["$WLXRmAd"]&&(e.endsWith(".live.com")||e.endsWith(".live-int.com")))d="htof";if(!d)return;var c=b.deSerialize(g.data,":",";");if(!c||!c.fn)return;if(d=="htof"){if(!(c.fn=="$AdServe.refreshAd"||c.fn=="$AdServe.getRadIds"))return}else if(d=="ftoh"){if(!(c.fn=="$Acb.setRadIds"||c.fn=="$RmAdHandler.processMsg"||c.fn=="$RmAdHandler.processMsgFromHeader"))return}else return;var h=window;if(a["postMessage"])h=a;else{var i=c.frameName;if(d=="htof"&&i&&(i.endsWith("_frm")||i.endsWith("_hfrm")))h=a.parent.frames[i];else if(d=="ftoh")h=a.parent.parent}var k=c.fn.split("."),f=null;for(var j=0;j<k.length;++j){f=f?f[k[j]]:h[k[j]];if(!f)return}f(c.message?b.deSerialize(c.message,"##","$$"):null)};b.serialize=function(a,e,d){if(!a)return "";var c=[];if(typeof a=="object")for(var b in a)if(a[b]&&(typeof a[b]==="string"||typeof a[b]==="number"||typeof a[b]==="boolean"))c.push([encodeURIComponent(b),encodeURIComponent(a[b])].join(e||":"));return c.join(d||";")};b.deSerialize=function(e,g,f){var c={};if(!e)return c;var d=e.split(f||";");for(var b=0;b<d.length;++b){var a=d[b].split(g||":");if(a[0])c[decodeURIComponent(a[0])]=a[1]?decodeURIComponent(a[1]):""}return c};b.attachDOMEvent=function(a,b,c){if(a.addEventListener)a.addEventListener(b,c,false);else a.attachEvent("on"+b,c)}}})();(function(){var b=window,a=b.$Ads=new c;function c(){var c=this,e=$Cookie.getCookie,f=$Utility.deserialize;c.Tags={SDN:"SDN",SCT:"SCT",KW:"KW",PV:"PV"};c.IsInit=false;c.Init=function(a){if(d()&&(!a||$AdConfig.ear))b.setTimeout(h,$AdConfig.rd)};function h(){if(!a.IsInit){for(var d=0;d<$AdConfig.Data.length;++d){var b=$AdConfig.Data[d],e=b[4].indexOf("Crm")>=0?$AdConfig.crmrd:0;if(e>0)g(b,e);else c.InitAd(b)}$BSI.reportEvent("PartnerAdApiCall",null);$BSI.reportEvent("ClickedSelected.Business.AdCall",null)}}function g(d,a){b.setTimeout(function(){c.InitAd(d)},a)}c.InitAd=function(b){if(!b||!d()||!_ge(b[0]))return;if($AdConfig._dispose)return;if(!b.isInit){var c=_ge(b[0]+"_adchoice");if(c)c.style.display="block";$AdLoader.renderAd(b,true);b.isInit=true}if(!a._flexInit&&b[4].indexOf("Crm")==-1){$Flextag.load();a._flexInit=true}if(!a.IsInit){a.IsInit=true;a._lr=new Date;a._ac=0}if($Acb._initSkipped&&!$Acb._initRetried){$Acb.init();$Acb._initRetried=true}};c.DisableRefresh=false;c.Refresh=function(){if(!d()||$AdConfig._dispose||c.DisableRefresh)return;$BSI.reportEvent("PartnerAdApiCall",null);if(!a.IsInit)c.Init();else if(++a._ac>=$AdConfig.ar){var b=new Date;if($AdConfig.mi<(b-a._lr)/1e3){a._lr=b;a._ac=0;if($AdConfig.rCb)$AdConfig.rCb();$AdLoader.refreshAds()}}};c.Dispose=function(){if(!d())return;$AdLoader.dispose()};c.SetTag=function(c,b){if(!d())return;if(!b)b="";if(c){b=b.trim();if(c==a.Tags.PV&&!$AdConfig.dPVTag){if(b!="I"&&b!="R")b="";var e=function(a){a["pvTag"]=b};$AdConfig.Data.forEach(e)}}};c.SetSDTag=function(a){if(!d())return;if(!(a&&a.indexOf&&(a.indexOf("SDN=")>=0||a.indexOf("SCT=")>=0)))a="";var b=function(b){if(b[5])b["sdTag"]=a};$AdConfig.Data.forEach(b)};function d(){return typeof $AdConfig!="undefined"}c.getPGWithTags=function(a){if(!a)return "";var g=a["sdTag"]||"",d=a["pvTag"]||"",j=a[1],c=j+(g?"&"+g:"")+(d?"&WLV="+d:""),i=e("MH")||"",b=f(e("ANON")||""),h=e("MUID")||"";c+=(i?"&PN="+i.encodeUrl():"")+(b&&b.A?"&ID="+b.A.encodeUrl():"")+(h?"&MUID="+h.encodeUrl():"");return c};c.getAdData=function(b){if(b){var a=$AdConfig.itod[b];if(isNaN(parseInt(a)))return;return $AdConfig.Data[a]}}}})();(function(){var a=window;a.$AdLoader=new b;function b(){var b=this,c=false;b.renderAd=function(b,k){if(!b||!_ge(b[0]))return;if($BSI.isLoading()&&k)$CSIPerf.lapseTimer(b[4]);if(!$AdConfig.fl){var j=a["postMessage"];if(!c){if(j){var i=$AdServeMsngr;i.attachDOMEvent(a,"message",i.receiveMessage)}$AdConfig.ss.hnegurl=$AdConfig.ss.hnegurl.replace("!domain!",encodeURIComponent(document.domain));c=true}var h=b[0]+"_frm";if(!_ge(h)){var g=document.createElement("IFRAME");g.id=g.name=h;g.width=b[2];g.height=b[3];g.scrolling="no";g.frameBorder="0";g.allowTransparency=true;g.src=$AdConfig.ss.rurl.replace("{0}","adloader.html")+f(b)+"#"+$AdServeMsngr.serialize(e(h,true));_ge(b[0]).appendChild(g)}else if(!j&&b[4].indexOf("Crm")>=0)a.setTimeout(function(){d(h)},$AdConfig.crmrd||2e3);else d(h)}else{var l=_ge(b[0]);l.innerHTML=["<img src='",$AdConfig.burl,b[4],$AdConfig.ext,"' alt=''>"].join("")}if(k)$Acb.display(b[0])};b.refreshAds=function(){var e=false;for(var d=0;d<$AdConfig.Data.length;++d){var a=$AdConfig.Data[d];if(a.isInit&&_ge(a[0])){var f=jQuery("#"+a[0]+"_p").parent(),c=a[4].indexOf("Crm")==-1;if(c&&f.parent().is(":visible")||!c){f.css({display:"block"});$Acb.closePopover();$Acb.clearRadIds(a[0]);$RmAdHandler.dispose(a[0]);b.renderAd(a,false);if(!e&&c){$BSI.reportEvent("ClickedSelected.Business.AdCall",null);e=true}}}}};b.dispose=function(){var d,c;$AdConfig._dispose=true;$AdConfig.fl=true;$AdConfig.ar=1e4;for(var b=0;b<$AdConfig.Data.length;++b)try{c=$AdConfig.Data[b];var a=_ge(c[0]);while(a&&a.firstChild)a.removeChild(a.firstChild)}catch(e){}};function d(a){$AdServeMsngr.toFrame(a,"$AdServe.refreshAd",e(a,false),$AdConfig.ss.rurl.replace("{0}","AdServeMsg.html"))}function f(a){var b=$AdConfig.ss.srmad,c="";if($AdConfig.intad&&(b=="1"||b=="2")&&(a[0].indexOf("300x250")!=-1||a[0].indexOf("160x600")!=-1||a[0].indexOf("300x600")!=-1||a[0].indexOf("958x512")!=-1))c="?srmad="+b+"&ow="+a[2]+"&oh="+a[3]+"&el=300&er=0&et=100&eb=0";return c}function e(b,d){if(!b)return {};var c=$AdConfig.itod[b.replace("_frm","")],a=$AdConfig.Data[c];if(d)return {pgqp:$Ads.getPGWithTags(a),divid:a[0],wt:a[2],ht:a[3],pg:a[6],hnegurl:$AdConfig.ss.hnegurl,hstkn:$AdConfig.ss.hs,adenv:$AdConfig.intad?"int":""};else return {pgqp:$Ads.getPGWithTags(a)}}}})();(function(){var b=window;b.$RmAdHandler=new a;function a(){var b={},a=null,f=this;f.processMsg=function(e){if(e&&(e.hstkn&&e.hstkn==$AdConfig.ss.hs)&&e.adDivId&&e.act){var f=e.adDivId,g=$Ads.getAdData(f);if(!g)return;var h=c(e.adid);if(e.act=="init"){if(!b[f]){var i={adDivId:f,width:parseInt(g[2]),height:parseInt(g[3]),left:c(e.ol),right:c(e.or),top:c(e.ot),bottom:c(e.ob)};b[f]=new $RmExpAd;b[f].init(i,true);d("Init",h)}}else if(e.act=="exp"){if(b[f]&&parseInt(g[7]&1)==1){b[f].expand();d("Expand",h)}}else if(e.act=="col"){if(b[f]&&parseInt(g[7]&1)==1){b[f].collapse();d("Collapse",h)}}else if(e.act=="createH"){if(!a&&parseInt(g[7]&2)==2){a={};a[f]=new $RmHeaderAd;a[f].createAdContainer(f);d("HeaderCreate",h)}}else d("InvalidApi",h)}};f.processMsgFromHeader=function(b){if(b&&(b.hstkn&&b.hstkn==$AdConfig.ss.hs)&&b.adDivId&&b.act){var f=b.adDivId,i=$Ads.getAdData(f);if(!i)return;var g=c(b.adid);if(b.act=="initH"){if(e(f)){var h={adDivId:f,height:c(b.ht),bottom:c(b.ob)};a[f].init(h);d("HeaderInit",g)}}else if(b.act=="expH"||b.act=="colH"){if(e(f)){a[f].resize({easingb:c(b.easingb)},b.act=="expH");d(b.act=="expH"?"HeaderExpand":"HeaderCollapse",g)}}else if(b.act=="closeH"){if(e(f)){a[f].close();a[f]=null;a=null;d("HeaderClose",g)}}else d("InvalidApi",g)}};f.dispose=function(c){if(c){if(b[c]){b[c].resetUI();b[c]=null}if(a&&a[c]){a[c].resetUI();a[c]=null;a=null}}};function e(b){return b&&a&&a[b]}function c(b){var a=!isNaN(parseInt(b))?parseInt(b):0;return a>=0?a:0}function d(a,b){if(a)$BSI.reportEvent("ClickedSelected.Business.Ads",{RmAPI:a,RmAPIAdID:b||0})}}})();(function(){var e=window,a=e.jQuery,c="richmediaad";window.$RmExpAd=function(){};var b=$RmExpAd.prototype;b.init=function(k,h){if(!k)return;var l=this,d="px",b=this.params=k,i=b.adDivId;if(h){var g=_ge(i+"_p").style;g.position="relative";g.width=b.width+d;g.height=b.height+d}var f=_ge(i).style;if(h)f.position="absolute";f.width=b.width+d;f.height=b.height+d;f.top=0+d;f.left=0+d;var j=_ge(i+"_frm"),e=j.style;if(h)e.position="absolute";e.width=b.width+b.left+d;e.height=b.height+b.top+d;e.left=-b.left+d;e.top=-b.top+d;a(j).removeClass(c)};b.expand=function(){if(!this.params)return;var j=this,e="px",b=j.params,i=b.adDivId;d("expand",b);var g=_ge(i).style;g.width=b.width+b.left+b.right+e;g.height=b.height+b.top+b.bottom+e;g.left=-b.left+e;g.top=-b.top+e;var h=_ge(i+"_frm"),f=h.style;f.width=b.width+b.left+b.right+e;f.height=b.height+b.top+b.bottom+e;f.left=0+e;f.top=0+e;a(h).addClass(c)};b.collapse=function(){if(!this.params)return;d("collapse",this.params);this.init(this.params,false)};b.resetUI=function(){if(!this.params)return;var k=this,i="px",j=k.params,f=j.adDivId,g=_ge(f).style,b=_ge(f+"_p").style,h=_ge(f+"_frm"),e=h.style;g.position=b.position=e.position="static";g.top=b.top=e.top=0+i;g.left=b.left=e.left=0+i;a(h).removeClass(c);d("reset",this.params)};function d(d,h){var f=[_ge("SkyscraperContent"),_ge("RadAd_Skyscraper"),_ge("skyScraperContainer"),_ge("RadAdSkyscraper")];for(var e=0;e<f.length;++e)try{var b=f[e];if(b){var c=b.currentStyle;if(c&&c.position&&c.position=="absolute")if(d=="expand"){b.scrollTop=0;b.style.overflow="visible";if(!b.getAttribute("origZIndex"))b.setAttribute("origZIndex",c.zIndex||"");b.style.zIndex="2"}else{b.style.zIndex=b.getAttribute("origZIndex")||"";b.style.overflow="hidden"}}}catch(i){if($Config.isINT)throw i;}if($B.IE&&$B.V<=8&&_ge("HomeContent")&&_ge("MainHomePage")){var g={visibility:d=="expand"?"hidden":"visible"};if(h.top>0)a("#c_search_SearchBoxControl_f").css(g);if(h.left>0)a(".cc2_main_bk").css(g)}if(_ge("MainContent")&&_ge("SkyscraperContent"))a("#MainContent").toggleClass("rmadexpanded",d==="expand")}})();(function(){window.$RmHeaderAd=function(){};var a=$RmHeaderAd.prototype;a.createAdContainer=function(b){if(!b)return;if(!_ge("c_headerAd")){var e=document.createElement("div");e.setAttribute("id","c_headerAd");if(_ge("c_header"))_ge("c_header").parentNode.insertBefore(e,_ge("c_header"))}if(_ge("c_headerAd")&&!_ge(b+"_hfrm")){var a=document.createElement("IFRAME");a.id=a.name=b+"_hfrm";a.width="0px";a.height="0px";a.scrolling="no";a.frameBorder="0";a.allowTransparency=true;a.src=$AdConfig.ss.rurl.replace("{0}","headeradloader.html")+d()+"#"+$AdServeMsngr.serialize(c(b));_ge("c_headerAd").appendChild(a)}};a.init=function(e){if(!e||!_ge("c_headerAd"))return;var h=this,f="px",a=this.params=e,g=a.adDivId,d=_ge(g+"_hfrm").style;d.height=a.height+f;d.width="100%";var c=_ge("c_headerAd").style;c.height=a.height+f;c.width="100%";b()};a.resize=function(c,f){if(!c||!_ge("c_headerAd"))return;var i=this,j="px",a=i.params,g=a.adDivId,e=f?a.bottom:0,h=c.easingb>0&&c.easingb<a.bottom?c.easingb:e,d=a.height+h+j;_ge("c_headerAd").style.height=d;_ge(g+"_hfrm").style.height=d;b()};a.resetUI=a.close=function(){var a=_ge("c_headerAd");if(!a)return;while(a.firstChild)a.removeChild(a.firstChild);a.parentNode.removeChild(a)};function d(){var a="";if($AdConfig.intad)a="?srmad=2&ow=1800&oh=175&eb=250&el=0&et=0&rmh=1";return a}function c(a){return {divId:a,hnegurl:$AdConfig.ss.hnegurl,hstkn:$AdConfig.ss.hs,adenv:$AdConfig.intad?"int":""}}function b(){if($B.IE_M6&&_ge("c_header")){var a=_ge("c_header").style;a.display="none";a.display="block"}}})();(function(){var a=window,b=a.$Acb=new c;function c(){var c=this,n="acbc",h=null,k=false,j=false,d=null,u=null,t=false,g=[],e={Report:"c_ads_pr",ThankYou:"c_ads_pty",UpSell:"c_ads_pus"},p="c_ads_default_desctxt",f={};c.init=function(){if(!a["$AdConfig"]){b._initSkipped=true;return}if(a["$AdConfig"]&&$AdConfig.dp){var c=function(){if($AdConfig.pcss)$Network.fetchCSS($AdConfig.pcss,function(){j=true;m()},null);else j=true;if($AdConfig.pjs)$Network.fetchScript($AdConfig.pjs,function(){k=true;m()},null);else k=true;$Network.fetchXML($AdConfig.phtml,function(a){var b=!a||a.status!=200||!a.responseText;if(!b){h=a.responseText;m()}},"GET",null,null)};a.setTimeout(c,$AdConfig.pd)}};c.report=function(a){$BSI.reportEvent("ClickedSelected.Business.AdControlBar",{AdControlBarAction:"Report"});c.closePopover();u=a;l(e.Report);o(a)};c.close=function(a,f){$BSI.reportEvent("ClickedSelected.Business.AdControlBar",{AdControlBarAction:"Close"});c.closePopover();_ge(a+"_p").parentNode.style.display="none";if($AdConfig.eups){var d=$Cookie.getPersistentCookie(n);if(typeof d=="undefined")$Cookie.setPersistentCookie(n,"1");else{var b=(parseInt(d)+1)%$AdConfig.usi;$Cookie.setPersistentCookie(n,b);if(b%$AdConfig.usi==$AdConfig.uso){l(e.UpSell);$BSI.reportEvent("ClickedSelected.Business.AdControlBar",{AdControlBarAction:"Upsell"})}}}if(typeof f=="function")f(a);o(a);setTimeout(function(){q(a,$AdConfig.cadrsn,null)},1500)};c.closePopover=function(){if(d)d.minimize()};c.sendReport=function(){var b,f;for(var d=1;(f=_ge("c_ads_opt"+d))&&!b;d++)if(f.checked)b=d;l(e.ThankYou);var a=_ge("c_ads_desc_txt");if(a.value==a.getAttribute("defaultvalue"))a.value="";else c.ensureDescMaxLength(a,a.getAttribute("maxlength"));q(u,b,a.value)};function q(g,f,b){var a=c.getAdIds(g);for(var d in a)a[d]=a[d].encodeUrl();b=b?b.encodeUrl():"";var e=$AdConfig.furl.format(a.adid,a.pid,a.targetid,a.url,a.pg,f,$AdConfig.fcan.encodeUrl(),b)+"&cb="+(new Date).getTime();$Beacon.fire(e,$BSI.addLDToHash({}))}c.toggleSend=function(b){_ge("c_ads_pr_sub").disabled=!b;if(!b){var c=1,a;while(a=_ge("c_ads_opt"+c++))a.checked=false;r(_ge("c_ads_desc_txt"))}};c.display=function(b){var a=_ge(b+"_acb");if(a)if($AdConfig.dp&&s()||!$AdConfig.dp)v(a);else g.push(a)};c.ensureDescMaxLength=function(b,a){if(isNaN(parseInt(a,10)))a=200;if(b.value.length>a){b.value=b.value.substring(0,a);return false}else return true};this.onDescFocus=function(a){if(a.value==i(a)){$css.remove(a,p);if($B.Firefox||$B.IE)a.select();else a.value=""}};this.onDescBlur=function(a){if(a.value==""||a.value==i(a))r(a)};function r(a){$css.add(a,p);a.value=i(a)}function i(a){return a.getAttribute("defaultvalue")}function o(a){var b=$AdConfig.Data[$AdConfig.itod[a]];if(!f[a])$AdServeMsngr.toFrame(b[0]+"_frm","$AdServe.getRadIds",null,$AdConfig.ss.rurl.replace("{0}","AdServeMsg.html"))}var m=function(){if(g&&s()){for(var a=0;a<g.length;a++)v(g[a]);g=null}},v=function(a){if(a)a.style.display="inline"},s=function(){return j&&k&&h!=null},l=function(b){if(!(a["$UI"]&&$UI.Popover&&h))return;if(!d){var f=a._ce("div");d=new $UI.Popover;f.innerHTML=h;d.width=500;d.showFooter=false;d.showHeader=false;d.body=f;d.modal=false;d.bodyPadding=5}if(!t){d.show(function(){c.closePopover();return false});t=true;w(b)}else{w(b);d.restore()}switch(b){case e.Report:_ge("c_ads_opt1").focus();break;case e.ThankYou:_ge("c_ads_pty_close").focus();break;case e.UpSell:_ge("c_ads_pus_close").focus()}},w=function(b){var d,a;for(d in e){a=e[d];_ge(a).style.display=b==a?"block":"none"}if(b==e.Report)c.toggleSend(false)};c.setRadIds=function(a){if(a&&(a.hstkn&&a.hstkn==$AdConfig.ss.hs)&&a.hostAdDivId){var b={};b.adid=a.adid||"";b.pid=a.pid||"";b.targetid=a.targetid||"";b.pg=a.pg||"";b.url=a.url||"";f[a.hostAdDivId]=b}};c.clearRadIds=function(a){if(f[a])f[a]=null};c.getAdIds=function(a){if(f[a])return f[a];else return {adid:"",pid:"",targetid:"",url:"",pg:""}}}})();$Ads.Init(true);$Acb.init();(function(){var i=window,E=i.Debug;if(!i.$IS)i.$IS={};var d=i.$IS,h=$css.has,l=Math.abs,t="top",s="left",e="height",f="width",b="px",c="backgroundPosition",p="backgroundImage",a="style",k="parentNode",z="auto",g="IMG",j="is_c",n="is_hc",B=i.$Utility.isHighContrast();d.setClass=function(l,p){if(!l)return;var d=o(l);if(d){var b=d.getElementsByTagName(g)[0],c=h(d,n);b.className=(c?"is_hcimg ":"is_img ")+p;if(c){var s=b[k],t=jQuery(b),i=q(b);if(!m()){b[a][f]="";b[a][e]=""}var j=r(s);x(b,i.x,i.y,j.h,j.w,c)}}};d.toggle=function D(v,u,l){if(!v||u==0)return;var f=o(v);if(f){var b=f.getElementsByTagName(g)[0],e=h(f,j),p=b;if(!e)p=b[k];if(l){b.alt=l;if(b.title!=null)b.title=l}var n=jQuery(b),c=n.css(s)||b[a][s],d=n.css(t)||b[a][t];if(e){var m=q(b);c=m.x;d=m.y}c=parseInt(c);d=parseInt(d);var i=r(p),w=d-i.h*u;x(b,c,w,i.h,i.w,!e)}};function x(d,g,h,j,k,i){if(i){d[a][t]=h+b;d[a][s]=g+b;if(!m()){d[a][e]=l(h)+j+b;d[a][f]=l(g)+k+b}}else d[a][c]=g+b+" "+h+b}d.Create=C;function C(m,n,r,o,l,q,i,h){var k=v("span",0,j),d=v(g,k,"is_img");d.src=l+"is/invis.gif";d[a][f]=r+b;d[a][e]=o+b;d[a][c]="-"+m+b+" -"+n+b;d[a][p]="url('"+q+"')";h=h||h==""?h:i;d.alt=i;d.title=h;u(d);return k}d.CreateFromConfig=A;function A(c,a,b){c=y(c.split(","));a=y(a.split(","));b=b?b.trim():b;var e=$B.rtl&&c[1]?c[1]:c[0];return d.Create(a[0],a[1],a[2],a[3],b,b+e,a[4])}function y(a){for(var b=0;b<a.length;b++){var c=a[b];if(c)a[b]=c.trim()}return a}function o(c){if(c){var d=c.getElementsByTagName("span"),g=d.length,i,a=-1;for(;a<g&&!i;a++){var b=a==-1?c:d[a],f=h(b,j),e=h(b,n);if(f||e)return b}}return null}function v(d,b,c){var a=document.createElement(d);a.className=c;if(b)b.appendChild(a);return a}d.Init=u;function u(b){if(b.tagName!=g)b=o(b).getElementsByTagName(g)[0];if(b&&h(b,"is_img")){var J=b[a],e=b[k];if(e){e.dir=$B.ltr?"ltr":"rtl";var d=m();if(B||!d){var i='"style="width:{2}px;height:{3}px;"',v='<span class="',A='<img src="{6}"',w="</span>",H=[v,"is_o",i,">",v,"is_i",i,">",A,'class="is_hcimg {11}"alt="{1}"{10}style="left:-{4}px;top:-{5}px;width:{7}px;height:{8}px;{9}"/>',w,w,A,'class="is_p',i,"/>"].join(""),G=e[k];if(G){var u=G.getElementsByTagName("span"),t=0;for(;t<u.length;t++)u[t][a].zoom=1}var c=J[p],x=c.indexOf("http");c=c.substr(x,c.length-x-(c.endsWith('")')?2:1));var f=r(b),D=q(b),E=l(D.x),F=l(D.y),C,y;if(!d){C=E+f.w;y=F+f.h}var s=b.title,I=H.format(b.src.encodeHtmlAttribute(),b.alt.encodeHtmlAttribute(),f.w,f.h,E,F,(d?c:b.src).encodeHtmlAttribute(),d?z:C,d?z:y,d?"":"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+c.encodeHtmlAttribute()+"',sizingMethod='crop');",s||s==""?'title="'+s.encodeHtmlAttribute()+'"':"",b.className.replace("is_img",""));$css.swap(e,j,n);e.innerHTML=I}}}}d.disposeAll=w;function w(f){var e=f.getElementsByTagName(g);for(var d=0,h=e.length;d<h;d++){var c=e[d],b=c.className;if(b=="is_img"||b=="is_hcimg"||b=="is_p"){c.onload=null;c[a][p]=""}}}function m(){return !$B.IE_M6||$B.IEM_M8}function q(f){var d=jQuery(f),b=f[a],e=(b[c]||d.css(c)||"").split(" "),g=parseInt(b[c+"X"]||d.css(c+"X")||e[0]),h=parseInt(b[c+"Y"]||d.css(c+"Y")||e[1]);return {x:g,y:h}}function r(b){var g=jQuery(b),d=b[a],c=b.currentStyle||(window.getComputedStyle?window.getComputedStyle(b,0):{}),i=parseInt(d[f]||c[f]||g.css(f)),h=parseInt(d[e]||c[e])||g.css(e);return {w:i,h:h}}$Do.register("$IS.Init",u);$Do.register("$IS.disposeAll",w)})();(function(){var b=window;b.$Trie=a;function a(f){var b=this,a=[],d=f,c=false;b.remove=function(b){a.remove(b)};b.insert=function(e,d){var b={key:e,datum:d};a.push(b);c=false;return b};b.sort=function(){if(!c)a.sort(function(c,d){var a=c.key,b=d.key;if(a>b)return 1;if(b>a)return -1;return 0});c=true};b.matchPrefix=function(n,p){var h=null,f=null,g=null,q=null,c=null,l=null,k=null;b.sort();h=e(n);if(h==null)return [];for(f=h;f>0;f--)if(!a[f-1].key.startsWith(n))break;for(g=h+1;g<a.length;g++)if(!a[g].key.startsWith(n))break;c=new Array(g-f);for(var i=0;i<c.length;i++){var o,m=a[f+i];if(p)o={key:m.key,datum:m.datum};else o=m.datum;c[i]=o}if(d){c.sort(d);l=[k=c[0]];for(var j=0;j<c.length;j++)if(d(k,c[j]))l.push(k=c[j]);return l}else return c};function e(d){var f=0,e=a.length-1,b=null,g=null,c=null;while(f<=e){b=Math.floor((f+e)/2);c=a[b].key.substring(0,d.length);if(d>c)f=b+1;else if(d<c)e=b-1;else return b}return null}}})();function ic_showBar(c){try{var b=c+"_bar",a=_ge(b);if(a)a.style.visibility="inherit"}catch(d){}}function ic_onTE(a){try{var c=a.getAttribute("errsrc")||$icerrsrc;if(a.src!=c){a.className="c_ic_tile";var b=a.style;b.top=b.left=b.height=b.width="";setTimeout(function(){a.src=c;a.style.visibility=""},0)}}catch(d){}}function ic_onTL(a){try{var d,c,g=0;a.className="c_ic_tile";if(a.naturalHeight){d=a.naturalWidth;c=a.naturalHeight}else{var f=new Image;f.src=a.src;d=f.width;c=f.height}var b;if(window.getComputedStyle)b=window.getComputedStyle(a,"");else b=a.currentStyle;if(d==1&&c==1||b&&b.width=="1px"&&b.height=="1px"){ic_onTE(a);return}var h=Math.round;if(d&&c&&d!=c&&b){var e=a.style;if(d>c){var i=parseInt(b.height),j=parseInt(b.width),k=h(d*(i/c));g=-h((k-j)/2);e.left=g+"px";e.maxWidth="none";e.width="auto"}else{e.maxHeight="none";e.height="auto"}}a.style.visibility=""}catch(l){}}(function(){var a=window,b=a.$WebWatson,d=a.$Logout=new c;function c(){var d=this,a=[],c;d.add=function i(b){a.push(b)};d.remove=function h(b){a.remove(b)};d.doLogout=function g(g){var h,j=0,m=a.length;c=0;if(!g.shiftKey&&!g.ctrlKey&&!g.altKey){var d=g.target;while(d){if(d.tagName=="A"){var i=d.href;if(i){var l=d.target;$f.cancelEvent(g);h=new f(i,l);setTimeout(function(){e(i,l)},1e3)}break}d=d.parentNode}}var k="$logout";h.pause(k);for(;j<m;j++)try{a[j](h)}catch(n){b.submitFromException(n)}h.resume(k)};function e(b,a){if(!c){c=1;$BSI.navigateTo(b,a)}}function f(d,c){var b=this,a=[];b.pause=function(b){a.push(b)};b.resume=function(b){a.remove(b);if(a.length==0)e(d,c)}}}})();(function(){var w=window,$Cookie=w.$Cookie,$WebWatson=w.$WebWatson,$Network=w.$Network,Debug=w.Debug,smartSetTimeout=w.smartSetTimeout,wl=w.wLive,_constNull=null,c_IdName="id",c_ClassName="className",c_InnerHTML="innerHTML",c_AppendChild="appendChild",c_EmptyString="",c_ElTypeDiv="DIV",c_ElTypeSpan="SPAN",c_CloseIcon_resource="webim/close_icon_1.png",c_BackIcon_resource="webim/Back_Rest.png",c_BackIcon_resource_rtl="webim/Back_Rest_RTL.png",c_MessagingIcon_resource="webim/messaging_icon.png",c_loading_resource="common/progress_loading.gif",c_StringsNamespace="live.shared.strings.",c_UpsellHeaderString="WebIM.Client.UpsellHeader",c_UpsellBodyString="WebIM.Client.UpsellBody",c_UpsellConnectString="WebIM.Client.UpsellConnect",c_UpsellFriendsString="WebIM.Client.UpsellFriends",c_UpsellCloseString="WebIM.Client.UpsellClose",c_LoadingString="WebIm.Client.Loading",c_UnknownContact="WebIm.Client.UnknownContact",c_StatusUnavailable="WebIm.Client.StatusUnavailable",c_signin="WebIM.Client.MessagingSignIn",c_reconnect="WebIM.Client.MessagingReconnect",c_reconnectButton="WebIM.Client.ReconnectNow",c_signout="WebIM.Client.MessagingSignOut",c_signinButton="WebIM.Client.MessagingSignInButton",c_recview_opened_state=0,c_sidebar_closed_state=-1,c_fbSourceId="FB",c_maxWidth=1e5,minWidthToOverlay=c_maxWidth,c_sidebar_width=300,network_icons=new Array(1);network_icons[c_fbSourceId]="sn/PsaMedium/FBActive.png";var network_names=new Array(1);network_names[c_fbSourceId]="Facebook";var fixedRecConvElementsHeight,chat_control,chat_control_conversation,conversationSelectedContactId,conversationSelectedContactIMAddress,conversationSelectedContact,selectedAggregatedConversation,unreadMessageCount=0,unreadMessageCountHash={},toastList={},sidebarOverlayMode=false,sidebarOpened=false,chatViewOpened=false,paneToResizeSelector,uiStylesDownloaded,uiStylesLoading,hasUpsell=false,noSpaceForUpsell=false,sidebarTop=40,c_fixedRecConvTopHeight=85;function WLXIMConstructor(){var _this=this,user,_constPresenceCookieName="pres",_constPresenceCookieSeperator="=",_config=w.$Config,_handlerBaseUrl=_config.handlerBaseUrl,_webIMConfig,_microsoftLive,_microsoftLiveMessenger,_stateListeners=[],_innerWindowListeners=[],_innerWindow,_initializedMessengerLibrary,_startedDownloadingResources,_isDownloadPaused,_waitingToDownload,_NumOfResourcesToDownload=3,_resourcesDownloaded=0,_resourcesToDownload=_NumOfResourcesToDownload,_innerResourcesDownloaded,_localStoreLoaded,_wimpComplete,_loadCoreComplete,_encounteredLoadingError,_trace,_unsupportedBrowser,_hasReportedIMStart,_loggingOutOfWindowsLive,_logoutEventHandler,_signInCompletedOccurred,_signedInLapseTimerSet,_signInWhenYouCan,_signOutWhenYouCan,_vv=_this.vv={};_this.outerWindow=window;_this.isOff=function $WLXIM$isOff(){return !_signInWhenYouCan&&(!_startedDownloadingResources||getSharedPresenceCookie()==0)};_this.isUnsupported=function $WLXIM$isUnsupported(){return _unsupportedBrowser};_this.isLoading=function $WLXIM$isLoading(){return !_this.isOff()&&!this.isError()&&(!user||user.get_status()==_microsoftLiveMessenger.UserStatus.signingIn||user.get_status()==_microsoftLiveMessenger.UserStatus.signingOut)};_this.isError=function $WLXIM$isError(){return !_this.isOff()&&(_encounteredLoadingError||user&&user.get_status()==_microsoftLiveMessenger.UserStatus.signedOut)};_this.isWaitingToReconnect=function $WLXIM$isWaitingToReconnect(){return !_this.isOff()&&user&&user.get_status()==_microsoftLiveMessenger.UserStatus.autoReconnectWaiting};_this.hasContacts=function $WLXIM$hasContacts(){return _signInCompletedOccurred};_this.hasNotify=function $WLXIM$hasNotify(){return isSignedIn()};_this.hasPresence=function $WLXIM$hasPresence(){return isSignedIn()&&user.get_services()>_microsoftLiveMessenger.SessionServices.notifications};_this.isFull=function $WLXIM$isFull(){return isSignedIn()&&user.get_services()==_microsoftLiveMessenger.SessionServices.full};function isSignedIn(){return user&&user.get_status()==_microsoftLiveMessenger.UserStatus.signedIn}_this.addStateListener=function $WLXIM$addStateListener(a){_stateListeners.push(a)};_this.removeStateListener=function $WLXIM$removeStateListener(a){var b=_stateListeners.remove(a)};_this.addInnerWindowListener=function $WLXIM$addInnerWindowListener(a){_innerWindowListeners.push(a)};_this.removeInnerWindowListener=function $WLXIM$removeInnerWindowListener(a){var b=_innerWindowListeners.remove(a)};_this.signIn=function $WLXIM$signIn(){if(user&&user.get_status()==_microsoftLiveMessenger.UserStatus.signedIn){setSharedPresenceCookie(1);switchToSignedIn()}else{_signInWhenYouCan=1;_signOutWhenYouCan=0;informStateChange()}};_this.signOut=function $WLXIM$signOut(){if(user&&user.get_status()==_microsoftLiveMessenger.UserStatus.signedIn)switchToSignedOut();else{_signInWhenYouCan=0;_signOutWhenYouCan=1;informStateChange()}};_this.reconnect=function $WLXIM$reconnect(){if(_this.isWaitingToReconnect())user.signIn()};_this.toggleSidebar=function $WLXIM$toggleSidebar(){var a=jQuery("#sidebar");if(a.length>0)if(a.is(":hidden"))showSidebar();else hideSidebar()};_this.onUpsellClose=function $WLXIM$onUpsellClose(){jQuery(".rec_conv_ups").hide();hasUpsell=false;showOrHideUpsell();$Cookie.setCookie("Webim_Upsell_Close","cid="+$Config.cid,$Config.sd,0,null,1)};_this.onChatViewBack=function $WLXIM$onChatViewBack(){animateRecConvView();chatViewOpened=false;resetConversationSelected()};_this.onConversationSelected=function $WLXIM$onConversationSelected(b,a){startConversation(a.buddyId);animateChatView()};_this.onConversationUpdated=function $WLXIM$onConversationUpdated(b,a){if(a.get_reloaded()||sidebarOpened&&chatViewOpened&&conversationSelectedContactId&&conversationSelectedContactId==b.get_id()||user.get_address()==a.get_sender())return;incrementUnreadMessageCount(b.get_id());if(!a.get_isOfflineMessage()&&a.get_type()==Microsoft.Live.Messenger.MessageType.textMessage){var c=b.get_displayName();showToast(c,a.get_text(),b.get_id())}};function showToast(g,d,a){if($B.Mobile==1)return;var f=jQuery("<div class='imToastHeader' />").append(Microsoft.Live.Messenger.MessengerUtility.replaceEmoticons(g)),c=jQuery("<div class='imToastBody' />").append(Microsoft.Live.Messenger.MessengerUtility.replaceEmoticons(d)),e=getWebIMImage(c_MessagingIcon_resource),b=window.wLive.Controls.Notifications.createToast({title:f,content:c,sourceIcon:e,options:{moreCss:"t_cbr"}});removeToastFromQueue(a);toastList[a]=b;b.show().then(function(b){if(b.clicked)$WLXIM.onToastClicked(a)})}function removeToastFromQueue(a){if(toastList[a])try{toastList[a].dismiss();var b=window.wLive.Controls.Notifications.getQueue();if(b)b.removeNotification(toastList[a])}catch(c){}}function startConversation(a){if(jQuery("#rec_conv").length==0)createSidebarContent();resetConversationSelected();conversationSelectedContactId=a;chatViewOpened=true;if(uiStylesDownloaded)createChatControl();conversationSelectedContact=user.get_contacts().findByIdWithoutRoleCheck(a);setChatViewName(conversationSelectedContact)}function resetUnreadMessageCount(a){if(unreadMessageCountHash[a]){unreadMessageCount-=unreadMessageCountHash[a];unreadMessageCountHash[a]=0;updateMessagingCount()}}function incrementUnreadMessageCount(a){unreadMessageCount++;updateMessagingCount();if(unreadMessageCountHash[a])unreadMessageCountHash[a]=unreadMessageCountHash[a]+1;else unreadMessageCountHash[a]=1}function updateMessagingCount(){var a;if(unreadMessageCount>99)a="99+";else if(unreadMessageCount>0)a=unreadMessageCount;else a="";var b=_innerWindow.jQuery("#c_ofm"),c=b.parent();b.html(a);_innerWindow.jQuery("#c_hiconm").width(c.width()+"px")}_this.isSidebarOpened=function $WLXIM$isSidebarOpened(){return sidebarOpened};_this.isSidebarOverlay=function $WLXIM$isSidebarOverlay(){return sidebarOverlayMode&&jQuery(window).width()<minWidthToOverlay};_this.setPaneToResize=function $WLXIM$setPaneToResize(a){paneToResizeSelector=a;if($WLXIM.isSidebarOpened())onSidebarOpenedCallback(null,_this.isSidebarOverlay())};_this.resetSidebarOverlaySettings=function $WLXIM$resetSidebarOverlaySettings(){sidebarOverlayMode=false;minWidthToOverlay=c_maxWidth};_this.setSidebarOverlay=function $WLXIM$setSidebarOverlay(a){sidebarOverlayMode=a};_this.setSidebarOverlayWindowWidth=function $WLXIM$setSidebarOverlayWindowWidth(a){sidebarOverlayMode=true;minWidthToOverlay=a};_this.setSidebarToFullScreen=function $WLXIM$setSidebarToFullScreen(b,a){if(b==true)sidebarTop="0px";else sidebarTop=getHeaderHeight(a)+"px";jQuery("#sidebar").css("top",sidebarTop)};_this.startConversationWithContactId=function $WLXIM$startConversationWithContactId(a){var b=user.get_contacts().findByIdWithoutRoleCheck(a);conversationSelectedContactIMAddress=b.get_currentAddress();startConversation(a);showSidebar()};_this.startConversationWithContact=function $WLXIM$startConversationWithContact(a,b,d){var c=$WLXIM.getConversationAddress(a,b,d);conversationSelectedContactIMAddress=c;startConversation(a.get_id());showSidebar()};_this.startConversationWithIMAddress=function $WLXIM$startConversationWithIMAddress(b,a){conversationSelectedContactIMAddress=a;startConversation(b.get_id());showSidebar()};_this.onToastClicked=function $WLXIM$onToastClicked(a){startConversation(a);showSidebar()};_this.switchPresence=function $WLXIM$switchPresence(a){if(user)user.get_presence().set_status(a)};_this.isVVWindow=function $WLXIM$vv$isVVWindow(){return _webIMConfig.vv};_vv.isCapableBrowser=function $WLXIM$vv$isCapableBrowser(){return _webIMConfig.vvb};_this.onUpsellClicked=function $WLXIM$onUpsellClicked(){var a=$Config.WebIM.nm;if(window.$PF)a+=window.$PF.afu;else a+=location.href;var b=window.open(a,"","height=520,width=720");if(b){$Cookie.setCookie("UpsellClicked","1",$Config.sd,0,null,1);if(window.focus)b.focus()}return false};function getHeaderHeight(a){var b=40;if(a==null)a=_innerWindow;if(a)if(a.jQuery("#m_wh").length>0)b=a.jQuery("#m_wh").height();else if(a.jQuery("#HeaderContainer").length>0)b=a.jQuery("#HeaderContainer").height();return b}function showSidebar(){if($B.Mobile==1)return;if(jQuery("#rec_conv").length==0)createSidebarContent();var a=jQuery("#sidebar");if(a.is(":hidden")){a.show();triggerSidebarEvent("onSidebarOpenedEvent",_this.isSidebarOverlay());if($B.rtl==1)a.css("left","0px");else a.css("right","0px");wLive.Animations.showEdgeUI(a,{left:jQuery(_innerWindow).width(),top:0}).then(function(){showSidebarContentView();triggerSidebarEvent("onSidebarOpenCompletedEvent",_this.isSidebarOverlay());if($B.IE_M7==1&&paneToResizeSelector&&paneToResizeSelector.length>0){var a=paneToResizeSelector.get(0),b=a.style.display;a.style.display="none";a.offsetHeight;a.style.display=b}})}else showSidebarContentView();sidebarOpened=true}function hideSidebar(){if($B.Mobile==1)return;sidebarOpened=false;var a=jQuery("#sidebar");if(!a.is(":hidden")){triggerSidebarEvent("onSidebarClosedEvent",null);if($B.rtl==1)wLive.Animations.hideEdgeUI(a,{left:c_sidebar_width,top:0}).then(function(){a.hide();hideChatView();hideRecConvView();triggerSidebarEvent("onSidebarCloseCompletedEvent",null)});else wLive.Animations.hideEdgeUI(a,{left:c_sidebar_width,top:0}).then(function(){jQuery(a).css("left","");a.hide();hideChatView();hideRecConvView();triggerSidebarEvent("onSidebarCloseCompletedEvent",null)})}setSidebarOpenCookieState(c_sidebar_closed_state)}function showSidebarContentView(){if(chatViewOpened&&conversationSelectedContactId)animateChatView();else animateRecConvView();if(!uiStylesDownloaded)if(!uiStylesLoading){uiStylesLoading=true;_microsoftLive.Core.Loader.load(["messenger.ui.modern","messenger.ui.styles.modern"],uiMessengerStylesLoaded);if(w.wLive["search"]==null)$Network.fetchScript(_webIMConfig.ss,searchsharedDownloaded,"searchshared")}}function searchsharedDownloaded(){}function animateRecConvView(){var a=jQuery("#chat_view");if(!a.is(":hidden"))wLive.Animations.fadeOut(a).then(function(){a.hide();showRecConvView()});else showRecConvView()}function animateChatView(){var a=jQuery("#rec_conv");if(!a.is(":hidden"))wLive.Animations.fadeOut(a).then(function(){a.hide();showChatView()});else showChatView()}function showChatView(){var chatView=jQuery("#chat_view");if(chatView.is(":hidden")){chatView.show();wLive.Animations.fadeIn(chatView).then(function(){var historyControl=jQuery(".ModernConversationHistoryControl").get(0);if(historyControl)historyControl.scrollTop=historyControl.scrollHeight;if($B.IE_M7==1){var value=jQuery("#chat_view_name").attr("onclick");jQuery("#chat_view_name").click(function(){eval(value)})}})}chatViewOpened=true;if(conversationSelectedContactId){resetUnreadMessageCount(conversationSelectedContactId);removeToastFromQueue(conversationSelectedContactId);setSidebarOpenCookieState(conversationSelectedContactId)}}function showRecConvView(){var a=jQuery("#rec_conv");if(a.is(":hidden")){a.show();wLive.Animations.fadeIn(a).then(function(){showOrHideUpsell();checkSpaceLeftForUpsell()})}setSidebarOpenCookieState(c_recview_opened_state)}function hideRecConvView(){jQuery("#rec_conv").css("display","none")}function hideChatView(){jQuery("#chat_view").css("display","none")}function triggerSidebarEvent(a,b){jQuery("#sidebar").trigger(a,b);if($WLXIM.pfmode)window.frames["appFrame"].jQuery("#appFrame_sidebar").trigger(a,b)}function resetConversationSelected(){conversationSelectedContactId=null;if(selectedAggregatedConversation)selectedAggregatedConversation.remove_currentConversationChanged(updatePresenceStatus);if(conversationSelectedContact){var a=conversationSelectedContact.get_presence();if(a)a.remove_propertyChanged(updatePresenceStatus)}}function setSidebarOpenCookieState(b){var a="cid="+$Config.cid+":state="+b;$Cookie.setCookie("Webim_Sidebar_Open",a,$Config.sd,0,null,1)}_this.getSidebarOpenCookieState=function $WLXIM$getSidebarOpenCookieState(){var b=$Cookie.getCookie("Webim_Sidebar_Open");if(b){var a=b.split(":state=");if(a&&a.length==2)if(a[0].endsWith($Config.cid))if(a[1].length>0)return a[1]}return null};function switchToSignedOut(){setSharedPresenceCookie(0);if(user){user.get_settings().set_signInPreference(Microsoft.Live.Messenger.SignInPreference.manualSignIn);user.set_services(_microsoftLiveMessenger.SessionServices.notifications)}}function switchToSignedIn(){if(user){user.get_settings().set_signInPreference(Microsoft.Live.Messenger.SignInPreference.autoSignIn);user.set_services(_microsoftLiveMessenger.SessionServices.full);reportIMStartEvent("Full")}}function innerWindowOnUnload(){try{_innerWindow.$Logout.remove(onLogout);_innerWindow.jQuery(_innerWindow).unbind("unload",innerWindowOnUnload)}catch(a){}_this.innerWindow=_innerWindow=null;informInnerWindowChange()}_this.init=function $WLXIM$init(a){if(_innerWindow)if(a==window)return;else _isDownloadPaused=0;_innerResourcesDownloaded=0;if(_innerWindow)innerWindowOnUnload();_this.innerWindow=_innerWindow=a;_innerWindow.$Logout.add(onLogout);a.$Do.register("$WIMP",wimpComplete);if(_innerWindow==window)_trace=$CSIPerf.startTrace("webIM");informInnerWindowChange();_innerWindow.jQuery(_innerWindow).bind("unload",innerWindowOnUnload);if(_resourcesDownloaded>=_resourcesToDownload)setupInnerWindow();else if(!_startedDownloadingResources)if(_isDownloadPaused)_waitingToDownload=1;else startDownloadingResources();if(_innerWindow!=window)if(_innerWindow.jQuery("#themecss").length>0)moveStylesToOuterWindow();else jQuery(_innerWindow).load(function(){moveStylesToOuterWindow()})};function onLogout(a){if(!_loggingOutOfWindowsLive&&_this.hasPresence()){_loggingOutOfWindowsLive=1;if(a){_logoutEventHandler=a;_logoutEventHandler.pause("wim")}try{user.signOut()}catch(b){}}}function startDownloadingResources(){_startedDownloadingResources=1;_config=_innerWindow.$Config;$Config.email=_config.email;$Config.WebIM=_webIMConfig=_config.WebIM;$Config.sd=_config.sd;getSharedPresenceCookie();informStateChange();moveStylesToOuterWindow();downloadUIFiles();downloadLoader()}_this.pause=function $WLXIM$pause(){if(!_startedDownloadingResources)_isDownloadPaused=1};_this.resume=function $WLXIM$resume(){_isDownloadPaused=0;if(_waitingToDownload)startDownloadingResources()};function setupInnerWindow(){if(_innerWindow!=window&&_innerWindow){_innerResourcesDownloaded=0;_innerWindow.$Network.fetchCSS(_webIMConfig.c,doneLoadingResourceOnInnerWindow);_innerWindow.$Network.fetchScript(_webIMConfig.a,doneLoadingResourceOnInnerWindow,"window.live.shared.globalsettings.webim");_innerWindow.$Network.fetchScript(_webIMConfig.j,doneLoadingResourceOnInnerWindow,"webimui")}}function doneLoadingResourceOnInnerWindow(){_innerResourcesDownloaded++;if(_innerResourcesDownloaded>=_NumOfResourcesToDownload){_innerWindow&&_innerWindow.$Do.register("wlximuiinner");if(_localStoreLoaded&&_innerWindow&&_innerWindow!=window)_innerWindow.$Do.register("wlximlocalstoreready")}}function moveStylesToOuterWindow(){if(_innerWindow==window)return;var f=_innerWindow.document.getElementsByTagName("link"),a=_innerWindow.document.getElementById("themecss");if(a)jQuery("#themecss").remove();var b=0,i=f.length;for(;b<i;b++){var g=f[b],d=g.href;if(d&&g.type=="text/css"){_resourcesToDownload++;h(d)}}function h(a){smartSetTimeout(function(){$Network.fetchCSS(a,uiResourceDownloaded)})}if(a){var c=a.innerHTML;if(c){var e=document.createElement("div"),j=wl.dh;e.innerHTML='&nbsp;<style id="themecss" type="text/css">'+c+"</style>";j.appendChild(e)}}}function uiResourceDownloaded(){_resourcesDownloaded++;if(_resourcesDownloaded==_resourcesToDownload){$Do.register("wlximuiouter",0,true);if(_innerWindow==window)$Do.register("wlximuiinner",0,true);setupInnerWindow();if(jQuery("#sidebar").length==0){createSidebar();_innerWindow.jQuery("#c_hiconm").removeClass("c_md")}}}function downloadUIFiles(){$Network.fetchCSS(_webIMConfig.c,uiResourceDownloaded);$Network.fetchScript(_webIMConfig.a,uiResourceDownloaded,"window.live.shared.globalsettings.webim");$Network.fetchScript(_webIMConfig.j,uiResourceDownloaded,"webimui");if(_webIMConfig.pj)$Network.fetchScript(_webIMConfig.pj,_constNull)}function downloadLoader(){if($B.Mobile==1)_webIMConfig.uf="NonPWCLoader/"+_webIMConfig.uf;$Network.fetchScript(_webIMConfig.u+_webIMConfig.uf,messengerInitLoad,"window.Microsoft.Live.Core.Loader")}function messengerInitLoad(){if(_trace)_trace.lapse.push({s:"loader",t:(new Date).getTime()});if(!window.Microsoft||!Microsoft.Live||!Microsoft.Live.Core||!Microsoft.Live.Core.Loader)setErrorState(90,"Microsoft.Live.Core.Loader Not found");else{_this.ML=_microsoftLive=Microsoft.Live;_microsoftLive.Core.Loader.onError(messengerError);var b="ltr";if($B.rtl==1)b="rtl";var c="release",a={market:$Config.mkt,direction:b,configuration:c,"messenger.loaderPath":_webIMConfig.u};if(document.location.host.toLowerCase().endsWith(".mail"+$Config.sd))a["compatibility.version"]="current";if($B.Mobile&&$B.IE&&$B.V==7)a["messenger.localStorageDisabled"]=true;_microsoftLive.Core.Loader.initialize(a);_microsoftLive.Core.Loader.load("messenger.core",loadCoreComplete);_microsoftLive.Core.Loader.load("core.localstorage",localStorageLoaded)}}function messengerError(a){setErrorState(93,"Messenger Library load error: "+a)}function uiMessengerStylesLoaded(){$Do.when("wlxcontacts",0,initializeUIControls)}function localStorageLoaded(){_localStoreLoaded=1;$Do.register("wlximlocalstoreready");if(_innerWindow&&_innerWindow!=window)_innerWindow.$Do.register("wlximlocalstoreready")}function loadCoreComplete(){if(!_loadCoreComplete){if(_trace)_trace.lapse.push({s:"coreLoaded",t:(new Date).getTime()});_this.MLM=_microsoftLiveMessenger=_microsoftLive.Messenger;if(!_microsoftLiveMessenger||!_microsoftLiveMessenger.WindowsLiveAuthIdentity)setErrorState(90,"Microsoft.Live.Messenger.WindowsLiveAuthIdentity not found");else{_loadCoreComplete=1;messengerAuthentication()}}}function wimpComplete(){if(!_wimpComplete){if(_trace){_trace.addCsd("firstMessengerSignIn",$Cookie.getSessionCookie("WebIM")=="1"?"false":"true");_trace.addCsd("endpoint",window.WIMP?"new":"existing")}_wimpComplete=1;messengerAuthentication()}}function messengerAuthentication(){if(_loadCoreComplete&&_wimpComplete){var a=new _microsoftLiveMessenger.WindowsLiveAuthIdentity(null,null,window.WIMP);if(_config.BSI&&_config.BSI.xid)a.set_experienceId(_config.BSI.xid);a.add_authenticationCompleted(messengerSignIn)}}function messengerSignIn(b,a){if(_trace)_trace.lapse.push({s:"auth",t:(new Date).getTime()});var c=a.get_resultCode();if(c==_microsoftLiveMessenger.AuthenticationResultCode.failure)if(a.get_isUnsupportedBrowser()){_unsupportedBrowser=1;setErrorState(-1,"Authentication Failed: unsuported browser")}else setErrorState(91,"Authentication Failed with status code: "+a.get_status());else{if($B.Mobile)_this.user=user=new _microsoftLiveMessenger.User(b);else _this.user=user=new _microsoftLiveMessenger.User(b,new _microsoftLiveMessenger.Services.PeopleCache);user.get_settings().set_autoReconnectEnabled(true);user.get_settings().set_displayNameMode(Microsoft.Live.Messenger.DisplayNameMode.fullName);user.get_localEndpoint().set_name(_webIMConfig.n);if(user.get_services()!=_microsoftLiveMessenger.SessionServices.normal){setSharedPresenceCookie(user.get_status());_hasReportedIMStart=1}else if(a.get_multipleEndpointsNotSupported()||user.get_settings().get_signInPreference()==Microsoft.Live.Messenger.SignInPreference.manualSignIn){setSharedPresenceCookie(0);switchToSignedOut()}else{setSharedPresenceCookie(1);user.set_services(_microsoftLiveMessenger.SessionServices.full);reportIMStartEvent("Full")}attachStateChangeListeners();user.signIn()}}function reportIMStartEvent(a){if(!_hasReportedIMStart){_hasReportedIMStart=1;$BSI.reportEvent("ClickedSelected.Messaging.IMStart",{IMMode:a})}}function setSharedPresenceCookie(a){$Cookie.setCookie(_constPresenceCookieName,_config.hcid+_constPresenceCookieSeperator+a,_config.sd,0,0,1)}function getSharedPresenceCookie(){var a=$Cookie.getCookie(_constPresenceCookieName,1);if(a){var b=a.indexOf(_constPresenceCookieSeperator);if(b!=-1)if(a.substr(0,b)==_config.hcid){a=parseInt(a.substr(b+1));if(!isNaN(a))return a}}return 1}_this._pres=getSharedPresenceCookie;_this._inform=informStateChange;function attachStateChangeListeners(){user.add_signInCompleted(onSignInCompleted);user.add_signedOut(onSignedOut);user.add_propertyChanged(userPropertyChanged);user.get_contact().get_presence().add_propertyChanged(userPresenceChanged);user.get_networks().add_propertyChanged(networkPropertyChanged);user.get_conversations().add_collectionChanged(collectionChanged);jQuery(w).bind("unload",removeStateChangeListeners);jQuery(w).bind("resize",adjustPaneOnWindowReSize)}function adjustPaneOnWindowReSize(){if(paneToResizeSelector&&paneToResizeSelector.length>0&&_this.isSidebarOpened()&&!_this.isSidebarOverlay()){var a=jQuery(window).width()-c_sidebar_width+"px";try{paneToResizeSelector.width(a)}catch(b){}}}function networkPropertyChanged(){createUpsellIfApplicable()}function collectionChanged(d,c){var a=c.get_newItems();if(a&&a.length>0){var b=a[0];b.add_messageReceived(messageReceived)}checkSpaceLeftForUpsell()}function messageReceived(b,c){if(user.get_contacts()!=null&&user.get_contacts().get_count()>0){var a=getBuddyContact(b);if(a)_this.onConversationUpdated(a,c.get_message())}}function getBuddyContact(c){var b=c.get_roster();for(var a=0;a<b.get_count();a++)if(b.get_item(a)!=c.get_user().get_address())return b.get_item(a).get_contact();return null}function removeStateChangeListeners(){jQuery(w).unbind("unload",removeStateChangeListeners);jQuery(w).bind("resize",adjustPaneOnWindowReSize);user.remove_signInCompleted(onSignInCompleted);user.remove_signedOut(onSignedOut);user.remove_propertyChanged(userPropertyChanged);user.get_networks().remove_propertyChanged(networkPropertyChanged);user.get_contact().get_presence().remove_propertyChanged(userPresenceChanged);var a=user.get_conversations();a.remove_collectionChanged(collectionChanged);for(var b=0;b<a.get_count();b++)a.get_item(b).remove_messageReceived(messageReceived)}function onSignInCompleted(b,c){if(c.get_resultCode()==_microsoftLiveMessenger.SignInResultCode.success){_signInCompletedOccurred=1;if(!_this.isFull())switchToSignedIn();checkSpaceLeftForUpsell();hideSidebarInfo()}if(!_initializedMessengerLibrary)$Cookie.setSessionCookie("WebIM","1");stopInitalizationInstrumentation();informStateChange();$Do.register("$WLXIM.UserSignedIn");if($B.Mobile!=1){var a=_this.getSidebarOpenCookieState();if(a&&a!=c_sidebar_closed_state)if(a!=c_recview_opened_state&&b.get_contacts().findByIdWithoutRoleCheck(a)!=null)$WLXIM.startConversationWithContactId(a);else showSidebar()}}function userPropertyChanged(c,b){var a=b.get_propertyName();if(a=="Services"||a=="Status"){if(!_signInCompletedOccurred&&!_signedInLapseTimerSet&&_trace&&isSignedIn()){_trace.lapse.push({s:"signedIn",t:(new Date).getTime()});_signedInLapseTimerSet=1}if(_signOutWhenYouCan&&user&&user.get_status()==_microsoftLiveMessenger.UserStatus.signedIn){_signOutWhenYouCan=0;switchToSignedOut()}if(!_signInCompletedOccurred&&user&&user.get_status()==_microsoftLiveMessenger.UserStatus.signedIn)_signInCompletedOccurred=1;if(_signInWhenYouCan&&user&&user.get_status()==_microsoftLiveMessenger.UserStatus.signedIn){_signInWhenYouCan=0;switchToSignedIn()}if(user&&user.get_status()!=_microsoftLiveMessenger.UserStatus.signedIn)showSignInView();informStateChange()}}function userPresenceChanged(b){var a=b.get_status();if(a!=_microsoftLiveMessenger.PresenceStatus.offline)setSharedPresenceCookie(a);if(user&&user.get_presence().get_status()==_microsoftLiveMessenger.PresenceStatus.offline){if(user.get_status()==_microsoftLiveMessenger.UserStatus.signedIn)showSignOutView()}else hideSidebarInfo()}function onSignedOut(b,a){if(a.get_reason()==0){setErrorState(-1,"signed out");if(_logoutEventHandler)_logoutEventHandler.resume("wim")}else if(user.get_status()!=_microsoftLiveMessenger.UserStatus.autoReconnectWaiting)setErrorState(94,"signed out: "+a.get_reason());showSignInView()}function stopInitalizationInstrumentation(){if(!_initializedMessengerLibrary){_initializedMessengerLibrary=1;if(_trace){_trace.endTrace();_trace=null}}}function setErrorState(a,b){_encounteredLoadingError=1;informStateChange();stopInitalizationInstrumentation();if(a!=-1)$WebWatson.submitFromException(new Error("Web IM sign in Error"+(b?b:"")),_constNull,a,_constNull,1)}function informStateChange(){var a=0,b=_stateListeners.clone(),c=b.length;for(;a<c;a++)$WebWatson.wrapCallback(b[a])();jQuery(_this).trigger("stateChange");if(_innerWindow&&_innerWindow!=window&&_innerWindow.jQuery)_innerWindow.jQuery(_this).trigger("stateChange")}function informInnerWindowChange(){var a=0,b=_innerWindowListeners.clone(),c=b.length;for(;a<c;a++)$WebWatson.wrapCallback(b[a])();jQuery(_this).trigger("innerWindowChange");if(_innerWindow&&_innerWindow!=window&&_innerWindow.jQuery)_innerWindow.jQuery(_this).trigger("innerWindowChange")}}function dispose(){window.parent.$Do.remove("wlxim",0,outerWindowReady);window.parent.$Do.remove("$WLXIMCS");jQuery(window).unbind("unload",dispose)}function outerWindowReady(){window.$WLXIM=window.parent.$WLXIM;callInitWhenReady();$WLXIM.pfmode=true;if($WLXIM.resetSidebarOverlaySettings!=null)$WLXIM.resetSidebarOverlaySettings();sidebarOverlayMode=false;$WLXIM.sidebar=createElement(c_ElTypeDiv,document.body,"appFrame_sidebar",null);$Do.register("$WLXIM.SidebarCreated");if(window.parent.jQuery("#sidebar").length>0)jQuery("#c_hiconm").removeClass("c_md")}window.webIMPreInit=preInit;function preInit(){if(!$Config.WebIM)return;var a;try{a=window!=window.parent&&window.parent.location.hostname&&window.parent.$Config.WebIM&&window.parent.$Do}catch(c){}if(a){var b=window.parent;b.$Do.when("wlxim",0,outerWindowReady);jQuery(window).bind("unload",dispose);if($Cookie.getCookie("UpsellClicked")=="1"){$Cookie.deleteCookie("UpsellClicked");if(location.href.endsWith("success=true"))window.parent.location.reload()}}else{window.$WLXIM=new WLXIMConstructor;callInitWhenReady()}}onSidebarOpenedCallback=function $WLXIM$onSidebarOpenedEvent(d,b){if(paneToResizeSelector&&paneToResizeSelector.length>0&&!b){if($B.rtl==1&&$B.Firefox==1){var c=c_sidebar_width+paneToResizeSelector.width()-jQuery(window).width();paneToResizeSelector.css("left",c+"px")}var a=jQuery(window).width()-c_sidebar_width+"px";paneToResizeSelector.width(a)}};onSidebarClosedCallback=function $WLXIM$onSidebarClosedEvent(){if(paneToResizeSelector&&paneToResizeSelector.length>0){var a=jQuery(window).width()+"px";paneToResizeSelector.width("auto");if($B.rtl==1&&$B.Firefox==1)paneToResizeSelector.css("left","0px")}};function createSidebar(){if($B.Mobile==1)return;var a=createElement(c_ElTypeDiv,document.body,"sidebar",null);a.setAttribute("persist","1");$WLXIM.sidebar=a;$Do.register("$WLXIM.SidebarCreated");jQuery($WLXIM.sidebar).bind("onSidebarOpenedEvent",onSidebarOpenedCallback);jQuery($WLXIM.sidebar).bind("onSidebarCloseCompletedEvent",onSidebarClosedCallback);$Do.register("wlxim_startconversation",$WLXIM.startConversationWithContact);$Do.when("NotificationControls",0,function(){wLive.Controls.Notifications.getQueue().start()});jQuery(a).css("top",sidebarTop);if(window.$Sutra&&window.$Sutra.WebIM)sutra(a,"$Sutra.WebIM.WebIMSidebar")}function createSidebarContent(){if($B.Mobile==1)return;var b=jQuery("#sidebar").get(0),h="<img id='sidebar_close_img' onmousedown='$WLXIM.toggleSidebar();' class='imCloseImg' src='"+getWebIMImage(c_CloseIcon_resource)+"' />";jQuery(b).append(h);var c=createElement(c_ElTypeDiv,b,"sidebar_info",null),j=getWebIMImage(c_loading_resource),r="<div style='text-align:center'><img src='"+j+"' class='signin_loading_img' /> "+getWebIMString(c_signin)+"</div>";createSidebarInfoContent(c,"signing",r,"");createSidebarInfoContent(c,"reconnect","","<button class='default sidebar_button' type='button' onclick='$WLXIM.reconnect()'>"+getWebIMString(c_reconnectButton)+"</button>");createSidebarInfoContent(c,"signout",getWebIMString(c_signout),"<button class='default sidebar_button' type='button' onclick='$WLXIM.signIn()'>"+getWebIMString(c_signinButton)+"</button>");createSidebarInfoContent(c,"resignin",getWebIMString(c_signout),"<button class='default sidebar_button' type='button' onclick='location.reload()'>"+getWebIMString(c_signinButton)+"</button>");var a=createElement(c_ElTypeDiv,b,"rec_conv",null),q=createElement(c_ElTypeDiv,a,"rec_conv_msg",$Config.WebIM.sbm),k=createElement(c_ElTypeDiv,a,"rec_conv_search","<input type='text' disabled='true' maxlength='50' class='text-input' id='search_filter' value='"+getWebIMString(c_LoadingString)+"' />"),g=createElement(c_ElTypeDiv,a,"rec_conv_search_result",null);$Do.when("$WLXIMCS",0,function(){window.$WLXIMCS.init(k,g,$Config.WebIM.sbcs)});var l=createElement(c_ElTypeDiv,a,"rec_conv_ups",null);createElement(c_ElTypeDiv,l,"wim_ups",null);var p=createElement(c_ElTypeDiv,a,"rec_conv_body",null),d=createElement(c_ElTypeDiv,b,"chat_view",null),f=getWebIMImage(c_BackIcon_resource);if($B.rtl==1)f=getWebIMImage(c_BackIcon_resource_rtl);var m="<img id='chat_back_img' onmousedown='$WLXIM.onChatViewBack();' alt='#' src='"+f+"' />",e=createElement(c_ElTypeDiv,d,"chat_view_header",null);jQuery(e).append(m);var o=createElement(c_ElTypeDiv,e,"chat_view_name",null),i=createElement(c_ElTypeDiv,d,"chat_view_presence",null),n=createElement(c_ElTypeDiv,d,"chat_view_body",null);showSignInView();if(window.$Sutra&&window.$Sutra.WebIM){sutra(b,"$Sutra.WebIM.WebIMSidebar");sutra(_ge("sidebar_close_img"),"$Sutra.WebIM.CloseSidebarButton");sutra(a,"$Sutra.WebIM.RecentConversationsView");sutra(q,"$Sutra.WebIM.RecentConversationsViewHeader");sutra(p,"$Sutra.WebIM.RecentConversationsList");sutra(d,"$Sutra.WebIM.ChatView");sutra(e,"$Sutra.WebIM.ChatViewHeader");sutra(_ge("chat_back_img"),"$Sutra.WebIM.ChatViewBackButton");sutra(o,"$Sutra.WebIM.ChatViewBuddyName");sutra(i,"$Sutra.WebIM.ChatViewBuddyPresence");sutra(n,"$Sutra.WebIM.ChatViewBody")}}function createSidebarInfoContent(a,d,c,b){var e="<table class='sidebar_info_table "+d+"'>"+"<tr style='vertical-align: bottom; height:50%'><td><div class='sidebar_info_top'>"+c+"</div></td></tr>"+"<tr style='vertical-align: top; height:50%'><td><div class='sidebar_info_bottom'>"+b+"</div></td></tr>"+"</table>";jQuery(e).appendTo(a)}function showSignInView(){if($B.Mobile==1)return;var a=jQuery(".sidebar_info");a.find("table").hide();if($WLXIM.isWaitingToReconnect()){var b=a.find("table.reconnect"),c=getWebIMString(c_reconnect)+$WLXIM.getReconnectingTime().min+":"+$WLXIM.getReconnectingTime().sec;b.find(".sidebar_info_top").text(c);b.show();setTimeout(showSignInView,1e3)}else if($WLXIM.isLoading())a.find("table.signing").show();else if($WLXIM.user&&$WLXIM.user.get_status()==Microsoft.Live.Messenger.UserStatus.signedOut)a.find("table.resignin").show();else if($WLXIM.user&&$WLXIM.user.get_presence().get_status()==Microsoft.Live.Messenger.PresenceStatus.offline&&$WLXIM.user.get_status()==Microsoft.Live.Messenger.UserStatus.signedIn)showSignOutView();else{hideSidebarInfo();return}showSidebarInfo()}function showSignOutView(){if($B.Mobile==1)return;var a=jQuery(".sidebar_info");showSidebarInfo();a.find("table").hide();a.find("table.signout").show();if(chat_control){chat_control.dispose();chat_control=null;jQuery("#chat_view_body").empty()}}function hideSidebarInfo(){if($B.Mobile==1)return;var a=jQuery(".sidebar_info");if(a.is(":hidden")){a.hide();return}wLive.Animations.fadeOut(a).then(function(){a.hide()});if(conversationSelectedContactId)$WLXIM.startConversationWithContactId(conversationSelectedContactId)}function showSidebarInfo(){if($B.Mobile==1)return;var a=jQuery(".sidebar_info");if(a.is(":hidden")){a.show();wLive.Animations.fadeIn(a).then(function(){})}}function initializeUIControls(){$Do.when("$WLXIM.UserSignedIn",0,function(){createUIControls();uiStylesDownloaded=true;uiStylesLoading=false})}function createUIControls(){var c=MsgrUI.MessengerApplication.get_current();c.set_channelUrl("Channel.html");var b=document.getElementById("rec_conv_body"),a=new MsgrUI.RecentConversationsControl(b);a.set_manageUrlFormat($Config.WebIM.pm);a.set_connectUrl($Config.WebIM.pc);a.set_user($WLXIM.user);a.add_conversationSelected($WLXIM.onConversationSelected);createChatControl();createUpsellIfApplicable();checkSpaceLeftForUpsell()}function checkSpaceLeftForUpsell(){fixedRecConvElementsHeight=c_fixedRecConvTopHeight+250;if(fixedRecConvElementsHeight+jQuery(".RecentConversationsControl_Items").height()>jQuery(".sidebar").height()){noSpaceForUpsell=true;showOrHideUpsell()}else{var a=$Cookie.getCookie("Webim_Upsell_Close");if(a&&a.endsWith($Config.cid)){noSpaceForUpsell=true;showOrHideUpsell()}else{noSpaceForUpsell=false;showOrHideUpsell()}}}function createUpsellIfApplicable(){if($B.Mobile==1)return;var b=[c_fbSourceId],c=new Array(0),d=$WLXIM.user.get_networks();if(d)for(var a=0;a<b.length;a++){var f=true;for(var e=0;e<d.get_count();e++){var g=d.get_item(e);if(g.get_id()==b[a]&&g.get_tokenState()!="Reject"){f=false;break}}if(f)c.push(b[a])}if(c.length>0){hasUpsell=true;createUpsell(c);showOrHideUpsell()}else{hasUpsell=false;showOrHideUpsell()}}function showOrHideUpsell(){if(hasUpsell&&!noSpaceForUpsell){jQuery("#rec_conv_ups").show();setRecentConversationsControlTop(true);if($B.IE_M7==1&&jQuery("#wim_ups_n").length>0){var value=jQuery("#wim_ups_n").attr("onclick");jQuery("#wim_ups_n").click(function(){eval(value)})}}else{jQuery("#rec_conv_ups").hide();setRecentConversationsControlTop(false)}}function setRecentConversationsControlTop(b){var a=c_fixedRecConvTopHeight;if(b)a=a+jQuery("#rec_conv_ups").height();jQuery(".RecentConversationsControl_Container").css("top",a+"px")}function createUpsell(b){jQuery("#wim_ups").empty();var c=jQuery("#wim_ups").get(0);createElement(c_ElTypeDiv,c,"wim_ups_h",getWebIMString(c_UpsellHeaderString));for(var a=0;a<b.length;a++){var d="<img src='"+getWebIMImage(network_icons[b[a]])+"' class='wim_ups_img' />"+network_names[b[a]]+" "+getWebIMString(c_UpsellFriendsString),e=createElement(c_ElTypeDiv,c,"wim_ups_n",d);e.setAttribute("onclick","$WLXIM.onUpsellClicked()")}var f=createElement(c_ElTypeDiv,c,"wim_ups_c","<a href='#' onmousedown='$WLXIM.onUpsellClose()'>"+getWebIMString(c_UpsellCloseString)+"</a>")}function getWebIMString(a){return window.GetString(c_StringsNamespace+a)}function createChatControl(){var a=jQuery("#chat_view_body");if(chat_control){a.empty();chat_control.dispose()}if(conversationSelectedContactIMAddress){chat_control=new MsgrUI.ModernConversationControl(a[0],null,conversationSelectedContactIMAddress,$WLXIM.user);conversationSelectedContactIMAddress=null}else if(conversationSelectedContactId)chat_control=new MsgrUI.ModernConversationControl(a[0],conversationSelectedContactId,null,null);if(conversationSelectedContactId){updatePresenceStatus();selectedAggregatedConversation=MsgrUI.RecentConversationsControl.get_aggregatedConversations()[conversationSelectedContactId];if(selectedAggregatedConversation)selectedAggregatedConversation.add_currentConversationChanged(updatePresenceStatus);setChatViewName($WLXIM.user.get_contacts().findByIdWithoutRoleCheck(conversationSelectedContactId))}}function getContactDetailsLink(b){var a=$Config.WebIM.cdv;a=a.replace("contact_id=","contact_id="+b.get_id());if($B.IE_M7==1)return "window.location='"+a+"'";else return "$BSI.navigateTo('"+a+"')"}function setChatViewName(a){if(a){jQuery("#chat_view_name").text(a.get_displayName()).attr("onclick",getContactDetailsLink(a));var b=a.get_presence();if(b)b.add_propertyChanged(updatePresenceStatus)}else{jQuery("#chat_view_name").text(getWebIMString(c_UnknownContact));jQuery("#chat_view_presence").text(getWebIMString(c_StatusUnavailable))}}function updatePresenceStatus(){if(chat_control)jQuery("#chat_view_presence").text(chat_control.getContactStatusOnCurrentNetwork())}function getWebIMImage(a){return $Config.WebIM.imgBase+a}function createElement(e,d,b,c){var a=document.createElement(e);if(c)a[c_InnerHTML]=c;if(b){a[c_IdName]=b;a[c_ClassName]=b}if(d)d[c_AppendChild](a);return a}function callInitWhenReady(){var b=$WLXIM;if(!$Config.WebIM.f){if(!$Config.WebIM.u)return;if($Cookie.getSessionCookie("WebIM")=="1"||!$BSI.isLoading())b.init(window);else $BSI.addLoadedCallback(a)}$Do.register("wlxim",0,true);$WLXIM.setPaneToResize(jQuery(".App #BelowHeader"));if(window.jQuery("#c_header").length==0)$WLXIM.setSidebarToFullScreen(true,window);else $WLXIM.setSidebarToFullScreen(false,window);function a(){$BSI.removeLoadedCallback(a);setTimeout(function(){b.init(window)},$Config.WebIM.delay?$Config.WebIM.delay:0)}}preInit()})();(function(){var c=window,f=c.jQuery,b=c.$Preload={},g,o="preload_frame",p=c.$Config,k=p.Preload||{},a,l=0,d=0,i=0;function q(){if($Config.WebIM)$Do.when("wlxim",0,m);else if($BSI.isLoading()){$BSI.addLoadedCallback(e);i=1}else e();f(c).bind("beforeunload",b.dispose)}function m(){g=window["$WLXIM"];f(g).bind("stateChange",h);h();d=1}function j(){f(g).unbind("stateChange",h);d=0}b.dispose=function r(){b.pause();if(d)j();else if(i){$BSI.removeLoadedCallback(e);i=0}f(c).unbind("beforeunload",b.dispose);if(a){try{var g=a.contentWindow;if(g.onunload){g.onunload();g.onunload=null}}catch(h){}a.parentNode.removeChild(a);a=0}};b.resume=function s(){if(a)try{a.contentWindow.$Preload.resume()}catch(b){}};b.pause=function t(){if(a)try{a.contentWindow.$Preload.pause()}catch(b){}};function h(){if(g.hasContacts())e()}function e(){var a=k.DelayMs||0;setTimeout(n,a);if(d)j()}function n(){if(!l){var b=k.View;l=1;if(b){a=document.createElement("iframe");a.id=o;a.width=a.height=0;a.style.display="none";a.src="/handlers/resourcespreload.mvc?bicild=&view="+b;document.body.appendChild(a)}}}q()})();(function(){window.$CSIPerf.lapse.push({s:"sjs",t:(new Date).getTime()})})();(function(){var a=window,e=a.$baseMaster={},k,h=$Config,t=jQuery("html"),c=jQuery("#m_wh"),i=jQuery("#c_cb0"),d=jQuery("#c_base"),b,f,j,m="fh",o=["A","INPUT","LABEL","BUTTON","TEXTAREA"],r=20;function u(){$Do.when("$PF.attach",0,e.dispose);if(h.fs)$BSI.addLoadedCallback(s);$Do.when("$WLXIM.SidebarCreated",0,function(){if(jQuery(".c_base").length>0&&$WLXIM)$WLXIM.setPaneToResize(jQuery(".c_base"))});if(t.hasClass(m)){b=c.height();d.css({top:b+"px"});if($B.IE_M7){d.height($f.docHeight()-b);jQuery(a).bind("resize",p)}}jQuery(document).bind("mousedown",l);if($f.getDocType().indexOf("Strict")>0)jQuery(document.body).addClass("strict")}function p(){clearTimeout(j);j=setTimeout(n,r)}function n(){d.height($f.docHeight()-b)}function l(b){var a=b.target;if(f)g(b,f);while(a){if(o.contains(a.tagName)){f=a;$css.addHideBorder(b,a);if(a.tagName=="A")$css.addPressedState(b,a);jQuery(a).bind("blur",g);break}a=a.parentNode}}function g(b,a){a=a||this;$css.removeHideBorder(b,a);$css.removePressedState(b,a);jQuery(a).unbind("blur",g);f=null}e.getHeaderHeight=function(){return b};e.toggleFixedHeader=function v(a){c.show();if(a){if($B.IE&&$B.V<=8)c.show();c.css({top:"0"});i.removeClass("c_h_hidden");d.css({top:b+"px"});$WLXIM&&$WLXIM.setSidebarToFullScreen(false)}else{if($B.IE&&$B.V<=8)c.hide();d.css({top:"0"});c.css({top:"-"+b+"px"});i.addClass("c_h_hidden");$WLXIM&&$WLXIM.setSidebarToFullScreen(true)}};function s(){$Network.fetchCSS(h.fs,q)}function q(){var a=new Date;a.setDate((new Date).getDate()+1);$Cookie.setCookie("wlfonts","1",h.sd,"/",a)}e.dispose=function w(){if(!k){var e=a["$Static"],c=a["$Preload"],g=a["$WLXIM"],d=a["$WLXIMCL"],f=a["$footer"],b=a["$HeaderWebIM"];if(e)e.pause(1);if(c)c.dispose();if(g)g.pause();if(d)d.dispose();if(f)f.dispose();if(b)b.dispose();jQuery(document.body).parent().removeClass("fh");k=1}};u()})();(function(){var h=window,b=h.jQuery,d="Merge",f="PreMerge",a=h.$PF,c,g,j,e=0,i=0,k,o=2e3;if(!a||!a.f)return;if(!a.i){$Do.when("$History.attachPF",0,m,true);if(a.m)b("form").submit(function(){var c=b(this);if(!c.attr("target")){c.attr("target",a.fid);$Do.when("$PF.merge")}return true})}function m(f){try{var g=_ge(a.fid).contentWindow.document.domain}catch(h){return}var b="",c=f.pfState;if(!c)b=a.afu;else if(c.indexOf("#")==0)b=[a.afu,c].join("");else b=c;var d=a.getNormalizedUrl(b,null);setTimeout(function(){a.navigateTo(d)},1);var e;if(d!=b)e=a.getRelativeUrl(d);return e}a.preMerge=function w(c){if(a.merged){a.navigateTo(c);return}if(e>0){k=c;b(a).trigger(f)}else a.mergeAndNavigate(c)};a.allowMerge=function v(){i++;if(i>=e)a.mergeAndNavigate(k)};a.merge=function x(){if(a.merged)return;a.merged=true;b(a).trigger(d);b(a).unbind(d);b(a).unbind(f);b("body").css("cssText",a.hbs);b("html").css("cssText",a.hhs);b("#"+a.did).show().add("[persist]").parentsUntil("body").andSelf().attr("persist",1).siblings().filter(":not([persist])").hide()};function n(c){if(!a.i){b(a).bind(f,c);e++}}function q(c){if(!a.i)b(a).bind(d,c)}function r(c){if(!a.i)b(a).unbind(d,c)}a.showLoading=function u(){if(a.lid)j=setTimeout(p,o)};function p(){if(!c){c=b("#"+a.lid);c.html('<div style="top:45%;width:100%;position:absolute;text-align:center">'+$f.createLoading(1,0,"60px")+"</div>");g=c.find(".c_loadingDots")}c.show();$f.showLoading(g);b("#"+a.did).hide()}a.hideLoading=function t(){if(a.lid){clearTimeout(j);b("#"+a.did).show();if(c){c.hide();$f.hideLoading(g)}}};a.updateFavicon=function s(d,e){var b=l(d),a=l(h);if(b&&a){var c=a.cloneNode(true);c.href=b.getAttribute("href");e.document.head.appendChild(c);a.parentNode.removeChild(a)}};function l(c){var a=c.document.getElementsByTagName("link");if(a)for(var b=0;b<a.length;b++)if(a[b].getAttribute("rel").indexOf("icon")>-1)return a[b]}$Do.register("$PF");$Do.register("$PF.merge",a.merge);$Do.register("$PF.attach",q);$Do.register("$PF.detach",r);$Do.register("$PF.attachPreMerge",n)})();(function(){var w=window,jQuery=w.jQuery,$Network=w.$Network,$Config=w.$Config,$Logout=w.$Logout,$Cookie=w.$Cookie,wLive=w.wLive,$WebWatson=w.$WebWatson,$ScenarioQoS=w.$ScenarioQoS,$ScenarioQoSStats=wLive.ScenarioQoSStats;wLive.Contacts={};var c_schemaVersion="W5.M2",spId=0,spContacts=1,spFirstName=2,spLastName=3,spEmails=4,spPhones=5,spCid=6,spHexCid=7,spOnHideList=8,spTrustLevel=9,spCompanyName=10,spUserTileMedium=11,spCategoryIds=12,spIsFavorite=13,spFavoriteOrder=14,spPassportMemberName=15,spBirthday=16,spNickName=17,spMiddleName=18,spTitle=19,spSuffix=20,spYomiFirstName=21,spYomiLastName=22,spYomiCompanyName=23,spAddresses=24,spSignificantOther=25,spAnniversary=26,spWebsite=27,spJobTitle=28,spNotes=29,spOrderedName=30,spNameType=31,spFieldsCount=32,scId=0,scContactState=1,scPromotionBitmap=2,scProperties=3,scSourceId=4,scObjectId=5,scDomainTag=6,scFirstName=7,scLastName=8,scEmails=9,scPhones=10,scCompanyName=11,scUserTileMedium=12,scEmailImEnabled=13,scEmailCapability=14,scPhoneImEnabled=15,scFavoriteOrder=16,scBirthday=17,scMiddleName=18,scNickName=19,scTitle=20,scSuffix=21,scYomiFirstName=22,scYomiLastName=23,scYomiCompanyName=24,scAddresses=25,scSignificantOther=26,scAnniversary=27,scWebsite=28,scJobTitle=29,scNotes=30,scOrderedName=31,scNameType=32,scpMri=0,scpIsHidden=1,scpOfflineImEnabled=2,sePersonal=0,seWork=1,seOther=2,spMobile=0,spHome=1,spHome2=2,spWork=3,spWork2=4,spPager=5,spHomeFax=6,spWorkFax=7,spMobile2=8,spCompanyPhone=9,spOther=10,saHome=0,saWork=1,saOther=2,c_emptyArray=[];wLive.Contacts.ContactState={deleted:-1,shell:0,meContact:1,pending:2,follower:3,twoWay:4,rolodex:5,nonFriend:6,declined:7,implicitContact:8,shellContactFanPage:9,enhancedShellContact:10,implicitShellContact:11,invitationShellContact:12};var sContactState=wLive.Contacts.ContactState;wLive.Contacts.WLXContactsSchema={schemaVersion:c_schemaVersion,peopleResponse:{abCore:0,error:1},abCore:{syncKey:0,lastModifiedDateTime:1,schemaVersion:2,persons:3,categories:4,groups:5,settings:6,services:7,isFullSync:8},profilesResponse:{schemaVersion:0,profiles:1,hasErrors:2},person:{id:0,contacts:1,firstName:2,lastName:3,emails:4,phones:5,cid:6,hexCid:7,onHideList:8,trustLevel:9,companyName:10,userTileMedium:11,categoryIds:12,isFavorite:13,favoriteOrder:14,passportMemberName:15,birthday:16,nickName:17,middleName:18,title:19,suffix:20,yomiFirstName:21,yomiLastName:22,yomiCompanyName:23,addresses:24,significantOther:25,anniversary:26,website:27,jobTitle:28,notes:29,orderedName:30,nameType:31},contact:{id:0,contactState:1,promotionBitmap:2,properties:3,sourceId:4,objectId:5,domainTag:6,firstName:7,lastName:8,emails:9,phones:10,companyName:11,userTileMedium:12,emailImEnabled:13,emailCapability:14,phoneImEnabled:15,favoriteOrder:16,birthday:17,middleName:18,nickName:19,title:20,suffix:21,yomiFirstName:22,yomiLastName:23,yomiCompanyName:24,addresses:25,significantOther:26,anniversary:27,website:28,jobTitle:29,notes:30,orderedName:31,nameType:32},contactProperties:{mri:0,isHidden:1,offlineImEnabled:2},addresses:{home:0,work:1,other:2},address:{street:0,city:1,state:2,zipCode:3,country:4},email:{personal:0,work:1,other:2},phone:{mobile:0,home:1,home2:2,work:3,work2:4,pager:5,homeFax:6,workFax:7,mobile2:8,company:9,other:10},group:{id:0,name:1,cid:2,hexCid:3,email:4,isDeleted:5},category:{id:0,name:1,isFavorite:2,isDeleted:3},settings:{messengerTrustLevel:0,imHistory:1,abSettings:2},service:{id:0,name:1,tokenState:2,supportsIm:3,supportsContactArgg:4,iconUrlThumbnail:5,iconUrlMiniPhoto:6,iconUrlLargePhoto:7,profileUrl:8,photosUrl:9,sendMessageUrl:10,reportAbuseUrl:11,rank:12,onHideList:13,isDeleted:20},date:{year:0,month:1,day:2}};var s=wLive.Contacts.WLXContactsSchema,sPeopleResponse=s.peopleResponse,sAbCore=s.abCore,sError=sPeopleResponse.error,sData=sPeopleResponse.abCore,sCategory=s.category,sService=s.service,sGroup=s.group;wLive.Contacts.DF=DF;function DF(g,c,b,f,d,e){var a=this;a.mask=g;a.personFields=c;a.contactFields=b;a.isArray=f;a.arrayIndex=d;a.comparer=e}var c_idMask=1,c_userTileMask=1<<2,c_nameMask=1<<3,c_companyNameMask=1<<4,c_personalEmailMask=1<<5,c_workEmailMask=1<<6,c_otherEmailMask=1<<7,c_mobilePhoneMask=1<<8,c_homePhoneMask=1<<9,c_home2PhoneMask=1<<10,c_workPhoneMask=1<<11,c_work2PhoneMask=1<<12,c_pagerMask=1<<13,c_homeFaxMask=1<<14,c_workFaxMask=1<<15,c_homeAddressMask=1<<16,c_workAddressMask=1<<17,c_otherAddressMask=1<<18,c_birthdayMask=1<<19,c_significantOtherMask=1<<20,c_websiteMask=1<<21,c_notesMask=1<<22,c_mobile2PhoneMask=1<<23,c_companyPhoneMask=1<<24,c_otherPhoneMask=1<<25,c_dedupeMap=[new DF(c_idMask,[spId],[scId]),new DF(c_userTileMask,[spUserTileMedium],[scUserTileMedium]),new DF(c_nameMask,[spFirstName,spLastName,spTitle,spSuffix,spNickName,spMiddleName,spYomiFirstName,spYomiLastName,spOrderedName,spNameType],[scFirstName,scLastName,scTitle,scSuffix,scNickName,scMiddleName,scYomiFirstName,scYomiLastName,scOrderedName,scNameType]),new DF(c_companyNameMask,[spCompanyName,spYomiCompanyName,spJobTitle],[scCompanyName,scYomiCompanyName,scJobTitle]),new DF(c_personalEmailMask,[spEmails],[scEmails],1,sePersonal),new DF(c_workEmailMask,[spEmails],[scEmails],1,seWork),new DF(c_otherEmailMask,[spEmails],[scEmails],1,seOther),new DF(c_mobilePhoneMask,[spPhones],[scPhones],1,spMobile),new DF(c_mobile2PhoneMask,[spPhones],[scPhones],1,spMobile2),new DF(c_homePhoneMask,[spPhones],[scPhones],1,spHome),new DF(c_home2PhoneMask,[spPhones],[scPhones],1,spHome2),new DF(c_workPhoneMask,[spPhones],[scPhones],1,spWork),new DF(c_work2PhoneMask,[spPhones],[scPhones],1,spWork2),new DF(c_homeFaxMask,[spPhones],[scPhones],1,spHomeFax),new DF(c_pagerMask,[spPhones],[scPhones],1,spPager),new DF(c_workFaxMask,[spPhones],[scPhones],1,spWorkFax),new DF(c_companyPhoneMask,[spPhones],[scPhones],1,spCompanyPhone),new DF(c_otherPhoneMask,[spPhones],[scPhones],1,spOther),new DF(c_homeAddressMask,[spAddresses],[scAddresses],1,saHome,compareArrays),new DF(c_workAddressMask,[spAddresses],[scAddresses],1,saWork,compareArrays),new DF(c_otherAddressMask,[spAddresses],[scAddresses],1,saOther,compareArrays),new DF(c_significantOtherMask,[spSignificantOther,spAnniversary],[scSignificantOther,scAnniversary]),new DF(c_websiteMask,[spWebsite],[scWebsite]),new DF(c_notesMask,[spNotes],[scNotes]),new DF(c_birthdayMask,[spBirthday],[scBirthday],0,0,compareArrays)],c_dedupableFieldsHash=[];(function(){for(var c=0,d=c_dedupeMap.length;c<d;c++){var b=c_dedupeMap[c].personFields;for(var a=0,e=b.length;a<e;a++)if(!c_dedupableFieldsHash[b[a]])c_dedupableFieldsHash[b[a]]=1}})();wLive.Contacts.PersonHelper=PersonHelper;function PersonHelper(c){var b=this,a=c;b.setPerson=function(b){a=b};b.getCurrent=function(){return a};b.getId=function(){return a[spId]};b.setId=function(b){a[spId]=b};b.getContacts=function(){return a[spContacts]};b.setContacts=function(b){a[spContacts]=b};b.getNickName=function(){return a[spNickName]};b.getFirstName=function(){return a[spFirstName]};b.getMiddleName=function(){return a[spMiddleName]};b.getLastName=function(){return a[spLastName]};b.getTitle=function(){return a[spTitle]};b.getSuffix=function(){return a[spSuffix]};b.getYomiFirstName=function(){return a[spYomiFirstName]};b.getYomiLastName=function(){return a[spYomiLastName]};b.getOrderedName=function(){return a[spOrderedName]};b.getNameType=function(){return a[spNameType]};b.getCompanyName=function(){return a[spCompanyName]};b.getYomiCompanyName=function(){return a[spYomiCompanyName]};b.getPersonalEmail=function(){return a[spEmails][sePersonal]};b.getWorkEmail=function(){return a[spEmails][seWork]};b.getOtherEmail=function(){return a[spEmails][seOther]};b.getPassportMemberName=function(){return a[spPassportMemberName]};b.setPassportMemberName=function(b){a[spPassportMemberName]=b};b.getMobilePhone=function(){return a[spPhones][spMobile]};b.getMobile2Phone=function(){return a[spPhones][spMobile2]};b.getHomePhone=function(){return a[spPhones][spHome]};b.getHome2Phone=function(){return a[spPhones][spHome2]};b.getWorkPhone=function(){return a[spPhones][spWork]};b.getWork2Phone=function(){return a[spPhones][spWork2]};b.getPager=function(){return a[spPhones][spPager]};b.getHomeFax=function(){return a[spPhones][spHomeFax]};b.getWorkFax=function(){return a[spPhones][spWorkFax]};b.getCompanyPhone=function(){return a[spPhones][spCompanyPhone]};b.getOtherPhone=function(){return a[spPhones][spOther]};b.getCid=function(){return a[spCid]};b.setCid=function(b){a[spCid]=b};b.getHexCid=function(){return a[spHexCid]};b.setHexCid=function(b){a[spHexCid]=b};b.getOnHideList=function(){return a[spOnHideList]};b.setOnHideList=function(b){a[spOnHideList]=b};b.getTrustLevel=function(){return a[spTrustLevel]};b.setTrustLevel=function(b){a[spTrustLevel]=b};b.getUserTileMedium=function(){return a[spUserTileMedium]};b.getIsFavorite=function(){return a[spIsFavorite]};b.setIsFavorite=function(b){a[spIsFavorite]=b};b.getFavoriteOrder=function(){return a[spFavoriteOrder]};b.setFavoriteOrder=function(b){a[spFavoriteOrder]=b};b.getCategoryIds=function(){return a[spCategoryIds]};b.setCategoryIds=function(b){a[spCategoryIds]=b}}wLive.Contacts.ContactHelper=ContactHelper;function ContactHelper(e,f){var a=this,b,c,d;if(e&&typeof f!==c_undefined){c=e;b=e[spContacts][f];d=b[scPromotionBitmap]}a.setContact=function(a,f,e){c=a;b=e||a[spContacts][f];if(b){d=b[scPromotionBitmap];return true}return false};a.getCurrent=function(){return b};a.getId=function(){return d&c_idMask?c[spId]:b[scId]};a.getFirstName=function(){return d&c_nameMask?c[spFirstName]:b[scFirstName]};a.getMiddleName=function(){return d&c_nameMask?c[spMiddleName]:b[scMiddleName]};a.getLastName=function(){return d&c_nameMask?c[spLastName]:b[scLastName]};a.getTitle=function(){return d&c_nameMask?c[spTitle]:b[scTitle]};a.getSuffix=function(){return d&c_nameMask?c[spSuffix]:b[scSuffix]};a.getYomiFirstName=function(){return d&c_nameMask?c[spYomiFirstName]:b[scYomiFirstName]};a.getYomiLastName=function(){return d&c_nameMask?c[spYomiLastName]:b[scYomiLastName]};a.getOrderedName=function(){return d&c_nameMask?c[spOrderedName]:b[scOrderedName]};a.getNameType=function(){return d&c_nameMask?c[spNameType]:b[scNameType]};a.getCompanyName=function(){return d&c_companyNameMask?c[spCompanyName]:b[scCompanyName]};a.getYomiCompanyName=function(){return d&c_nameMask?c[spYomiCompanyName]:b[scYomiCompanyName]};a.getJobTitle=function(){return d&c_companyNameMask?c[spJobTitle]:b[scJobTitle]};a.getPersonalEmail=function(){return d&c_personalEmailMask?c[spEmails][sePersonal]:(b[scEmails]||c_emptyArray)[sePersonal]};a.getPersonalEmailImEnabled=function(){return b[scEmailImEnabled][sePersonal]};a.getWorkEmail=function(){return d&c_workEmailMask?c[spEmails][seWork]:(b[scEmails]||c_emptyArray)[seWork]};a.getWorkEmailImEnabled=function(){return (b[scEmailImEnabled]||c_emptyArray)[seWork]};a.getOtherEmail=function(){return d&c_otherEmailMask?c[spEmails][seOther]:(b[scEmails]||c_emptyArray)[seOther]};a.getOtherEmailImEnabled=function(){return (b[scEmailImEnabled]||c_emptyArray)[seOther]};a.getPassportMemberName=function(){return b[scSourceId]==="WL"?c[spPassportMemberName]:null};a.getMobilePhone=function(){return d&c_mobilePhoneMask?c[spPhones][spMobile]:(b[scPhones]||c_emptyArray)[spMobile]};a.getMobilePhoneImEnabled=function(){return (b[scPhoneImEnabled]||c_emptyArray)[spMobile]};a.getMobile2Phone=function(){return d&c_mobile2PhoneMask?c[spPhones][spMobile2]:(b[scPhones]||c_emptyArray)[spMobile2]};a.getMobile2PhoneImEnabled=function(){return (b[scPhoneImEnabled]||c_emptyArray)[spMobile2]};a.getHomePhone=function(){return d&c_homePhoneMask?c[spPhones][spHome]:(b[scPhones]||c_emptyArray)[spHome]};a.getHomePhoneImEnabled=function(){return (b[scPhoneImEnabled]||c_emptyArray)[spHome]};a.getHome2Phone=function(){return d&c_home2PhoneMask?c[spPhones][spHome2]:(b[scPhones]||c_emptyArray)[spHome2]};a.getHome2PhoneImEnabled=function(){return (b[scPhoneImEnabled]||c_emptyArray)[spHome2]};a.getWorkPhone=function(){return d&c_workPhoneMask?c[spPhones][spWork]:(b[scPhones]||c_emptyArray)[spWork]};a.getWorkPhoneImEnabled=function(){return (b[scPhoneImEnabled]||c_emptyArray)[spWork]};a.getWork2Phone=function(){return d&c_work2PhoneMask?c[spPhones][spWork2]:(b[scPhones]||c_emptyArray)[spWork2]};a.getWork2PhoneImEnabled=function(){return (b[scPhoneImEnabled]||c_emptyArray)[spWork2]};a.getPager=function(){return d&c_pagerMask?c[spPhones][spPager]:(b[scPhones]||c_emptyArray)[spPager]};a.getPagerImEnabled=function(){return (b[scPhoneImEnabled]||c_emptyArray)[spPager]};a.getHomeFax=function(){return d&c_homeFaxMask?c[spPhones][spHomeFax]:(b[scPhones]||c_emptyArray)[spHomeFax]};a.getHomeFaxImEnabled=function(){return (b[scPhoneImEnabled]||c_emptyArray)[spWorkFax]};a.getWorkFax=function(){return d&c_workFaxMask?c[spPhones][spWorkFax]:(b[scPhones]||c_emptyArray)[spWorkFax]};a.getWorkFaxImEnabled=function(){return (b[scPhoneImEnabled]||c_emptyArray)[spWorkFax]};a.getCompanyPhone=function(){return d&c_companyPhoneMask?c[spPhones][spCompanyPhone]:(b[scPhones]||c_emptyArray)[spCompanyPhone]};a.getCompanyPhoneImEnabled=function(){return (b[scPhoneImEnabled]||c_emptyArray)[spCompanyPhone]};a.getOtherPhone=function(){return d&c_otherPhoneMask?c[spPhones][spOther]:(b[scPhones]||c_emptyArray)[spOther]};a.getOtherPhoneImEnabled=function(){return (b[scPhoneImEnabled]||c_emptyArray)[spOther]};a.getContactState=function(){return b[scContactState]};a.getPromotionBitmap=function(){return b[scPromotionBitmap]};a.getSourceId=function(){return b[scSourceId]};a.getObjectId=function(){return b[scObjectId]};a.getProperties=function(){return b[scProperties]||[]};a.getMri=function(){return a.getProperties()[scpMri]};a.getIsHidden=function(){return a.getProperties()[scpIsHidden]};a.getOfflineImEnabled=function(){return a.getProperties()[scpOfflineImEnabled]};a.getDomainTag=function(){return b[scDomainTag]};a.getUserTileMedium=function(){return d&c_userTileMask?c[spUserTileMedium]:b[scUserTileMedium]};a.getFavoriteOrder=function(){return b[scFavoriteOrder]};a.getBirthday=function(){return d&c_birthdayMask?c[spBirthday]:b[scBirthday]};a.getNickName=function(){return d&c_nameMask?c[spNickName]:b[scNickName]};a.getAddresses=function(){return b[scAddresses]};a.getSignificantOther=function(){return d&c_significantOtherMask?c[spSignificantOther]:b[scSignificantOther]};a.getAnniversary=function(){return d&c_significantOtherMask?c[spAnniversary]:b[scAnniversary]};a.getWebsite=function(){return d&c_websiteMask?c[spWebsite]:b[scWebsite]};a.getNotes=function(){return d&c_notesMask?c[spNotes]:b[scNotes]};a.getHomeAddress=function(){return d&c_homeAddressMask?c[spAddresses][saHome]:(b[scAddresses]||c_emptyArray)[saHome]};a.getWorkAddress=function(){return d&c_workAddressMask?c[spAddresses][saWork]:(b[scAddresses]||c_emptyArray)[saWork]};a.getOtherAddress=function(){return d&c_otherAddressMask?c[spAddresses][saOther]:(b[scAddresses]||c_emptyArray)[saOther]};a.getFullName=function(){return w.$WLXContacts.getFullName(c)};a.getYomiName=function(){return w.$WLXContacts.formatName(a.getNameType(),"displayName",null,a.getYomiFirstName(),null,a.getYomiLastName(),null,null)}}var c_globalVariableName="$WLXContacts",c_wlxcontacts="wlxcontacts",c_readyEvent="ready",c_failureEvent="failure",c_fullSyncEvent="fullSync",c_rpsCoookieExpired="rpsCookieExpired",c_changedEvent="changed",c_unload="unload",c_undefined="undefined",c_cookieName="wpc",c_deltaSyncCookieName="wpd",c_cachedProfilesLimit=30,c_wlContactPromotedProps=[spCid,spHexCid,spTrustLevel,spOnHideList,spPassportMemberName],c_inProgress="inProgress",c_attempts="attempts",c_beginCallbacks="beginCallbacks",c_successCallbacks="successCallbacks",c_failureCallbacks="failureCallbacks",c_requestType="requestType",c_startTime="startTime",c_qosScenario="qosScenario",c_startIndexKeySuffix="_s",c_endIndexKeySuffix="_e",c_fullSyncRequest="full",c_deltaSyncRequest="delta",c_expireProfilesDataAfter=1.8e6,c_maxRetry=3,c_errorInvalidPassportUser="InvalidPassportUser",c_WL_People_Cache="WL_People_Cache",c_Abch="Abch",c_WL_People_Cache_Init_ScenarioId=c_WL_People_Cache+"_Init",c_WL_People_Cache_FullSync_ScenarioId=c_WL_People_Cache+"_FullSync",c_WL_People_Cache_DeltaSync_ScenarioId=c_WL_People_Cache+"_DeltaSync",c_WL_People_Cache_GetProfiles_ScenarioId=c_WL_People_Cache+"_GetProfiles",c_WL_People_Cache_LoadXmlProxy_ApiId=c_WL_People_Cache+"_LoadXmlProxy",c_WL_People_Cache_InitMWTStorage_ApiId=c_WL_People_Cache+"_InitMWTStorage",c_WL_People_Cache_RestoreAB_ApiId=c_WL_People_Cache+"_RestoreAB",c_WL_People_Cache_PersistAB_ApiId=c_WL_People_Cache+"_PersistAB",WL_People_Cache_Rest_GetProfiles=c_WL_People_Cache+"_Rest_GetProfiles",c_Abch_ABService_UnifiedPeopleAPI=c_Abch+"_ABService_UnifiedPeopleAPI",c_Abch_ABService_UnifiedPeopleAPIABCoreFullSync=c_Abch_ABService_UnifiedPeopleAPI+"ABCoreFullSync",c_Abch_ABService_UnifiedPeopleAPIABCoreDeltaSync=c_Abch_ABService_UnifiedPeopleAPI+"ABCoreDeltaSync",c_Abch_ABService_UnifiedPeopleAPIPersonDetails=c_Abch_ABService_UnifiedPeopleAPI+"PersonDetails",c_sortNameFmt="F| |L",c_sortNameReverseFmt="L| |F",c_nameFormats={"0":{fn:"T| |F| |M| |L| |S",dn:"T| |F| |L| |S",sn:c_sortNameFmt,snr:c_sortNameReverseFmt,lnf:false},"1":{fn:"F| |L| |M| |T| |S",dn:"F| |L| |T| |S",sn:c_sortNameFmt,snr:c_sortNameReverseFmt,lnf:false},"2":{fn:"F| |L| |M| |T| |S",dn:"F| |L| |T| |S",sn:c_sortNameFmt,snr:c_sortNameReverseFmt,lnf:false},"3":{fn:"F| |M| |L| |T| |S",dn:"F| |L| |T| |S",sn:c_sortNameFmt,snr:c_sortNameReverseFmt,lnf:false},"4":{fn:"F| |M| |L| |T| |S",dn:"F| |L| |T| |S",sn:c_sortNameFmt,snr:c_sortNameReverseFmt,lnf:false},"5":{fn:"L| |F| |M| |T| |S",dn:"L| |F| |T| |S",sn:"L| |F",lnf:true},"6":{fn:"T| |F| |M| |L| |S",dn:"T| |F| |L| |S",sn:c_sortNameFmt,snr:c_sortNameReverseFmt,lnf:false},"7":{fn:"T| |F| |L| |M| |S",dn:"T| |F| |L| |S",sn:c_sortNameFmt,snr:c_sortNameReverseFmt,lnf:false},"8":{fn:"T| |L||F| |M| |S",dn:"T| |L||F| |S",sn:"L||F",lnf:true},"9":{fn:"T| |L| |F| |M| |S",dn:"T| |L| |F| |S",sn:"L| |F",lnf:true},"10":{fn:"T| |L| |F| |M| |S",dn:"T| |L| |F| |S",sn:"L| |F",lnf:true},"11":{fn:"T| |L| |M| |F| |S",dn:"T| |L| |F| |S",sn:"L| |F",lnf:true}},c_nameFormatArgumentsMapping={T:"title",F:"firstName",M:"middleName",L:"lastName",S:"suffix"};(function(){var d=[];function b(b){var a=d[b];if(!a){a=createNameFormatFunction(b);d[b]=a}return a}for(var c=0;c<=11;c++){var a=c_nameFormats[c+""];a.fullName=b(a.fn);a.fullNameReverse=!a.lnf?formatNameReverse:a.fullName;a.displayName=b(a.dn);a.displayNameReverse=!a.lnf?formatDisplayNameReverse:a.displayName;a.sortName=b(a.sn);a.sortNameReverse=a.snr?b(a.snr):a.sortName}})();wLive.Contacts.WLXContactsCore=WLXContactsCore;function WLXContactsCore(f,Kb){var a=this;a.isReady=false;a.isFailed=false;a.persons=[];a.groups=[];a.categories=[];a.services=[];a.profiles=[];a.settings=[];a.$persons=jQuery({});a.$groups=jQuery({});a.$categories=jQuery({});a.$services=jQuery({});a.$self=jQuery(a);a.syncKey="";a.lastModified=null;a.lastFullSync=null;a.lastDeltaSync=null;f=f||"";var S="fullSyncResponse"+f,cb="mkt"+f,M="abCid"+f,Z="profilesCid"+f,E="profilesTimestamp"+f,H="lastFullSync"+f,F="lastDeltaSync"+f,o="deltaSyncRequired"+f,z="profilesResponse"+f,D="deltaSyncResponse"+f,R="preferredHostName"+f,I,c=null,r=null,d=null,h,g,ab=null,Y=null,p,u=[],t=[],tb=0,K=new LazyHash(a.persons,[spId,spCid,spHexCid,[spContacts,scId]]),l=new LazyHash([],[spId,[spContacts,scId]]),L=new LazyHash(a.groups,[0]),v=new LazyHash(a.categories,[0]),J=new LazyHash(a.services,[0]),x=new LazyHash(a.profiles,[spCid,spHexCid]),i=[],j=[],A,rb,b,k,Gb,ub=new ContactHelper,vb=new PersonHelper,V,W,m=new ContactHelper,n=new PersonHelper,X,Q,e;function nb(){if(!e)e=startQoSScenario(c_WL_People_Cache_Init_ScenarioId,c_WL_People_Cache)}a.init=function(b){if(A){sb(b);return}if(I&&b==w)return;I=b;A=1;jQuery(w).bind(c_unload,a.dispose);bb()};function sb(a){if(wb()){if(V)clearTimeout(V);if(A===2&&a.$Config){var d=T(a.$Config,"enabled",0);if(d&&d!=b.enabled){b.enabled=1;c.registerReadyCallback(mb)}}else if(A===1&&b.fullyDisabled&&T(a.$Config,"enabled",0)){I=a;bb()}else{if(T(a.$Config,"fullyDisabled",0))return;V=setTimeout(function(){sb(a)},200)}}}function T(a,c,b){if(a&&a.ContactCache)return a.ContactCache[c];else return b}function bb(){k=Kb||I.$Config;Q&&clearTimeout(Q);if(k){b=k.ContactCache;if(!b||b.fullyDisabled)return;nb();if($Logout)$Logout.add(yb);Gb=$Cookie.getSessionCookie(c_cookieName)==="1";var f=false,a=false;try{f=!isNullOrUndefined(w["localStorage"])}catch(i){a=true}if(f||a){if(!a&&!b.inMemoryStorage&&!h&&!g){W=new CrossDomainProxy(b.peopleApiBaseUrl,e);h=h||new DOMLocalStorageWrapper(W,true);g=g||new DOMLocalStorageWrapper(W,false)}d=new LocalStorageProxy(g,eb);r=c=new LocalStorageProxy(b.localStorage?h:g)}else{if(!b.inMemoryStorage&&!h&&!g){h=h||new MWTLocalStorageWrapper(e);g=g||h}d=new LocalStorageProxy(g,eb);c=new LocalStorageProxy(h);r=new LocalStorageProxy;rb=true}c.registerReadyCallback(mb);d.registerReadyCallback(Db);A=2}else Q=setTimeout(bb,200)}function pb(){if(!a.isReady)if(b.fullSyncDelay)setTimeout(function(){a.fullSync(U,ob,e)},b.fullSyncDelay);else a.fullSync(U,ob,e);else y()}function Hb(){if(wb()&&b.initOnPageLoad&&b.enabled){var a;if(!$BSI.isLoading())pb();else{var c=false;a=function(){if(c)return;if(a){$BSI.removeLoadedCallback(a);c=true}pb()};$BSI.addLoadedCallback(a)}}}a.getPersonHelper=function(a){vb.setPerson(a);return vb};a.getContactHelper=function(a,b){ub.setContact(a,b);return ub};a.isMeContact=function(b){var a=b[spContacts][0];return a&&a[scContactState]===1};function zb(a){return a[scContactState]===2||a[scContactState]===6&&a[scProperties]&&a[scProperties][scpIsHidden]===1}a.isHiddenContact=function(f){var c=f[spContacts],d=false,a=null,e=Math.min(c.length,3);for(var b=0;b<e;b++){a=c[b];if(a&&zb(a)){d=true;break}}return d||e==1&&a&&a[scSourceId]==="WLP"};a.isShellContactFanPage=function(b){var a=b[spContacts][0];return a&&a[scContactState]===9};a.getCacheConfig=function(){return b||xb()["ContactCache"]||{}};a.getDefaultNameType=function(){return a.getCacheConfig()["nameType"]||"0"};a.isLastNameFirstForNameType=function(b){b=b||a.getDefaultNameType();var c=c_nameFormats[b];return c&&c.lnf};a.isLastNameFirst=function(){return a.getCacheConfig()["isLastNameFirst"]?true:false};a.callWhenReady=function(c,b){if(a.isReady)c();else{if(u.length===0)a.$self.bind(c_readyEvent,kb);u.push(c);if(b)if(a.isFailed)b();else{if(t.length===0)a.$self.bind(c_failureEvent,jb);t.push(b)}}};a.removeWhenReadyCallback=function(c,b){var a=u.indexOf(c);if(a!=-1)u.splice(a,1);if(b){a=t.indexOf(b);if(a!=-1)t.splice(a,1)}};function jb(){a.$self.unbind(c_failureEvent,jb);processCallbacks(t)}function kb(){a.$self.unbind(c_readyEvent,kb);processCallbacks(u)}a.getProfile=function(c,d){var b=x.get(c);if(!(d||false)&&b===null)b=a.getPerson(c,true);return b};a.getPerson=function(b,c){var a=K.get(b);if(!(c||false)&&a===null)a=x.get(b);return a};a.getContactId=function(a,b){return getContactId(a,b)};a.getContactIdsForMri=function(b){var h=[];if(b){b=b.toLowerCase();for(var e=0,j=a.persons.length;e<j;e++){var i=a.persons[e][spContacts];for(var f=0,k=i.length;f<k;f++){var c=i[f];if(c[scProperties]){var d=c[scProperties][scpMri];if(d)for(var g=0,l=d.length;g<l;g++)if(d[g].toLowerCase()==b){h.push(c[scId]);break}}}}}return h};a.getGroup=function(a){return L.get(a)};a.getCategory=function(a){return v.get(a)};a.getService=function(a){return J.get(a)};a.getPersonsByCategory=function(f){var d=[];for(var b=0,e=a.persons.length;b<e;b++){var c=a.persons[b][spCategoryIds];if(c&&c.contains(f))d.push(a.persons[b])}return d};a.getPersonsByService=function(g){var c=[];for(var b=0,f=a.persons.length;b<f;b++){var d=a.persons[b],e=findItemInArray(d[spContacts],scSourceId,g);if(e)c.push(d)}return c};a.getProfileUrl=function(a){return b.profileUrl.replace("{cid}",a[spHexCid])};a.getPhotosUrl=function(a){return b.photosUrl.replace("{cid}",a[spHexCid])};a.queueProfileRequest=function(a){i.push(a)};a.queueProfileRequests=function(a){i.addRange(a)};a.clearQueue=function(){i=[]};a.cloneArray=function(a){return cloneArray(a)};function qb(e,h,d,c,b){var f=true,a;for(var g=0,l=j.length;g<l;g++){a=j[g];var i=a[c_requestType],k=a[c_inProgress];if(i===e){if(!k){f=false;a[c_beginCallbacks].push(h);d&&a[c_successCallbacks].push(d);c&&a[c_failureCallbacks].push(c);if(b&&!a[b])a[c_qosScenario]=b}break}else if(e===c_deltaSyncRequest&&i===c_fullSyncRequest&&!k){f=false;break}}if(f){a={};a[c_requestType]=e;a[c_beginCallbacks]=[h];a[c_successCallbacks]=[d];a[c_failureCallbacks]=[c];a[c_qosScenario]=b;a[c_inProgress]=false;j.push(a)}G()}function lb(){return c.get(R,b.peopleApiBaseUrl)}function P(b){var a=b&&b.getResponseHeader?b.getResponseHeader("PreferredHostName"):null;if(!isNullOrEmpty(a)&&(a.endsWith("live.com")||a.endsWith("live-int.com")))try{c.set(R,a)}catch(d){}}function G(){if(j.length===0)return;var c=j[0];if(!c[c_inProgress]&&!(c[c_requestType]===c_deltaSyncRequest&&X)){processCallbacks(c[c_beginCallbacks]);var d={};if(b.rpsToken)d["RPSTAuth"]=b.rpsToken;var e=location.protocol+"//"+lb()+"/people/abcore?SerializeAs=compact"+"&market="+k.mkt.encodeURIComponent()+"&appid="+b.peopleApiAppId.encodeURIComponent()+"&version="+c_schemaVersion.encodeURIComponent();c[c_startTime]=(new Date).getTime();addScenarioToHttpHeader(d,c[c_qosScenario]);c[c_inProgress]=true;if(c[c_requestType]===c_fullSyncRequest)$Network.fetchXML(e,function(a){Jb(a)},"GET",null,d);else if(c[c_requestType]===c_deltaSyncRequest)$Network.fetchXML(e+"&syncKey="+a.syncKey.encodeURIComponent(),function(a){Ib(a)},"GET",null,d);else submitFromException(new Error("Unknown request type"),"processSyncQueue")}}a.fullSync=function(d,c,e){if(b.enabled){var a,h=function(){a=e?e:startQoSScenario(c_WL_People_Cache_FullSync_ScenarioId,c_WL_People_Cache)},g=function(){stopQosScenario(a,true);d&&d()},f=function(b){stopQosScenario(a,false,b);c&&c()};qb(c_fullSyncRequest,h,g,f,a)}};a.deltaSync=function(f,e,g){if(b.enabled){c.set(o,"1");if(a.isReady){var d,j=function(){d=g?g:startQoSScenario(c_WL_People_Cache_DeltaSync_ScenarioId,c_WL_People_Cache)},i=function(){stopQosScenario(d,true);f&&f()},h=function(a){stopQosScenario(d,false,a);e&&e()};qb(c_deltaSyncRequest,j,i,h,d)}else p=true}};a.pauseDeltaSync=function(){X=true};a.resumeDeltaSync=function(){X=false;G()};a.loadQueuedProfiles=function(d,l){if(i.length>0){var c=[],f=[];for(var e=0,p=i.length;e<p;e++)if(a.getProfile(i[e]))f.push(i[e]);else c.push(i[e]);i=[];if(c.length>0)while(c.length>0){var j={},h=startQoSScenario(c_WL_People_Cache_GetProfiles_ScenarioId,c_WL_People_Cache);addScenarioToHttpHeader(j,h);var n=c.length>b.batchSize?b.batchSize:c.length,g=c.splice(0,n),o=g.join(","),m=(new Date).getTime();$Network.fetchXML(k.handlerBaseUrl+"/Handlers/PeopleApi/GetProfiles.mvc",function(a){Cb(a,d,l,g,m,h)},"POST","canary="+b.canary.encodeURIComponent()+"&cids="+o.encodeURIComponent()+"&market="+k.mkt.encodeURIComponent(),j)}if(f.length>0&&d)d(f,[])}else if(d)d([],[])};a.removeCachedPersonDetails=function(b){var a=l.get(b);if(a)l.remove([a])};a.tryGetPersonDetails=function(a){return l.get(a)};a.getPersonDetails=function(d,a,g,i,e){var c=l.get(d);if(c)if(i)try{a(c)}catch(j){throw j;}else setTimeout(function(){a(c)},4);else{var h=location.protocol+"//"+lb()+"/people/PersonDetails?contactid="+d.encodeURIComponent()+"&SerializeAs=compact"+"&market="+k.mkt.encodeURIComponent()+"&appid="+b.peopleApiAppId.encodeURIComponent()+"&version="+c_schemaVersion.encodeURIComponent(),f={};addScenarioToHttpHeader(f,e);$Network.fetchXML(h,function(b){Fb(b,a,g,d,getStartTime(),e)},"GET",null,f)}};a.processABChangedEvent=function(c){var b=true;if(!isNullOrEmpty(c))try{var e=jQuery(jQuery.parseXML(c)),d=e.find("LastModifiedDate");b=!(d.text()===a.lastModified)}catch(f){}if(b)a.deltaSync()};a.getFormattedDisplayName=function(a,b){return formatName(null,"displayName",null,a,null,b,null)};a.formatName=function(f,e,h,c,b,d,g){return formatName(f||a.getDefaultNameType(),e,h,c,b,d,g)};a.getFormattedName=function(c,b){return a.formatName(b.getNameType(),c,b.getTitle(),b.getFirstName(),b.getMiddleName(),b.getLastName(),b.getSuffix())};function gb(d){var c;if(isNullOrEmpty(c=a.getFormattedName("displayName",d)))if(isNullOrEmpty(c=d.getNickName()))if(isNullOrEmpty(c=d.getCompanyName()))if(isNullOrEmpty(c=d.getPassportMemberName()))if(isNullOrEmpty(c=d.getPersonalEmail())&&isNullOrEmpty(c=d.getWorkEmail())&&isNullOrEmpty(c=d.getOtherEmail()))if(isNullOrEmpty(c=d.getMobilePhone())&&isNullOrEmpty(c=d.getHomePhone())&&isNullOrEmpty(c=d.getHome2Phone())&&isNullOrEmpty(c=d.getWorkPhone())&&isNullOrEmpty(c=d.getWork2Phone())&&isNullOrEmpty(c=d.getOtherPhone()))c=b.nns;return c}a.getDisplayNameWithFallback=function(a){n.setPerson(a);return gb(n)};a.getLinkedWlpContact=function(f,b){if(!f||!b||b[scSourceId]!=="WL")return null;var e=b[scObjectId];if(!e)return null;var c=f[spContacts];if(c)for(var d=0,g=c.length;d<g;d++){var a=c[d];if(a&&a[scSourceId]==="WLP")if(a[scObjectId]===e)return a}return null};a.getContactDisplayNameWithFallback=function(e,b){var d=b,c=a.getLinkedWlpContact(e,b);if(c!=null)d=createMergedWlpContact(b,c);m.setContact(e,null,d);return gb(m)};a.getDisplayName=function(b){n.setPerson(b);return a.getFormattedName("displayName",n)};a.getFullName=function(b){n.setPerson(b);return n.getOrderedName()||a.getFormattedName("fullName",n)};a.getContactDisplayName=function(c,b){m.setContact(c,null,b);return a.getFormattedName("displayName",m)};a.getContactFullName=function(c,b){m.setContact(c,null,b);return m.getOrderedName()||a.getFormattedName("fullName",m)};function B(g,f){var a,c=null,b=parseJSON(g);if(b&&b.length)if(b[sError])if(b[sError].length>=2){var e=b[sError][0];a=b[sError][1]||"Unspecified error returned";if(e==c_errorInvalidPassportUser||e=="BadArgument"&&(a.toLowerCase().indexOf("resolve the caller")!=-1||a.toLowerCase().indexOf("ticket")!=-1)){a="Invalid passport user";c=c_errorInvalidPassportUser}}else{a="Invalid error response";c="InvalidResponse"}else{var d=b[sData];if(!d){a="Data is missing in the response";c="EmptyResponse"}else if(!f&&d[sAbCore.schemaVersion]!=c_schemaVersion){a="Schema mismatch (expected: {0}, returned: {1})".format(c_schemaVersion,d[sAbCore.schemaVersion]||"");c="SchemaMismatch"}}else{a="Invalid response format";c="InvalidResponse"}if(a)throw new PwcError(a,c);return b}function C(c,a,d,e,b){addScenarioQoSStats(e,b,!hasRequestSucceeded(a)?getResponseStatusCode(a):null,d,c)}function Fb(a,d,c,g,h,f){var b;C(f,a,h,c_Abch_ABService_UnifiedPeopleAPIPersonDetails,c_Abch);try{P(a);if(!hasRequestSucceeded(a))throw new PwcError("PersonDetails call failed",getResponseStatusCode(a));var e=B(stripJsonPrefix(a.responseText),true)[0];l.update([e]);if(d)d(e);return}catch(i){b=getErrorCodeFromException(i);if(b!="ContactDoesNotExist")submitFromException(i,"personDetailsCallback",b,null,true)}if(c)c(g,b)}function Jb(e){var b=j[0],h,d=null,g=b[c_qosScenario];C(g,e,b[c_startTime],c_Abch_ABService_UnifiedPeopleAPIABCoreFullSync,c_Abch);try{P(e);if(!hasRequestSucceeded(e))throw new PwcError("FullSync call failed",getResponseStatusCode(e));wLive.PageStats.add({url:"Contacts cache full sync"},b[c_startTime]);var f=stripJsonPrefix(e.responseText),i=B(f);O(i);l.clear();a.lastFullSync=a.lastDeltaSync=new Date;ib(f,g);j.shift();h=true}catch(k){d=getErrorCodeFromException(k);wLive.PageStats.add({url:"Contacts cache full sync",error:"Failed "+(d||"")},b[c_startTime]);submitFromException(k,"fullSync",d,null,true)}if(h){y();if(a.isReady)a.$self.triggerHandler(c_fullSyncEvent);processCallbacks(b[c_successCallbacks])}else{b[c_attempts]=(b[c_attempts]||0)+1;if(b[c_attempts]>=c_maxRetry||d===c_errorInvalidPassportUser){j.shift();a.lastFullSync=new Date;c.set(H,a.lastFullSync.getTime());y(false,true);processCallbacks(b[c_failureCallbacks],[d])}else b[c_inProgress]=false}G()}function Ib(f){var b=j[0],t,i=null,m,d=[],s=b[c_qosScenario];C(s,f,b[c_startTime],c_Abch_ABService_UnifiedPeopleAPIABCoreDeltaSync,c_Abch);try{P(f);if(!hasRequestSucceeded(f))throw new PwcError("DeltaSync call failed",getResponseStatusCode(f));var k=stripJsonPrefix(f.responseText),w=B(k),e=w[sData];if(e[sAbCore.isFullSync]){O(w);a.lastFullSync=a.lastDeltaSync=new Date;ib(k,s);m=true}else{var x=e[sAbCore.syncKey],A=e[sAbCore.lastModifiedDateTime],q=e[sAbCore.persons],p=e[sAbCore.groups],n=e[sAbCore.categories],u=e[sAbCore.settings],g=e[sAbCore.services];if(q&&q.length>0||p&&p.length>0||n&&n.length>0||g&&g.length>0||u!=null){if(g&&g.length>0)d.push(deltaSyncServices(g,a.services,a.$services,J));d.push(deltaSyncPersons(q,a.persons,a.$persons,K,l,a.services,v));d.push(deltaSyncArray(p,a.groups,a.$groups,L,sGroup.isDeleted,1));d.push(deltaSyncArray(n,a.categories,a.$categories,v,sCategory.isDeleted,1));a.settings=u||[];a.lastModified=A;storeIncrementalResponse(r,D,{json:k,syncKey:a.syncKey});a.syncKey=x}a.lastDeltaSync=new Date;c.set(F,a.lastDeltaSync.getTime())}j.shift();t=true}catch(E){i=getErrorCodeFromException(E);submitFromException(E,"deltaSync",i,null,true)}if(t){if(rb)c.set(o,"1");else{c.remove(o);$Cookie.setSessionCookie(c_deltaSyncCookieName,null)}y(!m);if(m)a.$self.triggerHandler(c_fullSyncEvent);else for(var h=0,z=d.length;h<z;h++)if(d[h]!==null)d[h].source.triggerHandler(c_changedEvent,d[h].args);processCallbacks(b[c_successCallbacks])}else{b[c_attempts]=(b[c_attempts]||0)+1;if(b[c_attempts]>=c_maxRetry||i===c_errorInvalidPassportUser){j.shift();a.lastDeltaSync=new Date;y(true,true);processCallbacks(b[c_failureCallbacks],[i])}else b[c_inProgress]=false}G()}function Cb(b,j,e,a,l,d){var h=false,g=[],f=[];C(d,b,l,WL_People_Cache_Rest_GetProfiles,c_WL_People_Cache);try{if(!hasRequestSucceeded(b))throw new PwcError("GetProfiles call failed",getResponseStatusCode(b));var k=hb(b.responseText);for(var c=0,m=a.length;c<m;c++)if(x.get(a[c]))g.push(a[c]);else f.push(a[c]);if(k)try{Ab(b.responseText)}catch(n){submitFromException(n,"storeProfilesDataInLocalStorage",getErrorCodeFromException(n),null,true)}stopQosScenario(d,true);h=true}catch(n){submitFromException(n,"loadQueuedProfiles",getErrorCodeFromException(n),null,true,d)}if(h)j(g,f);else{i.addRange(a);if(e)e(a)}}function hb(e){var b=parseJSON(e),d=s.profilesResponse;if(b&&b.length>0&&b[d.schemaVersion]==c_schemaVersion){var c=b[d.profiles];a.profiles.addRange(c);x.update(c);return c.length}else return 0}function y(d,i){if(i){if(++tb>=3)return}else tb=0;var e=new Date,c=b.fullSyncInterval,g=a.lastFullSync||e,h=a.lastDeltaSync||g;d=d||false;if(!d){if(ab!==null)clearTimeout(ab);c=Math.max(c-(e.getTime()-g.getTime()),0);ab=setTimeout(function(){a.fullSync()},c)}if(Y!==null)clearTimeout(Y);var f=Math.max(b.deltaSyncInterval-(e.getTime()-h.getTime()),0);if(f<c)Y=setTimeout(function(){a.deltaSync()},f)}function yb(){a.profiles.splice(0,a.profiles.length);a.persons.splice(0,a.persons.length);a.groups.splice(0,a.groups.length);a.categories.splice(0,a.categories.length);a.services.splice(0,a.services.length);i=[];x.clear();K.clear();v.clear();L.clear();J.clear();N();db()}function wb(){return q()!==""}function q(){var a=xb();return a&&a.hcid?a.hcid:""}function xb(){return k||$Config}function eb(a,b){loadIncrementalResponse(a,z,["json"],function(a){storeIncrementalResponse(b,z,{json:a["json"]});return true});a.clearTempStorage()}function Db(){var c=d.get(Z,""),b=parseInt(d.get(E,"0"));if(b&&(new Date).getTime()-b<c_expireProfilesDataAfter&&c===q()){a.profiles.splice(0,a.profiles.length);x.clear();loadIncrementalResponse(d,z,["json"],function(a){hb(a["json"]);return true})}else db()}function mb(){Eb();if(!a.isReady&&b.enabled){nb();if(Bb()){if(p){a.lastDeltaSync=new Date((new Date).getTime()-b.deltaSyncInterval);p=false}else a.lastDeltaSync=new Date(a.lastDeltaSync.getTime()+b.deltaSyncInterval);y();U()}else Hb()}}function U(){a.isReady=true;a.isFailed=false;$Cookie.setSessionCookie(c_cookieName,"1");if(e){stopQosScenario(e,true);e=null}a.$self.triggerHandler(c_readyEvent)}function ob(){a.isReady=false;a.isFailed=true;$Cookie.setSessionCookie(c_cookieName,null);if(e){stopQosScenario(e,false,"fullSyncFailure");e=null}a.$self.triggerHandler(c_failureEvent)}function Eb(){var d=c.get(M,""),e=c.get(cb,"");if(d!==q()||e!=k.mkt)N();if(g!==h){var a=b.localStorage?g:h;fb(a,a)}}function db(){if(d){d.remove(Z);d.remove(E);clearIncrementalResponse(d,z,["json"])}}function N(){fb(c,r)}function fb(a,b){if(a){a.remove(M);a.remove(cb);a.remove(S);a.remove(H);a.remove(F);a.remove(o);a.remove(R)}clearIncrementalResponse(b,D,["json","syncKey"])}function ib(e,f){var d=false,g=getStartTime(),b=null;try{clearIncrementalResponse(r,D,["json","syncKey"]);c.set(M,q());c.set(S,e);c.set(cb,k.mkt);c.set(H,a.lastFullSync.getTime());c.set(F,a.lastDeltaSync.getTime());c.remove(o);d=true}catch(h){b=getErrorCodeFromException(h);submitFromException(h,"storeAbDataInLocalStorage",b,null,true)}addScenarioQoSStats(c_WL_People_Cache_PersistAB_ApiId,c_WL_People_Cache,!d?b:null,g,f)}function Ab(b){var a=d.get(E,(new Date).getTime());d.set(Z,q());d.set(E,a);storeIncrementalResponse(d,z,{json:b},c_cachedProfilesLimit)}function Bb(){var g=c.get(M,""),d=false;if(g!==""&&g===q()){var i=getStartTime(),b=null;try{var f=c.get(S,null);if(f!==null){var j=B(f);O(j);var h=(new Date).getTime();p=c.get(o,"0")==="1"||$Cookie.getSessionCookie(c_deltaSyncCookieName)==="1";a.lastFullSync=new Date(parseInt(c.get(H,h)));a.lastDeltaSync=new Date(parseInt(c.get(F,h)));loadIncrementalResponse(r,D,["json","syncKey"],function(d){var f=parseJSON(d["json"]),e=d["syncKey"];if(e===a.syncKey){var b=f[sData],c=b[sAbCore.services];if(c&&c.length>0)deltaSyncServices(c,a.services,a.$services,J);deltaSyncPersons(b[sAbCore.persons],a.persons,a.$persons,K,l,a.services,v);deltaSyncArray(b[sAbCore.groups],a.groups,a.$groups,L,sGroup.isDeleted,1);deltaSyncArray(b[sAbCore.categories],a.categories,a.$categories,v,sCategory.isDeleted,1);a.settings=b[sAbCore.settings]||[];a.lastModified=b[sAbCore.lastModifiedDateTime];a.syncKey=b[sAbCore.syncKey];p=false;return true}else{p=true;return false}});d=true}}catch(k){b=getErrorCodeFromException(k);submitFromException(k,"loadAbDataFromLocalStorage",b,null,true)}addScenarioQoSStats(c_WL_People_Cache_RestoreAB_ApiId,c_WL_People_Cache,b,i,e);if(!d)N()}return d}function O(c){var b=c[sData];resetArray(a.persons,b[sAbCore.persons]);resetArray(a.groups,b[sAbCore.groups]);resetArray(a.categories,b[sAbCore.categories]);resetArray(a.groups,b[sAbCore.groups]);resetArray(a.services,b[sAbCore.services]);resetArray(a.settings,b[sAbCore.settings]);a.lastModified=b[sAbCore.lastModifiedDateTime];a.syncKey=b[sAbCore.syncKey]}a.dispose=function(){if($Logout&&b&&!b.fullyDisabled)$Logout.remove(yb);jQuery(w).unbind(c_unload,a.dispose);a.$self.unbind(c_readyEvent);a.$self.unbind(c_rpsCoookieExpired);a.$persons.unbind(c_changedEvent);a.$categories.unbind(c_changedEvent);a.$groups.unbind(c_changedEvent);a.$services.unbind(c_changedEvent);t=u=null;a.profiles=a.services=a.groups=a.categories=a.persons=a.settings=null;a.$self=a.$services=a.$groups=a.$categories=a.$persons=null};a.sortContactsByRank=function(b){sortContactsByRank(b,a.services)};a.populateContacts=function(c){var b=a.cloneArray(c);populateContacts(b);return b};a.dedupeContacts=function(c){var b=a.cloneArray(c);dedupeContacts(b);return b}}function preInit(){var a;try{a=w!=w.parent&&w.parent.location.hostname&&w.parent.$Do}catch(c){}if(a){var b=w.parent;b.$Do.when(c_wlxcontacts,0,outerWindowReady);jQuery(w).bind(c_unload,dispose)}else{w[c_globalVariableName]=new WLXContactsCore;callInitWhenReady()}}function dispose(){w.parent.$Do.remove(c_wlxcontacts,0,outerWindowReady);jQuery(w).unbind(c_unload,dispose)}function outerWindowReady(){w[c_globalVariableName]=w.parent[c_globalVariableName];callInitWhenReady()}function callInitWhenReady(){w[c_globalVariableName].init(window);$Do.register(c_wlxcontacts,0,true)}wLive.Contacts.DeltaSyncChangedItem=DeltaSyncChangedItem;function DeltaSyncChangedItem(a,b){this.original=a;this.updated=b}wLive.Contacts.DeltaSyncEventArgs=DeltaSyncEventArgs;function DeltaSyncEventArgs(c,a,b){this.added=c;this.changed=a;this.removed=b}function sortContactsByRank(b,a){b.sort(function(d,e){var f=getContactRank(d[scSourceId],a),g=getContactRank(e[scSourceId],a);if(f>g)return 1;else if(f<g)return -1;else{var b=d[scId],c=e[scId];if(b>c)return -1;else if(b<c)return 1;else return 0}})}function cloneArray(d){var a=d.clone();for(var b=0,e=a.length;b<e;b++){var c=a[b];if(typeof c==="object")if(c instanceof Array)a[b]=cloneArray(c)}return a}function clearWLContactProperties(b){for(var a=0,c=c_wlContactPromotedProps.length;a<c;a++)delete b[c_wlContactPromotedProps[a]]}function copyWLContactProperties(d,c){var a,b=0,e=c_wlContactPromotedProps.length;for(;b<e;b++){a=c_wlContactPromotedProps[b];d[a]=c[a]}}function getContactRank(d,c){var a;if(d==="ABCH")a=-2;else if(d==="WLP")a=-1;else{a=9999;for(var b=0,e=c.length;b<e;b++)if(c[b][sService.id]===d){a=c[b][sService.rank]||b;break}}return a}function updateIsFavoriteAndOrder(b,i){var h=0,a,c,d;if(b[spCategoryIds]){for(a=0,c=b[spCategoryIds].length;a<c;a++){d=i.get(b[spCategoryIds][a]);if(d&&d[sCategory.isFavorite]){h=1;break}}b[spIsFavorite]=h}var e=b[spContacts],f=e[0][scFavoriteOrder]||0;for(a=1,c=e.length;a<c;a++){var g=e[a][scFavoriteOrder]||0;if(f>g)f=g}b[spFavoriteOrder]=f}function clonePersonIfNeeded(a,b){var c=a[spId];if(!b[c]){populateContacts(a);b[c]=cloneArray(a)}}function getContactIndex(b,d){var c=-1,e=b[spContacts];for(var a=0,f=e.length;a<f;a++)if(getContactId(b,a)===d){c=a;break}return c}function deltaSyncPersonsFirstPass(j,l,k){for(var f=0,m=j.length;f<m;f++){var g=j[f],c=g[spContacts];for(var b=0;b<c.length;){var e=c[b],h=e[scId],a=l.get(h);if(a&&(e[scContactState]===sContactState.deleted||g[spId]!==a[spId])){var i=a[spContacts],d=getContactIndex(a,h);if(d!=-1){clonePersonIfNeeded(a,k);if(i[d][scSourceId]==="WL")clearWLContactProperties(a);i.splice(d,1)}}if(e[scContactState]===sContactState.deleted)c.splice(b,1);else b++}}}function deltaSyncPersonsSecondPass(i,k,j,l,m){for(var e=0,n=i.length;e<n;e++){var a=i[e];if(a[spContacts].length){var b=k.get(a[spId]);if(b&&b[spId]===a[spId]){var g=a[spContacts],d=b[spContacts];for(var f=0,o=g.length;f<o;f++){var c=g[f],h=getContactIndex(b,c[scId]);clonePersonIfNeeded(b,j);if(h!=-1)d[h]=c;else d.push(c);if(c[scSourceId]==="WL")copyWLContactProperties(b,a)}sortContactsByRank(d,m);b[spCategoryIds]=a[spCategoryIds];b[spIsFavorite]=a[spIsFavorite]}else l.push(a)}}}function deltaSyncPersons(j,n,p,b,o,q,m){if(!j)return null;var e={},i=[],f=[],g=[],h=[];deltaSyncPersonsFirstPass(j,b,e);deltaSyncPersonsSecondPass(j,b,e,i,q);for(var k in e)if(k){var c=e[k];if(c){var a=b.get(k);b.remove([c]);o.remove([c]);if(a){var s=a[spContacts].length;if(s===0){g.push(new DeltaSyncChangedItem(c,null));n.remove(a)}else{f.push(new DeltaSyncChangedItem(c,a));dedupeContacts(a);updateIsFavoriteAndOrder(a,m);b.update([a])}}}}for(var l=0,r=i.length;l<r;l++){var d=i[l];dedupeContacts(d);updateIsFavoriteAndOrder(d,m);h.push(new DeltaSyncChangedItem(null,d));n.push(d);b.update([d])}if(h.length>0||f.length>0||g.length>0)return {source:p,args:new wLive.Contacts.DeltaSyncEventArgs(h,f,g)};else return null}function deltaSyncServices(b,c,g,f){if(!b)return null;var e=new LazyHash(b,[0]);for(var d=0,h=c.length;d<h;d++){var a=e.get(c[d][0]);if(a==null){a=[];a[s.service.id]=c[d][0];a[s.service.isDeleted]=1;b.push(a)}}return deltaSyncArray(b,c,g,f,s.service.isDeleted,1)}function deltaSyncArray(d,b,n,e,l,m){if(!d)return null;if(typeof d!==c_undefined){var h=[],i=[],j=[];for(var k=0,o=d.length;k<o;k++){var a=d[k],c=-1;for(var g=0,p=b.length;g<p;g++)if(b[g][spId]===a[spId]){c=g;break}if(c!==-1){var f=b[c];if(a[l]===m){i.push(new DeltaSyncChangedItem(f,null));e.remove([f]);b.splice(c,1)}else{h.push(new DeltaSyncChangedItem(f,a));e.remove([f]);e.update([a]);b[c]=a}}else if(a[l]!==m){j.push(new DeltaSyncChangedItem(null,a));e.update([a]);b.push(a)}}if(j.length>0||h.length>0||i.length>0)return {source:n,args:new wLive.Contacts.DeltaSyncEventArgs(j,h,i)}}return null}wLive.Contacts.MWTLocalStorageWrapper=MWTLocalStorageWrapper;function MWTLocalStorageWrapper(h){var d=this,a=null,b,j=0,i,g=[],c=(new Date).getTime();d.registerReadyCallback=function(a){if(i)a();else g.push(a)};function k(){b=new Microsoft.Live.Core.LocalStorageProxy("wlx_contacts");b.add_initialized(e)}function e(a){b.remove_initialized(e);if(a.get_status()==Microsoft.Live.Core.LocalStorageStatus.initialized)f()}function f(){if(b.status==1){addScenarioQoSStats(c_WL_People_Cache_InitMWTStorage_ApiId,c_WL_People_Cache,null,c,h);a=b;i=1;wLive.PageStats.add({url:"Init MWT storage"},c);processCallbacks(g)}else if(b.status==0){if(j++<10)setTimeout(f,1e3)}else{addScenarioQoSStats(c_WL_People_Cache_InitMWTStorage_ApiId,c_WL_People_Cache,"unknown",c,h);wLive.PageStats.add({url:"Init MWT storage",error:"Failed to init MWT storage"},c)}}d.get=function(d,c){var b=a?a.get_item(d):null;if(b==null)b=c;return b};d.set=function(b,c){if(a)a.set_item(b,c)};d.remove=function(b){if(a)a.set_item(b,null)};$Do.when("wlximlocalstoreready",0,k)}wLive.Contacts.CrossDomainProxy=CrossDomainProxy;function CrossDomainProxy(i,j){var b=this,f=null,e=null,g,d=[],c,a=(new Date).getTime();function k(){c=location.protocol+"//"+i+"/xmlProxy.htm?vn="+w.$Version.encodeURIComponent()+"&domain="+($Config.d||$Config.domain).encodeURIComponent();$Network.fetchXML(c,h,"GET",null,null)}function h(o){var b,i=o.status,m;if(i==200){var n=w.document.getElementsByTagName("iframe");for(var l=0,p=n.length;l<p;l++)try{var k=n[l];if(k.contentDocument.location.href==c){b=k.contentWindow||k.contentDocument.parentWindow;wLive.PageStats.add({url:"Load xmlproxy.htm"},a);break}}catch(q){}}if(!b){b=w;wLive.PageStats.add({url:"Load xmlproxy.htm",error:"Failed to load xmlproxy.htm (status code:"+i+")"},a);m=true}else try{var h="st_"+Math.round(Math.random()*1e5);b.sessionStorage.setItem(h,h);if(b.sessionStorage.getItem(h)!=h)throw new Error("Wrong value");b.sessionStorage.removeItem(h)}catch(q){b=w}addScenarioQoSStats(c_WL_People_Cache_LoadXmlProxy_ApiId,c_WL_People_Cache,m?i:null,a,j);f=b.localStorage;e=b.sessionStorage;g=1;processCallbacks(d)}b.registerReadyCallback=function(a){if(g)a();else d.push(a)};b.getLocalStorage=function(){return f};b.getSessionStorage=function(){return e};k()}wLive.Contacts.DOMLocalStorageWrapper=DOMLocalStorageWrapper;function DOMLocalStorageWrapper(c,g){var b=this,a=null,e,d=[];function f(){a=g?c.getLocalStorage():c.getSessionStorage();e=1;processCallbacks(d)}b.registerReadyCallback=function(a){if(e)a();else d.push(a)};b.get=function(d,c){var b=a?a.getItem(d):null;if(b==null)b=c;return b};b.set=function(b,c){if(a)a.setItem(b,c)};b.remove=function(b){if(a)a.removeItem(b)};c.registerReadyCallback(f)}wLive.Contacts.LocalStorageProxy=LocalStorageProxy;function LocalStorageProxy(d,f){var c=this,b=[],a=null,e,g=[];function h(){if(f)f(c,d);a=d;for(var h in b){var i=b[h];if(typeof i==="string")a.set(h,b[h])}e=1;processCallbacks(g)}c.clearTempStorage=function(){b=[]};c.registerReadyCallback=function(a){if(e)a();else g.push(a)};c.remove=function(c){if(a)a.remove(c);else delete b[c]};c.get=function(e,d){var c;if(a)c=a.get(e,d);else{c=b[e];if(typeof c===c_undefined||c==null)c=d}return c};c.set=function(c,d){if(a)a.set(c,d);else b[c]=d};if(d)d.registerReadyCallback(h);else e=1}function processCallbacks(a,c){c=c||[];for(var b=0,d=a.length;b<d;b++)if(a[b])a[b].apply(null,c);a.splice(0,a.length)}function getContactId(a,b){return a[spContacts][b][scId]||a[spId]}function storeIncrementalResponse(b,c,h,i){var f=parseInt(b.get(c+c_startIndexKeySuffix,"0")),e=parseInt(b.get(c+c_endIndexKeySuffix,"-1")),d=[],a,g;for(var j in h)if(typeof j==="string")d.push(j);g=d.length;if(i&&e-f+1>=i){for(a=0;a<g;a++)b.set(c+d[a]+f,null);b.set(c+c_startIndexKeySuffix,++f)}++e;b.set(c+c_endIndexKeySuffix,e);for(a=0;a<g;a++)b.set(c+d[a]+e,h[d[a]])}function clearIncrementalResponse(a,b,f,c){if(a){var i=c||parseInt(a.get(b+c_startIndexKeySuffix,"0")),h=parseInt(a.get(b+c_endIndexKeySuffix,"-1")),g=f.length;for(var d=i;d<=h;d++)for(var e=0;e<g;e++)a.remove(b+f[e]+d);if(c)a.set(b+c_endIndexKeySuffix,c-1);else{a.remove(b+c_startIndexKeySuffix);a.remove(b+c_endIndexKeySuffix)}}}function loadIncrementalResponse(a,b,c,g){var h=parseInt(a.get(b+c_startIndexKeySuffix,"0")),i=parseInt(a.get(b+c_endIndexKeySuffix,"-1")),j=c.length;for(var d=h;d<=i;d++){var f={};for(var e=0;e<j;e++)f[c[e]]=a.get(b+c[e]+d,null);if(!g(f)){clearIncrementalResponse(a,b,c,d);break}}}function stripJsonPrefix(a){return a.substring(6,a.length)}function parseJSON(str){var result;try{result=eval(str)}catch(a){result=[,[a.name,"Syntax error: "+a.message]]}return result}function resetArray(a,b){a.splice(0,a.length);a.addRange(b||[])}function findItemInArray(a,d,e){if(a)for(var b=0,f=a.length;b<f;b++){var c=a[b][d];if(typeof c!==c_undefined&&c===e)return a[b]}return null}function LazyHash(j,h,i){var c=this,b=false,a=[],f=i||false;c.get=function(d){if(!b){b=true;c.update(j)}return a[d]||null};c.clear=function(){b=false;a=[]};c.update=function(a){if(b)g(a,false)};c.remove=function(a){if(b)g(a,true)};function g(f,j){j=j||false;var a,b,c,l,g,k,q=f.length,n=h.length,o,p,m=[],i=[];for(c=0;c<n;c++){a=h[c];if(Object.isArray(a))i.push(a);else m.push(a)}n=m.length;o=i.length;for(b=0;b<q;b++){for(c=0;c<n;c++){a=f[b][m[c]];if(j)e(a,f[b]);else d(a,f[b])}for(g=0;g<o;g++){k=f[b][i[g][0]];if(k)for(l=0,p=k.length;l<p;l++){a=k[l][i[g][1]];if(j)e(a,f[b]);else d(a,f[b])}}}}function e(b,c){if(b&&a[b])if(f)a[b].remove(c);else delete a[b]}function d(b,d){if(!isNullOrUndefined(b))if(f){var c=a[b];if(isNullOrUndefined(c))c=a[b]=[];c.push(d)}else a[b]=d}}function isNullOrUndefined(a){return typeof a===c_undefined||a==null}function isNullOrEmpty(a){return a===""||isNullOrUndefined(a)}function addSuffixIfNotEmpty(a,c,b){return !isNullOrEmpty(a)&&!isNullOrEmpty(c)?a+b:a}function createMergedWlpContact(f,k){var c=null;for(var h=0,l=c_dedupeMap.length;h<l;h++){var d=c_dedupeMap[h],b=d.contactFields,j=d.isArray,i=d.arrayIndex;if(areValuesEmpty(f,b,j,i)){var e=[];if(!copyValues(k,e,b,j,i)){c=c||cloneArray(f);for(var a=0,m=Math.min(b.length,e.length);a<m;a++)if(d.isArray){var g=c[b[a]];if(g===undefined||g===null)c[b[a]]=g=[];c[b[a]][d.arrayIndex]=e[a]}else c[b[a]]=e[a]}}}return c||f}function formatName(e,d,g,b,a,c,f){var h=c_nameFormats[e][d];return h(g,b,a,c,f)}function createNameFormatFunction(e){var c=e.split("|"),a=["if (!firstName && !lastName) { return null }; var n = [], s = '';"];for(var b=0,f=c.length;b<f;b+=2){var d=c_nameFormatArgumentsMapping[c[b]];a.push("if ("+d+") {");a.push(" if (n.length) { n.push(s); } ");a.push(" n.push("+d+"); ");a.push("s = '"+c[b+1]+"';");a.push("} else {s = s || '"+c[b+1]+"';}")}a.push("return n.join('').trim();");return new Function("title","firstName","middleName","lastName","suffix",a.join(""))}function formatDisplayNameReverse(d,a,e,b,c){return formatNameReverse(d,a,null,b,c)}function formatNameReverse(f,c,d,b,e){var a=[];if(!c&&!b)return null;if(b)a.push(b);if(e&&b){a.push(" ");a.push(e)}if(c){if(b)a.push(", ");if(f){a.push(f);a.push(" ")}a.push(c)}if(d){if(!c&&b)a.push(", ");else a.push(" ");a.push(d)}return a.join("").trim()}function getResponseStatusCode(a){return (a?a.status:null)||"unknown"}function hasRequestSucceeded(a){return getResponseStatusCode(a)==200}function submitFromException(f,e,c,a,d,b){$WebWatson.submitFromException(f,c_globalVariableName+"."+e,c,a,d,b)}function isQosEnabled(){return w.$WLXContacts.getCacheConfig()["qos"]}function addScenarioQoSStats(f,d,a,e,b){if(isQosEnabled()&&b){var c={api:f,dependent:d};if(typeof a!=undefined&&a!=null)c["error"]=a;$ScenarioQoSStats.add(c,e,b)}}function startQoSScenario(b,a){return isQosEnabled()?$ScenarioQoS.startScenario(b,a):null}function stopQosScenario(b,a,c){if(isQosEnabled())$ScenarioQoS.stopScenario(b,a,c)}function addScenarioToHttpHeader(b,a){if(isQosEnabled()&&a&&b)$ScenarioQoS.addScenarioToHttpHeader(b,a)}function getErrorCodeFromException(a){return a.errorCode}function PwcError(b,a){this.errorCode=a;this.message=b}function getStartTime(){return (new Date).getTime()}PwcError.prototype=new Error;PwcError.prototype.constructor=PwcError;function compareArrays(b,c){var a=false;if(b&&c&&b.length===c.length){a=true;b.forEach(function(d,b){if(c[b]!=d)a=false})}return a}function populateContacts(a){var l=a[spContacts],v=a[spId];for(var j=0,q=c_dedupeMap.length;j<q;j++){var d=c_dedupeMap[j],o=d.mask,c=d.personFields,g=d.contactFields,i=d.arrayIndex,n=d.isArray,m=false;for(var k=0,r=l.length;k<r;k++){var b=l[k];if(b[scPromotionBitmap]&o){m=true;if(n)for(var e=0,s=c.length;e<s;e++){var p=a[c[e]];if(p){if(!b[g[e]])b[g[e]]=[];b[g[e]][i]=p[i]}}else for(var h=0,t=c.length;h<t;h++)b[g[h]]=a[c[h]];b[scPromotionBitmap]=b[scPromotionBitmap]&~o}}if(m)for(var f=0,u=d.personFields.length;f<u;f++)if(n){if(a[c[f]])a[c[f]][i]=null}else a[c[f]]=null}a[spId]=v}function areValuesEmpty(h,c,e,d){var f=true;for(var b=0,g=c.length;b<g;b++){var a=h[c[b]];if(e&&a)a=a[d];if(a)return false}return f}function copyValues(i,h,d,f,e){var c=true;for(var b=0,g=d.length;b<g;b++){var a=i[d[b]];if(f&&a)a=a[e];if(a){h[b]=a;c=false}}return c}function clearValues(b,e,f,d){for(var c=0,g=e.length;c<g;c++){var a=e[c];if(b[a])if(f){if(d<b[a].length)b[a][d]=null}else b[a]=null}}function areEqual(k,j,c,h,g,f){var d=true;for(var b=0,i=c.length;b<i;b++){var l=c[b],a=k[c[b]];if(h&&a)a=a[g];var e=j[b];if(f){if(!f(a,e)){d=false;break}}else if(!(typeof a===c_undefined&&typeof e===c_undefined||a===e)){d=false;break}}return d}function dedupeContacts(a){var u=a[spId];for(var j=0,s=spFieldsCount;j<s;j++)if(c_dedupableFieldsHash[j])delete a[j];a[spId]=u;for(var l=0,p=c_dedupeMap.length;l<p;l++){var b=c_dedupeMap[l],t=b.mask,n=a[spContacts],d=[],k=b.contactFields,c=b.personFields,h=b.isArray,g=b.arrayIndex,o=b.comparer,i=copyValues(a,d,c,h,g);for(var m=0,q=n.length;m<q;m++){var f=n[m];if(i)i=copyValues(f,d,k,h,g);if(!i&&areEqual(f,d,k,h,g,o)){f[scPromotionBitmap]=(f[scPromotionBitmap]||0)|t;clearValues(f,k,h,g)}}if(b.isArray&&!a[c[0]])a[c[0]]=[];if(!i)for(var e=0,r=Math.min(c.length,d.length);e<r;e++)if(b.isArray)a[c[e]][b.arrayIndex]=d[e];else a[c[e]]=d[e]}}preInit()})();window.$ic={eventutil:{},dom:{},data:{},constants:{ControlDataIndex:{cid:"0",showmenu:"1",menudefault:"2",name:"3",contactid:"4",deccid:"5",address:"6",membername:"7",membernamescope:"8",thirdpartyname:"9",attachmenutobody:"10",placedintable:"11",tileitemid:"12",nameitemid:"13",psmitemid:"14",badgeitemid:"15",actiontypeurloverride:"16",usertileurl:"17",unsafeusertileurl:"18",childicid:"19",extradata:"20"},MenuIndex:{text:"0",url:"1",itemid:"2",callback:"3",target:"4"},InlineMenuIndex:{rm:"0",psm:"1",ut:"2"},RendeModes:{utnmpsm:"0",utnmem:"1",nmem:"2",em:"3"}},ItemType:{Tile:"Tile",Name:"Name",Message:"Message",MenuCustom:"MenuCustom"},scoped_eval:function(p_args){eval(p_args)}};(function(){var b=window,e=b.$ic,gb=b.$WebWatson,pb=b.$Utility,ub=b.Debug,U=b.$IS,qb=b.$Beacon,F,y,K,N="icTm",Y=4,x,h,q,c,g,O=e.constants,f,C,ib="&nbsp;-&nbsp;",X=21,z=$B.IE,lb=$B.IE_M6,vb=$B.ltr,tb=$B.IE_M7,fb=z&&$B.V<9,Q=z&&$B.V>8,R=$B.RE_WebKit,sb=$Config,Z=625,V="ic/icmenu.png,ic/icmenu.png,",I=O.MenuIndex,a=O.ControlDataIndex,n,d,r,P,G,k="menu_ul",o="usertile",W=o+"container",s="frame_clip",S="title",M="alt",v="click",E="none",ob="inherit",L="href",T="id",rb="class",H="undefined",db="c_ic_menu",nb="c_ic_menu_separator",l="style",i="setAttribute",cb="className",J="display",w="replace",D="innerHTML",t="parentNode",u="appendChild",p="length",m="$Sutra.Shared.",eb="00000000-0000-0000-0000-000000000000",A=function(a){return b.document.createElement(a)},j=function(a){return a.join("")};function mb(){h=e.eventutil=new ab;f=h.addEvent;C=h.removeEvent;q=e.dom=new bb;c=q.$;g=e.data=new jb;n=g.ControlData;d=n.getItem;r=n.getObject;P=g.CommonData;G=P.getItem;x=e.menu=new kb;F=e.ic=new hb;var a;if(!window.ic_dinit)e.ic.init();$Do.register("$ic.init",e.ic.init)}function ab(){var b=this;b.stopEventAction=function(a){z?(event.returnValue=false):a.preventDefault()};b.eventTarget=function(a){return z&&window.event?window.event.srcElement:a.target};var a={};b.dispose=function(){for(var c in a)b.removeAllICEvents(c,1);a=null;b=null};var c=function(a){return !a||a==""?"icglobalevent":a};b.addEvent=function(e,d,f,b){b=c(b);if(!a[b])a[b]=[];jQuery(e).bind(d,f);a[b].push({el:e,e:d,f:f})};b.removeEvent=function(h,g,i,d){d=c(d);var f=a[d],e=f[p],b;while(e--){b=f[e];if(b.el==h&&b.e==g&&b.f==i){jQuery(b.el).unbind(b.e,b.f);a[d].splice(e,1);break}}};b.removeAllICEvents=function(b,g){b=c(b);var e=a[b],f=e[p],d;while(f--){d=e[f];jQuery(d.el).unbind(d.e,d.f)}if(!g)delete a[b];else a[b]=null}}function bb(){var a={},c=this;c.dispose=function(){a=null;c=null};var d=function(a){return a&&a.indexOf("_")>0?a.split("_")[0]:""};c.getIcIdFromAnyParent=function(c){var a=h.eventTarget(c),b=d(a.id);while(b==""&&a[t]){a=a[t];b=d(a.id)}return b};c.$=function(f,e){var c=j([f,"_",e]),d=a[c];if(!d)d=a[c]=b._ge(c);return d};c.clearByPrefix=function(c){for(var b in a)if(b.indexOf(c)==0)delete a[b]}}var B=function(a,b){if(a)a.splice(a.indexOf(b),1)};function jb(){var a=this;a.dispose=function(){a.Itemid_Element_Map.dispose();a.Cid_Icid_Map.dispose();a.ControlData.dispose();a=null};a.Itemid_Element_Map=new c;function c(){var a={},b=this;b.add=function(d,c,f){if(!d||!c||!f)return;var b=a[d];if(!b)b=a[d]={};var e=b[c];if(!e)e=b[c]=[];e.push(f)};b.remove=function(d,b,c){if(!d||!b||!c)return;var e=a[d];if(e)B(e[b],c)};b.getItem=function(d,c){var b=a[d];if(b&&b[c])return b[c];else return []};b.dispose=function(){a=null;b=null}}a.Cid_Icid_Map=new d;function d(){var a={},b=this;b.add=function(c,d){var b=a[c];if(!b)b=a[c]=[];b.push(d)};b.remove=function(c,b){var d=a[c];B(d,b)};b.getItem=function(b){return a[b]||[]};b.dispose=function(){a=null;b=null}}a.CommonData=new f;function f(){this.getItem=function(c){var a=b.ic_common_data;if(a&&a[c])return a[c];return ""}}a.ControlData=new e;function e(){var c={},a=this;a.exists=function(){return b.ic_control_data};a.getObject=function(){return c};a.removeObject=function(d){if(c[d])delete c[d];if(a.exists()&&b.ic_control_data&&b.ic_control_data[d])delete b.ic_control_data[d]};a.getNewObjects=function(){return a.exists()?b.ic_control_data:{}};a.getItem=function(d,e){var a=c[d];if(!a&&b.ic_control_data){a=b.ic_control_data[d];b.ic_control_data[d]=null;if(a)c[d]=a}return a&&a[e]?a[e]:""};a.dispose=function(){c=null;a=null}}}function hb(){var j=this,M=0,O={},m={},t={},A={},G={},C={};j.init=function kb(){if(n.exists()){if(j.load)return;j.load="started";j.bind();j.load="finished";Z();$Do.register("$ic",eb)}};function eb(a){try{a()}catch(b){gb.submitFromException(b)}}function Z(){try{var a=window.top;if(a!=window&&!a.ic_common_data){a.ic_common_data={};ic_common_data.savedTemplates=g.savedTemplates;jQuery.extend(true,a.ic_common_data,ic_common_data);a.ic_menu_data={};jQuery.extend(true,a.ic_menu_data,ic_menu_data);a.ic_control_data={};var c=r();for(var b in ic_template_data){a.ic_control_data[b]=[];jQuery.extend(true,a.ic_control_data[b],c[b])}a.ic_template_data={};jQuery.extend(true,a.ic_template_data,ic_template_data);window.$ssl.copyOutConfig(a);a.$Do.when("$ic.init")}}catch(d){}}j.reinit=function(){if(n.exists())j.bind()};j.addMenuBindingRef=function(a,b){if(a)G[a]=b};j.updateMenuBindingRef=function(b){var a=G[b];if(a)a.update()};j.getICNamespaceCount=function(a){return A[a]||0};j.removeICsFromNamespace=function(a){if(M||!a)return;var b=t[a];if(b){for(var c=0;c<b[p];c++)j.removeIC(b[c],1);delete t[a]}q.clearByPrefix(a);A[a]=0};j.removeIC=function(b,k){if(M||!b)return;var l,i=e.ItemType,f=g.Itemid_Element_Map.remove;if(r()[b]){j.removeIC(d(b,a.childicid));if(d(b,a.showmenu)=="1"){h.removeAllICEvents(b,0);x.cleanUpMenu(b)}else{f(d(b,a.tileitemid),i.Tile,c(b,s));if(typeof uxp_p!=H)f(d(b,a.tileitemid),i.Tile,c(b,o))}g.Cid_Icid_Map.remove(d(b,a.cid),b);j.unregister(d(b,a.membername),b);f(d(b,a.nameitemid),i.Name,c(b,"name"));f(d(b,a.psmitemid),i.Message,c(b,"psm"))}n.removeObject(b);if(G[b])delete G[b];if(!k){B(t[S(b)],b);q.clearByPrefix(b+"_")}};var P=new RegExp("cid-([a-zA-z0-9]+)","g"),cb=j.getHexCidFromContact=function(b){var a=P.exec(b.get_profileUrl());P.lastIndex=0;if(a&&a[p]>1)return a[1];else return null};function W(a){return z&&(a==null||a=="")?'""':a}function T(f,e){var b,a,d=f.get_addresses();for(var c=0,g=d.get_count();c<g;c++){b=d.get_item(c);a=b.get_network().get_id();if(e&&a=="WL"||!e&&a!="WL"&&a!="OCS"&&a!="YH"&&a!="SMS")return b}return 0}j.createICsFromCids=function(i,k,h,f){_wlxcontacts=b["$WLXContacts"];var d={cidsToIds:{},templateId:i,callBack:h},a=0,c=[];c.addRange(k);var n=c.length;for(a=0,len=c.length;a<len;a++)d.cidsToIds[c[a][0]]=c[a][1];if(y&&y.hasContacts()){var l=y.user.get_contacts();for(a=0;a<c.length;a++){var g=l.findByCid(c[a][0]);if(g){var m=j.createICFromTemplate(d.templateId,g,0,0,0,0,0,0,0,0,0,0,0,0,f?1:0,1);d.callBack(c[a][1],m);c.remove(c[a]);a--}}}var e=[];for(a=0;a<c.length;a++)if(c[a][0]!="0"&&c[a][0]!=0)e.push(c[a][0]);if(0<e.length)$Do.when("wlxcontacts",0,function(){_wlxcontacts=b["$WLXContacts"];_wlxcontacts.queueProfileRequests(e);_wlxcontacts.loadQueuedProfiles(function(b,a){V(b,a,d,f)},U)})};function V(d,f,c,g){var a,e;for(a=0,e=d.length;a<e;a++){var i=_wlxcontacts.getProfile(d[a]),k=c.cidsToIds[d[a]],b=ab(i),h=j.createICFromTemplate(c.templateId,0,0,0,0,b["hexCid"],b["decCid"],b["name"],b["email"],b["memberName"],b["userTileUrl"],b["psm"],0,0,g?1:0,0);c.callBack(c.cidsToIds[d[a]],h)}for(a=0,e=f.length;a<e;a++)c.callBack(c.cidsToIds[f[a]],null)}function ab(b){var a={},c=window.wLive.Contacts.WLXContactsSchema.person,e=window.wLive.Contacts.WLXContactsSchema.email;a["hexCid"]=u(b[c.hexCid])?null:b[c.hexCid];a["decCid"]=u(b[c.cid])?null:b[c.cid];a["name"]=_wlxcontacts.getDisplayName(b);var d=b[c.emails]||[];a["email"]=u(d[e.personal])?null:b[d[e.personal]];a["memberName"]=null==a["decCid"]?null:"11:"+a["decCid"];a["userTileUrl"]=u(b[c.userTileMedium])?null:b[c.userTileMedium];return a}function u(a){return a=="undefined"?true:false}function U(){}j.createICFromTemplate=function(j,d,t,l,x,A,z,i,n,s,q,e,P,O,B,I){var H="get_currentAddress",v="get_presence",C,E,u,m,F,k,o;if(d){F=T(d,1);k=T(d,0);A=A||cb(d);z=z||d.get_cid();if(k)m=k.get_linkedContact();i=i||$WLXIM.getDisplayName(d);u=d[H]();if(d.get_emailAddress)C=d.get_emailAddress();q=q||d[v]().get_displayPictureUrl();if(!e)e=E=d[v]().get_personalMessage();if(!s)if(t)s=t.get_id();else if(u)s=u.get_id();n=n||C;if(!l&&t){var G=t.get_network();if(G)l="n:"+G.get_id()}}l=l||"a";x=x||j;j=N+j;var h=r()[j];if(h){var c=[];b.ic_control_data=b.ic_control_data||{};for(var f=0,L=Math.max(h[p],X);f<L;f++)switch(f+""){case a.menudefault:c.push(h[f]);break;case a.contactid:c.push(d?d.get_id()+"":h[f]);break;case a.cid:c.push(A);break;case a.name:c.push(i);break;case a.deccid:c.push(z);break;case a.address:c.push(n);break;case a.membername:c.push(s);break;case a.thirdpartyname:if(k)c.push(m.get_network().get_name());else c.push(h[f]);break;case a.attachmenutobody:c.push(B?B:h[f]);break;case a.membernamescope:c.push(l);break;case a.actiontypeurloverride:if(k)c.push({pr3:m.get_profileUrl()+"",ph3:m.get_photosUrl()+"",sm3:m.get_sendMessageUrl()+""});else c.push(h[f]);break;case a.usertileurl:c.push(q?window.$ssl.ensureSSLImageUrl(q+""):h[f]);case a.unsafeusertileurl:c.push(h[f]);break;case a.extradata:c.push({ltnu:I});break;default:c.push(h[f])}var J=window.ic_template_data[j]++,y=x+j+J;b.ic_control_data[y]=c;if(e)if(!$B.Mobile&&K&&E==e)if(d)e=d[v]().createPersonalMessageElement()[D];else e=K.Messenger.MessengerUtility.emoticonEncode(e)[D];else e=e.encodeHtmlAttribute();if(i)i=i.encodeHtmlAttribute();if(n)o=n.encodeHtmlAttribute();else if(k&&!F)o=i+" ({0})".format((k.get_network().get_name()+"").encodeHtmlAttribute());else o=i;var M=g.savedTemplates[j][w](new RegExp(j,"g"),y).format(i,e?ib+e:"",e?e:"",W(o));jb();return {html:M,id:y}}return null};var I,jb=function(){if(I)clearTimeout(I);I=setTimeout(j.reinit,10)};j.getICTileSize=function(b){var a=c(b,"usertilecontainer")&&c(b,"usertilecontainer").className.split(" ");if(a&&a[1])return a[1].replace("c_ic_img_","");else return ""};j.displayICAsFav=function(a){var b=c(a,"menu_af"),d=c(a,"fstarp");if(b){b[l][J]=E;x.HideSeparatorIfLastVis(b);c(a,k).binding.update()}if(d){$css.remove(d,"c_ic_fstarp_hide");var e=c(a,"name");if(e)$css.add(e.parentNode,"c_ic_name_fstar_"+j.getICTileSize(a))}};j.replaceUserTile=function(d,b){var a=c(d,o);if(!u(a)&&!u(b)){a.src=b;a.style.left="0px";if(fb)ic_onTL(a);else j.ic_onTileLoad(a)}};j.showUnsafeUserTile=function(b){var c=d(b,a.unsafeusertileurl);j.replaceUserTile(b,c)};j.dispose=function(){jQuery(b).unbind("unload",j.dispose);x.dispose();h.dispose();g.dispose();if(e.presence)e.presence.dispose();q.dispose();A=t=G=O=m=C=j=_focusShowMenuTimeout=_onhoverShowMenu_ic_id=null;M=1};jQuery(b).bind("unload",j.dispose);function hb(){if(!g.savedTemplates)if(ic_common_data.savedTemplates)g.savedTemplates=ic_common_data.savedTemplates;else{var a={};for(var c in ic_template_data){var d=b._ge(c+"_template");a[c]=d[D]}g.savedTemplates=a}}j.set_wlxim=function(){y=$WLXIM};j.set_wlximML=function(){K=y.ML};j.get_membername_id_map=function(){return O};j.get_membername_iclist_map=function(){return m};j.ic_onTileErr=function(d){var b,a;try{a=jQuery(d);b=a.parent();a.remove();var c=a.attr("errsrc")||$icerrsrc;if(a.attr("src")!=c){a.attr("class","c_ic_tile").css("top","").css("left","").css("height","").css("width","");setTimeout(function(){a.attr("src",c).css("visibility","")},0)}}catch(e){}finally{if(null!=b)b.append(a)}};j.ic_onTileLoad=function(d){try{var b=jQuery(d);b.attr("class","c_ic_tile");var a,c,g=0;c=d.naturalWidth;a=d.naturalHeight;var f=b.css("width"),e=b.css("height");if(c==1&&a==1||f=="1px"&&e=="1px"){j.ic_onTileErr(d);return}var h=Math.round;if(c&&a&&c!=a)if(c>a){var i=parseInt(e),k=parseInt(f),l=h(c*(i/a));g=-h((l-k)/2);b.css({width:"auto","max-width":"none",left:g+"px"})}else b.css({height:"auto","max-height":"none"});b.css("visibility","")}catch(m){}};function bb(a){if(Q||R)j.ic_onTileLoad(h.eventTarget(a));else ic_onTL(h.eventTarget(a))}function db(a){if(Q||R)j.ic_onTileErr(h.eventTarget(a));else ic_onTE(h.eventTarget(a))}j.getMemberFavoriteList=function(){return C};j.removeMemberFromFavoriteList=function(a){if(C[a])delete C[a]};j.register=function lb(h,b){if(!b)return;if(h){if(!m[h])m[h]=[];m[h].push(b);if(C[h])j.displayICAsFav(b)}var g=c(b,o);if(g&&!g.src){f(g,"load",bb,b);f(g,"load",function(){ic_showBar(b)},b);f(g,"error",db,b);f(g,"error",function(){ic_showBar(b)},b);var i=d(b,a.usertileurl);if(i)g.src=i;else g.src=g.getAttribute("errsrc")||$icerrsrc;F.updateMenuBindingRef(b)}if(e.presence&&h)e.presence.updateStatusFromRegister(h,b)};j.unregister=function(a,b){if(!a||!b)return;B(m[a],b)};function S(a){return a.substring(0,a.indexOf("ic"))}j.bind=function(){var h,k,r,u,p=e.ItemType,l=g.Itemid_Element_Map.add;hb();for(h in n.getNewObjects()){var m=S(h),q=t[m];if(!q){q=t[m]=[];A[m]=0}q.push(h);A[m]++;if(h.substring(0,Y)==N){d(h,a.showmenu);continue}if(!b._ge(h))continue;if(d(h,a.showmenu)=="1"){k=c(h,s);if(!k)continue;f(k,"mouseover",j.initMenu,h);f(k,"focus",j.initMenu,h);f(k,"click",j.initMenu,h);r=c(h,"name");if(r)f(r,"click",function(){$BSI.reportEvent("icm",{c:"n"})});k[i](L,"#");k[v]=null}else{l(d(h,a.tileitemid),p.Tile,c(h,s));if(typeof uxp_p!=H)l(d(h,a.tileitemid),p.Tile,c(h,o))}g.Cid_Icid_Map.add(d(h,a.cid),h);j.register(d(h,a.membername),h);l(d(h,a.nameitemid),p.Name,c(h,"name"));l(d(h,a.psmitemid),p.Message,c(h,"psm"))}b.ic_control_data=null};j.initMenu=function(a){var b=q.getIcIdFromAnyParent(a);x.initMenu(b,a);return false}}function kb(){var n=this,g={};n.dispose=function(){I=null;for(var a in g)n.cleanUpMenu(a,1);g=null;jQuery(b).unbind("resize.ic");n=null};function hb(a){return g[a]=function(){var b=c(a,k);if(b&&b.binding&&!b.binding.isOpen())X(a,0);else X(a,2000055)}}function mb(b){var a=c(b,k);if(a&&a.binding)a.binding.update()}var R;function kb(a){clearTimeout(R);R=setTimeout(function(){mb(a)},100)}function Y(a){return function(){O(a,o);O(a,s,1)}}function ab(a){return function(){P(a,o);P(a,s,1)}}n.cleanUpMenu=function(a,d){var b=c(a,k);if(b&&b.binding){if(g[a]){b.binding.removeStateListener(g[a]);if(d)g[a]=null;else delete g[a]}b.binding.dispose()}};function O(e,f,d){var a=c(e,f);if(a){var b=d?S:M;a.alt_temp=a.getAttribute(b);a[i](b,"")}}function P(d,e,b){var a=c(d,e);if(a&&a.alt_temp)a[i](b?S:M,a.alt_temp)}var X=function(d,b){var a=c(d,W);if(a){a[t][l].zIndex=b;a[t][t][l].zIndex=b;a[l].zIndex=b}},jb=function(){var d="c_ic_menus",a=b._ge(d);if(!a){a=A("div");a.id=d;var c=document.body;c.insertBefore(a,c.firstChild)}return a},nb=function(b){var d=q.getIcIdFromAnyParent(b),a=c(d,k);if(a&&a.binding)a.binding.toggleState();h.stopEventAction(b);return false},Q="ntICTemConvICTemplate",gb=Q[p];n.initMenu=function(e,w){if(!c(e,k)&&r()[e]){var h=c(e,s);h[l].outline=E;var n=F.initMenu;C(h,"focus",n,e);C(h,"mouseover",n,e);C(h,"click",n,e);var o=Y(e);o();f(h,"mouseout",ab(e),e);f(h,"mouseover",o,e);f(h,v,nb,e);h[i](L,"#");var g,p;g=A("ul");g.className=db+" c_m t_hovl";sutra(g,m+"ICMenu");g[i](T,j([e,"_",k]));p=ib(e,g);if(d(e,a.attachmenutobody)=="1")jb()[u](g);else h[t][u](g);if(g.id.substring(0,gb)==Q&&!lb)g[l].position="fixed";var q={offset:{x:0,y:5},nofocus:1,hoverDelay:Z,menuEl:g};$menu.create(w,0,q);g.binding.addStateListener(hb(e));F.addMenuBindingRef(r()[e][a.childicid],g.binding);jQuery(b).bind("resize.ic",function(){kb(e)})}};var y={Mail:"1,0,30,31,",IM:"32,0,30,31,",Video:"32,0,30,31,",Audio:"32,0,30,31,"},ib=function(c,M){var x,O,h,v,q,s,i,J,Q,k,r,o,f,u,l,F,D,g,P,N,L,t;if(typeof ic_menu_data!=H){x=d(c,a.menudefault)||[];O=d(c,a.cid);k=d(c,a.address);D=d(c,a.deccid);r=d(c,a.contactid);u=d(c,a.membername);_s_c_ic_menu_glyph="c_ic_menu_glyph";o=d(c,a.name);_presence=e.presence;var E=$Config;_isSelf=E&&D==E.cid;for(var A=0;A<x[p];++A){l=x[A];v=ic_menu_data[l];if(!v)continue;f=v[I.text];F=G("ru");q=s=h=_bsi=_alt=_class=_sutra=_img="";i=L=false;g=G("dmtrgt");t=_presence&&_presence.isAvailableForIC(c,l);var n=N=d(c,a.actiontypeurloverride);n=!n||!n[l]?v[I.url]:n[l];try{switch(l){case "ep":_bsi="Profile";h=j([c,"_menu_ep"]);q=n;o=o||"";f=z(o,f);_sutra=m+"ICMenuEditProfile";g="_blank";if(!_isSelf)i=true;break;case "cd":_bsi="CDMenu";h=j([c,"_menu_cd"]);var C=r&&r!=""&&r!=eb,B=true;if(C){q=n[w]("$contactid$",r);_alt=f;f=z(o,k||f)}else{q=null;f=z(o,k);B=k||_presence&&_presence.isAvailableForIC(c,"si")}_sutra=m+"ICMenuContactDetails";g="_blank";if(!C&&!k&&!o||_isSelf||!B)i=true;break;case "se":_bsi="Email";h=j([c,"_menu_se"]);q=n[w]("$address$",k)[w]("$ru$",encodeURIComponent(F));_alt=f[w]("{address}",k);_class=_s_c_ic_menu_glyph;_img=y.Mail;_sutra=m+"ICMenuSendEmail";if(b.wLive&&b.wLive.Hotmail)g=null;else g="_blank";i=!k;break;case "si":_bsi="IM";h=j([c,"_menu_si"]);_alt=f;_class=_s_c_ic_menu_glyph;s=K("sendim",{icid:c,membername:u});_img=y.IM;_sutra=m+"ICMenuStartIM";g=null;if(!t||_isSelf)i=true;break;case "vc":_bsi="Video";h=j([c,"_menu_vc"]);_alt=f;_class=_s_c_ic_menu_glyph;s=K("videocall",{icid:c,membername:u});_img=y.Video;_sutra=m+"ICMenuVideoCall";g=null;if(!t||_isSelf)i=true;break;case "ac":_bsi="Voice";h=j([c,"_menu_ac"]);_alt=f;_class=_s_c_ic_menu_glyph;s=K("audiocall",{icid:c,membername:u});_img=y.Audio;_sutra=m+"ICMenuAudioCall";g=null;if(!t||_isSelf)i=true}}catch(R){q="";l=""}ob(M,null,h,f,q,s,l,i,g,c,_bsi,_alt,_class,_sutra,_img)}}return J};function K(b,a){switch(b){case "sendim":return function(){N(a.icid);setTimeout(function(){if(e.presence)e.presence.startIM(a.membername,false)},0);return false};case "videocall":return function(){N(a.icid);setTimeout(function(){if(e.presence)e.presence.startVideoCall(a.membername)},0);return false};case "audiocall":return function(){N(a.icid);setTimeout(function(){if(e.presence)e.presence.startAudioCall(a.membername)},0);return false}}}function N(b){var a=c(b,k);if(a)a.binding.hide()}var fb;n.HideSeparatorIfLastVis=fb=function(a){if(a.nextSibling==null)a.previousSibling[l][J]=E};var z=function(c,a){var b;if(c||a)b='<div class="c_ic_menu_name">'+c+"</div>"+'<div class="c_ic_menu_sub">'+a+"</div>";return b},B={},x=function(c,b,a){U.toggle(c,a-B[b]);B[b]=a},bb=function(b,d,a){B[a]=1;var c=jQuery(d);c.hover(function(){x(b,a,2)},function(){x(b,a,1)});c.mousedown(function(){x(b,a,3)});c.mouseup(function(){x(b,a,1)})},ob=function(k,j,h,q,c,d,y,w,n,x,s,r,o,p,t){var b,a,g,m,e;if(d&&!c){c="#";g="return false;"}if(q){b=A("li");m=c||d?"a":"span";a=A(m);if(h)b[i](T,h);if(o)b[cb]=o;if(c){a[i](L,c);if(g)a[i](v,g);if(n)a[i]("target",n)}if(r)a[i](M,r);if(s)f(a,v,function(){$BSI.reportEvent("SelectClick.IC.Nav",{IdentityControlNav:s})});if(d)f(a,v,d,x);if(t){e=U.CreateFromConfig(V,t,$Config.imgsBase);a[u](e);bb(e,a,h)}else a[D]=q;if(w)b[l][J]=E;b[u](a);if(p)sutra(b,p);if(j)k.insertBefore(b,j);else k[u](b)}return b}}setTimeout(mb,0)})();(function(){var a=window;a.$Flextag=new function(){var b=this;b.load=function(){if(!(a["$Config"]&&$Config.flextag&&$Config.flextag.url))return;setTimeout(function(){var b="flextagFrame",c=document.getElementById(b),d=$Config.flextag.url+"?v="+(new Date).getTime();if(!c){var a=document.createElement("IFRAME");a.id=a.name=b;a.width=a.height=0;a.style.display="none";a.scrolling="no";a.frameBorder="0";a.allowTransparency=true;a.src=d;document.body.appendChild(a)}else c.src=d},2e3)}}})();(function(){var e=window,b=e.jQuery,d=e.wLive;d.Animations={};var f=d.Animations,c=null;if(b.Deferred)c=b.Deferred().resolve();function a(a){return function(d){if(!a)b(d).addClass("NoDisplay");else{b(d).removeClass("NoDisplay");b(d).toggle(a)}return c}}b.extend(f,{Direction:{Horizontal:0,Vertical:0},Enabled:false,expand:a(true),collapse:a(false),fadeIn:a(true),fadeOut:a(false),addToList:a(true),deleteFromList:a(false),addToSearchList:a(true),deleteFromSearchList:a(false),showEdgeUI:a(true),showPanel:a(true),hideEdgeUI:a(false),hidePanel:a(false),showPopup:a(true),hidePopup:a(false),enterContent:a(true),exitContent:a(false),flyAway:function(){return c},reveal:a(true),hide:a(false)})})()