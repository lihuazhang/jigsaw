/* Copyright (C) 2012 Microsoft Corporation */registerNamespace("$UI");$UI.Dialog=function(v,e,F,m,D,u){var y=window;if(D)y=D;var f=y.document||y.ownerDocument,s=f.body,n=f.documentElement,w=$B.RE_WebKit?s:f.documentElement,z=s.className.indexOf("rtl")>-1,g,r,b=this,d=jQuery(),h=jQuery(),a=null,i=null,l=jQuery(),o=null,k,p,H,A,j=null,c,G;this.dock=new $UI.Dialog.Rect(0,0,0,0);if(e&&e<5)e=5;m=m?" "+m:"";function q(){if(g){var b=g.style,a=$B.IE&&$B.V==7?r.offsetLeft/100:1;if(a==0)a=1;if($B.IE&&$B.V==6){b.width=w.scrollWidth-3+"px";b.pixelTop=Math.max(0,w.scrollTop/a)}b.pixelHeight=n.clientHeight/a;b.pixelWidth=n.clientWidth/a}}function x(c){var b;if(c.target==k)b=$UI.Dialog.findFocusableElement(a,p,false);else b=$UI.Dialog.findFocusableElement(a,k,true);if(b)setTimeout(function(){try{b.focus()}catch(a){}},0)}this.dispose=function(){G=true;if(j){clearTimeout(j);j=null}d.remove();d=jQuery();h.remove();h=jQuery();c=null;g=null;r=null;k=null;p=null;jQuery(window).unbind(".ext",t)};this.setContents=function(j){d.remove();d=jQuery();a=j;var h=a.parentNode;if(null==h||null==h.tagName){s.appendChild(a);d=d.add(jQuery(a))}var g=$B.RE_WebKit?"input":"a";k=f.createElement(g);p=f.createElement(g);var b=jQuery(k).attr("href","#").css("position","absolute"),c=jQuery(p).attr("href","#").css("position","absolute");if(u===undefined||u){b.bind("focus",x);c.bind("focus",x)}d=d.add(b);d=d.add(c);jQuery(a).prepend(b).append(c);if($B.RE_WebKit){var e="-10000px";if(z)p.style.right=k.style.right=e;else p.style.left=k.style.left=e}a.style.position="absolute";a.className+=m;if(!v&&$B.IE&&$B.V<7){i=new $UI.FramePopup;o=new $UI.FramePopup}l=jQuery(f.createElement("div")).css("position","absolute").addClass("UI_Dialog_Shadow"+m).appendTo(jQuery(a).parent());d=d.add(l);E();return a};this.recalc=function(k){if(!a)return;q();var f=jQuery(a);if(!F){var c=$UI.Dialog.getLocation(a);if(!c||c.isEmpty()){var j={visibility:f.css("visibility")||"visible",display:f.css("display")||"auto"};f.css({visibility:"hidden",display:"block"});c=$UI.Dialog.getLocation(a);f.css({visibility:j.visibility,display:j.display})}if(!b.dock)b.dock=new $UI.Dialog.Rect(0,0,0,0);var h=n.clientWidth/2-c.width/2;if(z){b.dock.x=Math.min(h,0-(c.width-n.clientWidth)-25);if($B.RE_WebKit)b.dock.x+=w.scrollWidth-n.clientWidth}else b.dock.x=Math.max(h,25);if(k){var g=n.clientHeight-c.height-3;b.dock.y=w.scrollTop+Math.min(Math.max(g>200?g:(n.clientHeight-c.height)/2,0),100)}b.dock.height=c.height;b.dock.width=c.width}var d=null;if(b.dock.y!==null)d={top:b.dock.y};if(b.dock.x!==null){d=d||{};d.left=b.dock.x}if(d)f.css(d);if(i)i.positionAt(b.dock,e?1e3:e-2);C(true)};function C(g){var d=jQuery(a).height(),f=jQuery(a).width();if(d!=A||g){var c=new $UI.Dialog.Rect;c.width=f+2;c.height=d+2;c.x=b.dock.x+(z?-3:3);c.y=b.dock.y+3;l.css({width:c.width+"px",height:c.height+"px",left:c.x+"px",top:c.y+"px"});if(i)o.positionAt(c,e?1e3:e-2);A=d}if(j){clearTimeout(j);j=null}j=setTimeout(C,25)}this.show=function(j,k){l.css({backgroundColor:"#000",opacity:.3});b.recalc(true);var i=jQuery(a);i.show();if(e){l.css("z-index",e-1);i.css("z-index",e)}if(v){g=f.createElement("div");B();r=f.createElement("div");var o=jQuery(r).addClass("UI_Dialog_ZoomTest"+m),c=function(a){a.stopImmediatePropagation();return false},d=jQuery(g).attr("id","UI_Dialog_BG").addClass("UI_Dialog_BG"+m).bind({click:c,mousedown:c,keydown:c,keypress:c,dblclick:c});if(u===undefined||u)d.bind("focus",x);if(e)d.css("z-index",e-1);d.width(jQuery(window).width()).height(jQuery(window).height());s.appendChild(g);s.appendChild(r);jQuery(window).bind({resize:function(){setTimeout(q,0)},focus:c});h=h.add(d);h=h.add(o);q()}function n(){try{(j?j:$UI.Dialog.findFocusableElement(a)).focus()}catch(b){}}if(!k)setTimeout(n,10)};this.hide=function(){h.remove();h=jQuery();if($B.IE&&$B.V<7)if(c){for(var a=0;a<c.length;a++)if(typeof c[a].wlppHide!="undefined")c[a].style.visibility=c[a].wlppHide;c=null}};this.minimize=function(){l.hide();if(i)i.minimize();if(o)o.minimize();a.style.visibility="hidden";if(v){g.style.display="none";if(c)for(var b=0;b<c.length;b++)c[b].style.visibility=c[b].wlppHide;q()}};this.restore=function(){l.show();a.style.visibility="visible";if(i)i.restore();if(o)o.restore();b.recalc(true);if(v){g.style.display="block";B();q()}};function E(){jQuery(window).bind({"resize.ext":t,"scroll.ext":t})}function t(){jQuery(window).unbind(".ext",t);b.recalc(false);E()}function B(){if($B.IE&&$B.V<7){c=f.getElementsByTagName("select");var e=a.getElementsByTagName("select");for(var b=0;b<c.length;b++){var g=false;for(var d=0;d<e.length;d++)if(c[b]==e[d]){g=true;break}if(!g){c[b].wlppHide=c[b].style.visibility;c[b].style.visibility="hidden"}}}}};$UI.Dialog.Rect=function(c,d,b,a){return new function(){var e=this;this.x=c;this.y=d;this.width=b;this.height=a;this.isEmpty=function(){return e.width<=0||e.height<=0}}};$UI.Dialog.findFocusableElement=function(b,a,c){function g(a){$el=jQuery(a);var c=$el.attr("tabindex");if(c==="-1")return false;if($el.is(".CloseX")&&$el.is(":visible")&&$el.parents(":hidden").length===0)return true;var b="|BUTTON|TEXTAREA|FIELDSET|IFRAME|SELECT|";return a.tagName&&!a.disabled&&(b.indexOf("|"+a.tagName+"|")>-1||a.tagName=="A"&&a.href&&a.className.indexOf("CloseX")==-1||a.tagName=="INPUT"&&a.type.toLowerCase()!="hidden"&&(!$B.Firefox||a.type.toLowerCase()!="file"))&&jQuery(a).is(":visible")}function d(b){if(!b)return null;var a=c?b.nextSibling:b.previousSibling;while(a&&a.nodeType!=1)a=c?a.nextSibling:a.previousSibling;if(!a)return d(b.parentNode);else return a}function f(b,e){var a=e;if(a&&(a==b||jQuery.contains(b,a)))while(a!=null)if(!g(a))if(c&&a.firstChild)a=a.firstChild;else if(!c&&a.lastChild)a=a.lastChild;else a=d(a);else return a;return null}if(a)a=d(a);else a=b;var e=f(b,a);if(!e&&a&&a!=b)return f(b,b);else return e};$UI.Dialog.getLocation=function(b){if(!b)return new $UI.Dialog.Rect(0,0,0,0);var c=0,d=0,a=b;while(a){c+=a.offsetLeft;d+=a.offsetTop;a=a.offsetParent}return new $UI.Dialog.Rect(c,d,b.offsetWidth,b.offsetHeight)};$UI.Popover=function(){this.header=null;this.body=null;this.footerText=null;this.width=300;this.bodyPadding=true;this.showHeader=true;this.showFooter=true;this.modal=false;this.showCloseX=false;this.zIndex=null;this.dispose=function(){if(b){b.dispose();b=null}};this.addButton=function(e,c,a,b){d.push({name:e,value:c,isDefault:a,isCancel:b})};this.show=function(z,y,q,w){if(e)return;s=z;r=y;if(!b){b=new $UI.Dialog(a.modal,a.zIndex);c=_ce("div");var u=jQuery(c).hide().html('<a href="#"></a><div><h3></h3></div><div></div><div><nobr></nobr></div>');b.setContents(c);t();u.addClass("UI_Popover");var m=c.childNodes;h=m[1];j=m[2];k=m[3];i=m[4];p=j.firstChild;n=i.firstChild;jQuery(h).addClass("CloseX");jQuery(j).addClass("Header");jQuery(k).addClass("Body");jQuery(i).addClass("Footer");if(a.width!=null){var o=a.width;u.css("width",parseInt(o,10)==o?o+"px":o)}f=null;g=[];for(var l=0;l<d.length;l++)v(d[l].name,d[l].value,d[l].isDefault,d[l].isCancel);if(d.length==0)a.showFooter=false;x()}b.show(q?g[q]:null,w);e=true};this.hide=function(){if(!e)return;if(r)setTimeout(w,10);try{jQuery(h).unbind("click");l.unbind(".showhide",o);l=jQuery();m.remove();m=jQuery();b.hide();this.dispose()}catch(a){}e=false;c=h=j=i=k=p=n=g=null};this.enableButton=function(a){jQuery(g[a]).attr("disabled",false)};this.disableButton=function(a){jQuery(g[a]).attr("disabled",true)};function w(){try{r.focus()}catch(a){}}function t(){var b=a.modal?$B.IE?jQuery("body"):jQuery(window):jQuery(c);if($B.IE)b.bind("keypress.showhide",o);else b.bind("keydown.showhide",o);l=l.add(b)}function u(){var b=a.modal?$B.IE?jQuery("body"):jQuery(window):jQuery(c);b.unbind(".showhide",o)}function v(a,h,b,e){jQuery("<span />").text(" ").appendTo(jQuery(n));var d=_ce("div");jQuery(d).html('<button id="popover_btn_{0}" type="{1}" />'.format(a,b?"submit":"button"));var c=jQuery(d.firstChild).toggleClass("Default",b).html("<nobr>"+h+"</nobr>").bind("click",function(b){q(a);b.stopPropagation()});m=m.add(jQuery(c));if(!b&&e)f=a;g[a]=c;jQuery(c).appendTo(jQuery(n))}function o(a){switch(a.which){case 27:q(f?f:"$cancel");a.stopPropagation()}}function q(c){var b=true;if(s)b=s(a,c);if(b)a.hide()}function x(){function b(a,c){if(a){var b=jQuery(c);if(typeof a=="string")b.html(a);else b.html("").append(a)}}jQuery(j).toggle(a.showHeader);jQuery(i).toggle(a.showFooter);jQuery(h).toggle(a.showCloseX).bind("click",function(){q(f?f:"$cancel");return false});if(a.showCloseX){var c=GetString("live.shared.skydrive.pc.Sharing.Close");jQuery(h).append(wLive.Core.ImageStrip.getImage("close",c,c))}if(!a.bodyPadding)jQuery(k).css("padding","0px");b(a.header,p);b(a.body,k)}this.recalc=function(){if(!e)return;if(b)b.recalc(false)};this.minimize=function(){if(!b||!e)return;b.minimize();u()};this.restore=function(){if(!b||!e)return;b.restore();t()};var e=false,b,a=this,j,k,i,h,p,n,f,g,m=jQuery(),l=jQuery(),c,d=[],s=null,r=null};$UI.MsgBoxEx=function(p,l,i,f,q,g,h,j,n){var c="ok",b="cancel",a=new $UI.Popover,k=_ce("div"),o=function(f,e){var d=true;if(e==c){if(q({Popover:f})==false)d=false}else if(e==b&&!!g)g();if(d)a=null;return d};if(h){var d=temp=h;for(var m=0;m<10&&temp;m++){var e=temp.tagName&&temp.tagName.toLowerCase();if(e=="a"||e=="button"||e=="input"){d=temp;break}temp=temp.parentElement;if(!temp){d=null;break}}}if(l)k.innerHTML='<div style="margin-bottom:10px">'+l+"</div>";a.width=j?j:"416px";a.header=p;a.body=k;a.modal=true;if(i!=false)a.addButton(c,i,true,false);if(f!=false)a.addButton(b,f,false,true);a.show(o,d,n?b:c);return a};$UI.MsgBox=function(d,e,c,a,b,f){$UI.MsgBoxEx(d,e,c,a,f,null,b,null,false)};var __LICENSETERMS__='jQuery Observable Subcomponent of JsViews Data change events for data linking See: http://github.com/BorisMoore/jsviews Microsoft grants you the right to use these script files for the sole purpose of either: (i) interacting through your browser with the Microsoft website, subject to the websiteï¿½s terms of use; or (ii) using the files as bundled with a Microsoft product subject to that productï¿½s license terms. Microsoft reserves all other rights to the files not expressly granted by Microsoft, whether by implication, estoppel or otherwise. The notices and licenses below are for informational purposes only. Copyright (c) Boris Moore and Brad Olenick Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.';(function(a,f){a.observable=function(b){return a.isArray(b)?new d(b):new c(b)};var g=[].splice;function c(a){if(!this.data)return new c(a);this._data=a;return this}a.observable.Object=c;c.prototype={_data:null,data:function(){return this._data},setProperty:function(b,e){if(a.isArray(b))for(var g=0,l=b.length;g<l;g++){var i=b[g];this.setProperty(i.name,i.value)}else if(typeof b==="object")for(var j in b)this.setProperty(j,b[j]);else{var f,d,k=this._data,c=h(k,b);b=c[1];c=c[0];if(c){d=c[b];if(a.isFunction(d)){f=d;d=d.call(c)}if(d!=e){if(f){f.call(c,e);e=f.call(c)}else c[b]=e;a(c).triggerHandler("propertyChange",{path:b,value:e,oldValue:d})}}}return this}};function h(a,b){if(a&&b){var c=b.split(".");b=c.pop();while(a&&c.length)a=a[c.shift()];return [a,b]}return []}function d(a){if(!this.data)return new d(a);this._data=a;return this}function b(c,b){a([c]).triggerHandler("arrayChange",b)}function e(a){if(typeof a!=="number")throw"Invalid index.";}a.observable.Array=d;d.prototype={_data:null,data:function(){return this._data},insert:function(d,c){e(d);if(arguments.length>1){c=a.isArray(c)?c:[c];if(c.length>0){g.apply(this._data,[d,0].concat(c));b(this._data,{change:"insert",index:d,items:c})}}return this},remove:function(c,a){e(c);a=a===f||a===null?1:a;if(a&&c>-1){var d=this._data.slice(c,c+a);a=d.length;if(a){this._data.splice(c,a);b(this._data,{change:"remove",index:c,items:d})}}return this},move:function(c,d,a){e(c);e(d);a=a===f||a===null?1:a;if(a){var g=this._data.slice(c,c+a);this._data.splice(c,a);this._data.splice.apply(this._data,[d,0].concat(g));b(this._data,{change:"move",oldIndex:c,index:d,items:g})}return this},refresh:function(a){var c=this._data.slice(0);g.apply(this._data,[0,this._data.length].concat(a));b(this._data,{change:"refresh",oldItems:c});return this}}})(jQuery);var __LICENSETERMS__='JsRender v1.0pre - (jsrender.js version: does not require jQuery): http://github.com/BorisMoore/jsrenderOptimized version of jQuery Templates, fosr rendering to string, using "codeless" markup.Microsoft grants you the right to use these script files for the sole purpose of either: (i) interacting through your browser with the Microsoft website, subject to the websiteï¿½s terms of use; or (ii) using the files as bundled with a Microsoft product subject to that productï¿½s license terms. Microsoft reserves all other rights to the files not expressly granted by Microsoft, whether by implication, estoppel or otherwise. The notices and licenses below are for informational purposes only. Copyright (c) Boris Moore Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.';window.JsViews||window.jQuery&&jQuery.views||function(d,k){var b,u,l,a,i,f,h,s,r,c,g=false,n=true,e=d.jQuery,G=d.document,B=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,m=/^(true|false|null|[\d\.]+)|(\w+|\$(view|data|ctx|(\w+)))([\w\.]*)|((['"])(?:\\\1|.)*\7)$/g,D=/(\$?[\w\.\[\]]+)(?:(\()|\s*(===|!==|==|!=|<|>|<=|>=)\s*|\s*(\=)\s*)?|(\,\s*)|\\?(\')|\\?(\")|(\))|(\s+)/g,C=/\r?\n/g,x=/\\(['"])/g,y=/\\?(['"])/g,z=/\x08([^\x08]+)\x08/g,A=0,q={"&":"&amp;","<":"&lt;",">":"&gt;"},v=/[\x00"&'<>]/g,E=Array.prototype.slice;if(e){b=e;b.fn.extend({render:function(c,b,a,d){return f(c,this[0],b,a,d)},template:function(c,a){return b.template(c,this[0],a)}})}else{u=d.$;d.JsViews=l=d.$=b={extend:function(c,b){var a;for(a in b)c[a]=b[a];return c},isArray:Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"},noConflict:function(){if(d.$===l)d.$=u;return l}}}c=b.extend;function o(e,h,b,g,f){b=b||{viewsCount:0,ctx:a.helpers};var d=b&&b.ctx;return {jsViews:"v1.0pre",path:h||"",itemNumber:++b.viewsCount||1,viewsCount:0,tmpl:f,data:g||b.data||{},ctx:e&&e===d?d:d?c(c({},d),e):e||{},parent:b}}c(b,{views:a={templates:{},tags:{"if":function(){var b=this,a=b._view;a.onElse=function(e,b){var c=0,d=b.length;while(d&&!b[c++])if(c===d)return "";a.onElse=k;return f(a.data,e.tmpl,a.ctx,a)};return a.onElse(this,arguments)},"else":function(){var a=this._view;return a.onElse?a.onElse(this,arguments):""},each:function(){var c,a=this,d="",e=arguments,h=e.length,g=a.tmpl,b=a._view;for(c=0;c<h;c++)d+=e[c]?f(e[c],g,a.ctx||b.ctx,b,a._path,a._ctor):"";return h?d:d+f(b.data,g,b.ctx,b,a._path,a.tag)},"=":function(a){return a},"*":function(a){return a}},helpers:{not:function(a){return !a}},allowCode:g,debugMode:n,err:function(b){return a.debugMode?"<br/><b>Error:</b> <em> "+(b.message||b)+". </em>":'""'},setDelimiters:function(c,b){var a=b.charAt(0),d=b.charAt(1);c="\\"+c.charAt(0)+"\\"+c.charAt(1);b="\\"+a+"\\"+d;h=c+"(?:(?:(\\#)?(\\w+(?=[!\\s\\"+a+"]))"+"|(?:(\\=)|(\\*)))"+"\\s*((?:[^\\"+a+"]|\\"+a+"(?!\\"+d+"))*?)"+"(!(\\w*))?"+"|(?:\\/([\\w\\$\\.\\[\\]]+)))"+b;h=new RegExp(h,"g")},registerTags:s=function(b,d){var c;if(typeof b==="object")for(c in b)s(c,b[c]);else a.tags[b]=d;return this},registerHelpers:r=function(b,d){if(typeof b==="object"){var c;for(c in b)r(c,b[c])}else a.helpers[b]=d;return this},encode:function(b,a){return a?(i[b||"html"]||i.html)(a):""},encoders:i={none:function(a){return a},html:function(a){return String(a).replace(v,w)}},renderTag:function(h,g,l,e,b){var f,d,m,j=arguments,i=a.presenters;hash=b._hash,tagFn=a.tags[h];if(!tagFn)return "";e=e&&g.tmpl.nested[e-1];b.tmpl=b.tmpl||e||k;if(i&&i[h]){d=c(c({},b.ctx),b);delete d.ctx;delete d._path;delete d.tmpl;b.ctx=d;b._ctor=h+(hash?"="+hash.slice(0,-1):"");b=c(c({},tagFn),b);tagFn=a.tags.each}b._encode=l;b._view=g;f=tagFn.apply(b,j.length>5?E.call(j,5):[g.data]);return f||(f===k?"":f.toString())}},render:f=function(c,d,g,e,i,n){var j,l,f,m,k,h="";if(arguments.length===2&&c.jsViews){e=c;g=e.ctx;c=e.data}d=b.template(d);if(!d)return "";if(b.isArray(c)){m=new o(g,i,e,c);l=c.length;for(j=0,l=c.length;j<l;j++){f=c[j];k=f?d(f,new o(g,i,m,f,d,this)):"";h+=a.activeViews?"<!--item-->"+k+"<!--/item-->":k}}else h+=d(c,new o(g,i,e,c,d));return a.activeViews?"<!--tmpl("+(i||"")+") "+(n?"tag="+n:d._name)+"-->"+h+"<!--/tmpl-->":h},template:function(d,c){if(c){if(""+c===c)c=t(c);else if(e&&c instanceof b)c=c[0];if(c){if(e&&c.nodeType)c=b.data(c,"tmpl")||b.data(c,"tmpl",t(c.innerHTML));a.templates[c._name=c._name||d||"_"+A++]=c}return c}return d?""+d!==d?d._name?d:b.template(null,d):a.templates[d]||b.template(null,B.test(d)?d:F(d)):null}});a.setDelimiters("{{","}}");function j(h,e,a,c,b,f,d){return a?(c?b?"$view."+b:a:"$data."+a)+(f||""):d||(e||"")}function t(d){var e,k=0,i=[],f=[],c=f,b=[,,f];function l(a){a-=k;if(a)c.push(d.substr(k,a).replace(C,"\\n"))}function o(C,q,f,A,B,d,w,y,v,t){var r,s="",h=0,p=g,o=g;function u(e,a,k,c,q,i,b,d,f,l){return o?(o=!b,o?e:'"'):p?(p=!d,p?e:'"'):c?a.replace(m,j)+c:q?h?"":(r=n,"\b"+a+":"):k?(h++,a.replace(m,j)+"("):f?(h--,")"):a?a.replace(m,j):i?",":l?h?"":r?(r=g,"\b"):",":(o=b,p=d,'"')}f=f||A;l(t);if(B){if(a.allowCode)c.push(["*",d.replace(x,"$1")])}else if(f){if(f==="else"){b=i.pop();c=b[2];q=n}d=d?(d+" ").replace(D,u).replace(z,function(c,a){s+=a+",";return ""}):"";d=d.slice(0,-1);e=[f,w?y||"none":"",q&&[],"{"+s+"_hash:'"+s+"',_path:'"+d+"'}",d];if(q){i.push(b);b=e}c.push(e)}else if(v)b=i.pop();k=t+C.length;if(!b)throw"Expected block tag";c=b[2]}d=d.replace(y,"\\$1");d.replace(h,o);l(d.length);return p(f)}function p(k){var j,a,b,h=[],m=k.length,d="try{var views="+(e?"jQuery":"JsViews")+'.views,tag=views.renderTag,enc=views.encode,html=views.encoders.html,$ctx=$view && $view.ctx,result=""+\n\n';for(b=0;b<m;b++){a=k[b];if(a[0]==="*")d=d.slice(0,b?-1:-3)+";"+a[1]+(b+1<m?"result+=":"");else if(""+a===a)d+='"'+a+'"+';else{var l=a[0],c=a[1],g=a[2],n=a[3],i=a[4],f=i+'||"")+';if(g)h.push(p(g));d+=l==="="?!c||c==="html"?"html("+f:c==="none"?"("+f:'enc("'+c+'",'+f:'tag("'+l+'",$view,"'+(c||"")+'",'+(g?h.length:'""')+","+n+(i?",":"")+i+")+"}}j=new Function("$data, $view",d.slice(0,-1)+";return result;\n\n}catch(e){return views.err(e);}");j.nested=h;return j}function w(a){return q[a]||(q[a]="&#"+a.charCodeAt(0)+";")}function F(a){try{return b(a)}catch(c){}return a}}(window);var __LICENSETERMS__='JsViews v1.0pre jQuery plugin providing interactive data-driven views, based on integration between jQuery Templates and jQuery Data Link. Requires jquery.render.js (optimized version of jQuery Templates, for rendering to string)     See JsRender at http://github.com/BorisMoore/jsrender and jquery.observable.js.     See JsViews at http://github.com/BorisMoore/jsviews Microsoft grants you the right to use these script files for the sole purpose of either: (i) interacting through your browser with the Microsoft website, subject to the websiteï¿½s terms of use; or (ii) using the files as bundled with a Microsoft product subject to that productï¿½s license terms. Microsoft reserves all other rights to the files not expressly granted by Microsoft, whether by implication, estoppel or otherwise. The notices and licenses below are for informational purposes only. Copyright (c) Boris Moore Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.';(function(a,b){var f=false,e=true,h,c,D,B=a.cleanData,u={value:"val",html:"html",text:"text"},m="_jsvData";function z(p){var w,v,d,x,e,r,h,g,n,j,q=this.target,i=p.target,s=a(i),m=a.view(i),z=this.links,t=m.ctx,y=t.beforeChange,A=z.length;while(A--&&!v){g=z[A];if(!g.filter||g.filter&&s.is(g.filter)){d=g.fromAttr;if(!d){d=c.merge[i.nodeName.toLowerCase()];d=d?d.from.fromAttr:"text"}w=u[d];h=a.isFunction(d)?d(i):w?s[w]():s.attr(d);if((!y||!(v=y.call(m,p)===f))&&h!==b){e=g.to||a.trim(i.getAttribute(c.linkToAttr));if(e){n=g.convert;e=l(e);j=e[0].slice(0,-1);q=m&&m.data||q;j=k(q,m,j);n=e[3];x=a.trim(e[1].slice(0,-1));r={source:i,target:j,convert:n,path:x};if(n)h=o(r,q,m,n,h);if(h!==b&&j){a.observable(j).setProperty(x,h);if(t.afterChange)t.afterChange.call(r,p)}p.stopPropagation()}}if(v)p.stopImmediatePropagation()}}}function x(m,e){var q,i,y,h,b,d,s,k=this,j=k.target,g=a(j),v=m.target,x=e&&e.path||m.path,l=a.view(j),r=l.ctx,t=r.beforeChange,p=n(j,v).paths[x],w=p&&p.length;while(w--){q=p[w];if((!t||!(e&&(y=t.call(this,m,e)===f)))&&(!l||l.onDataChanged(e)!==f)){b=q.attr;d=o(k,k.source,l,q.expr,e&&e.value);if(a.isFunction(d))d=d.call(v);if(!b){b=c.merge[j.nodeName.toLowerCase()];b=b?b.to.toAttr:"text"}if(s=b.indexOf("css-")===0&&b.substr(4)){if(h=g.css(s)!==d)g.css(s,d)}else{i=u[b];if(i){if(h=g[i]()!==d)g[i](d)}else if(h=g.attr(b)!==d)g.attr(b,d)}if(e&&h&&r.afterChange)r.afterChange.call(k,m,e)}}}function y(g,a){var i,d=this.ctx,e=d.beforeChange,h=a?a.change:c.linkToAttr;if((!e||!(i=e.call(this,g,a)===f))&&h!==b){this.onDataChanged(a);if(d.afterChange)d.afterChange.call(this,g,a)}}function j(d){var e,c=d.data,b=d._onArrayChange;if(b){if(b[1]===c)return;a([b[1]]).unbind("arrayChange",b[0])}if(a.isArray(c)){e=function(){y.apply(d,arguments)};a([c]).bind("arrayChange",e);d._onArrayChange=[e,c]}}function t(d,c,f){var b=d.parent&&d.parent.ctx,e=d._ctx;d.ctx=f?e&&b?a.extend({},b,e):b||e:c&&c!==b?(d._ctx=c,b?a.extend({},b,c):c):b}function i(l,n,o,i,d,u,e){var h,g,s,m,r,f,q,b=this;a.extend(b,{views:[],nodes:n?[]:[document.body],tmpl:i||d&&d.tmpl,path:o,parent:d,prevNode:n,parentElem:n&&n.parentNode});if(d){h=d.views;u.push(b);e=e||d.data;if(a.isArray(d.data)){b.index=g=o;h.splice(g,0,b);s=h.length;e=e[g];while(g++<s-1)a.observable(h[g]).setProperty("index",g);b.tag=d.tag}else{if(o){e=p(e,d,o);l=l||e[1];e=e[0]}b.index=h.length;h.push(b);if(l.tag)b.tag=[l.tag];else{i=i.split("=");if(i.shift()==="tag")b.tag=i}}}b.data=e;t(b,l);j(b);if((m=b.tag)&&!a.isArray(e)){f=c.tags[m[0]];if(f&&f.presenter){r=f.ctx||{};q=m[1]?k(d.data,d,"{"+m[1]+"}"):d.ctx;a.extend(q,f.options||{});r[m[0]]=new f.presenter(q,b);b.context(r)}}}function g(f,q,p,A,m,k,y,s){var l,n,j,x,w,E,D,C,B,z,t,h=q,o=A;k=k||{};s=s||0;f=y||f;if(!y&&f.nodeType===1){if(o++===0)h.nodes.push(f);var u=f.getAttribute(c.linkFromAttr),v=f.getAttribute(c.getFromAttr);if(u||v)r(m||q.data,f,v,u,e);f=f.firstChild}else f=f.nextSibling;while(f&&f!==p){if(f.nodeType===1)g(f,h,p,o,m,k);else if(f.nodeType===8&&(l=/^(\/?)(?:(item)|(?:(tmpl)(?:\((.*)\))?(?:\s+([^\s]+))?))$/.exec(f.nodeValue))){w=f.parentNode;if(l[1]){h.nextNode=f;if((z=h.tag)&&(t=h.ctx[z[0]])&&t.onAfterCreate)t.onAfterCreate();if(h.ctx.onAfterCreate)h.ctx.onAfterCreate.call(h,h);if(l[2])h=q;else return f}else{n=n||d(w,"view",e);if(l[2])h=new i(k,f,s++,b,h,n);else{j=a.view(f);if(j&&j.prevNode===f)if(j.data===m)x=j.nextNode;else{j.data=m;j.render(k);return j.nextNode}else j=new i(k,f,l[4],l[5],h,n,m);f=x||g(f,j,p,0)}}}else if(o===0)h.nodes.push(f);f=f.nextSibling}}function p(d,b,c){return Function("$","$data","$view","$ctx","with($data){return ["+c+"];}")(a,d,b,b.ctx)}function o(d,e,b,c,f){try{return Function("$","$data","$view","$ctx","$value","with($data){return "+c+";}").call(d,a,e,b,b.ctx,f)}catch(g){throw g.message;}}function k(c,d,b){try{return b?Function("$","$data","$view","$ctx","with($data){return "+b+";}")(a,c,d,d.ctx):c}catch(e){throw e.message;}}function w(l,m,f,o){var c,k,n,h,j,i,e;if(f){f=a.isArray(f)?f:[f];h=[];j=[];e=f.length;while(e--){c=f[e];if(c.to)h.push({to:c.to,filter:c.filter});if(c.from||c.getFrom)j.push(c)}e=j.length;while(e--){c=j[e];k=c.filter;n=k?l.find(k).add(a(this).filter(k)):l;n.each(function(){r(m,this,c.getFrom,c.from)})}}if(!f||h.length)l.each(function(){if(!f){i=d(this,"to");e=i.length;while(e--){c=i[e];if(c.links===declLinkTo){if(c.target===m)return;q(this,declLinkTo);i.splice(e,1)}}h=declLinkTo;g(this,a.view(this),b,b,m,o)}A(this,m,h)});return l}function r(q,x,u,n){var b,d,h,g,j,r,i,B,p,f,A,m=[],c="";n=l((n?n+",":"")+(u?"|,"+u+",":""),e);while(b=n.shift()){g=b.length;j=b.charAt(g-1);b=b.slice(0,-1);switch(j){case ":":r=a.trim(b);break;case "[":c=a.trim(b);break;case ")":c=c||b;break;case "]":m=[[c,b]];c=c?c+"."+b:b;c+=a.isFunction(q[b])?"()":"";break;case "\r":i=++b;break;case ",":if(b==="|")B=e;else{if(i){f=c.slice(i);f=l(f);for(h=0,g=f.length;h<g;h++){d=a.trim(f[h]);j=d.charAt(d.length-1);d=d.slice(0,-1);if(j==="[")f[h]=p=d;else if(j==="]"){m.push([p,d]);f[h]=p?"."+d:d;f[h]+=a.isFunction(q[d])?"()":"";p=""}}c=c.slice(0,i)+f.join("")+")"}c+=b;A=a.view(x);g=m.length;while(g--){var v=m[g],z=v[1],w=k(q,A,v[0]),y={source:q,target:x},t=z.split("."),o=w;while(t.length>1){o=o[t.shift()];if(o)s(o,y,t.join("."),c,r)}s(w,y,z,c,r,!g&&B)}i=0;m=[];r=c=""}}}}function s(f,l,g,o,m,p){var i,j,b,h=l.target,c=n(h,f),k={attr:m,expr:o};if(c){j=c.paths[g]=c.paths[g]||[];j.push(k);b=c.handler}else{b=function(){x.apply(l,arguments)};if(h){i={};i[g]=[k];d(h,"from",e).push({source:f,paths:i,handler:b})}a(f).bind("propertyChange",b)}if(p)b({target:f,path:g})}function A(c,f,g){var b=function(){z.apply({target:f,links:g},arguments)};d(c,"to",e).push({target:f,links:g,handler:b});a(c).bind("change",b)}function q(f,g){var c,b=d(f,"to"),e=b.length;while(e--){c=b[e];if(c.links===g){a(f).unbind("change",c.handler);b.splice(e,1)}}}function n(f,e){var a,b=d(f,"from"),c=b.length;while(c--){a=b[c];if(a.source===e)return a}}function v(g){var h,e,b,f,d,i,c=a.cache[g[a.expando]];c=c&&c.data;linksAndViews=c&&c[m];if(linksAndViews){if(linksAndViews.to.length)a(g).unbind("change");e=linksAndViews.from;b=e.length;while(b--){h=e[b];a(h.source).unbind("propertyChange",h.handler)}f=linksAndViews.view;if(b=f.length){d=a.view(g);while(b--){i=f[b];if(i.parent===d)d.removeViews(i.index,1)}}}}function d(c,e,d){var b=a.data(c,m)||d&&a.data(c,m,{view:[],from:[],to:[]});return b?b[e]:[]}function l(a,h){var c,d=0,b=0,g=f,e=f;a=a.replace(/\s+/g," ");return a.replace(/(\))|([\:\,])|(\')|(\")|([\(\[\{])|([\}\]])/g,function(f,o,n,j,k,m,l,i){if(e){e=!j;return f}if(g){g=!k;return f}if(o)return --b?f:h&&a.charAt(i+1)===","?(c-=d,d=i,f+"\t"+c+"\r\t"):f;if(n)return b?f:(d=i+1,f+"\t");if(m){if(b++)return f;if(f==="(")c=i;return f!=="["?f:"[\t"}if(l)return --b||f!=="]"?f:"]\t";e=j;g=k;return f}).split("\t")}function C(b){return b.type==="checkbox"?b.checked:a(b).val()}a.extend({view:function(b,o){var c,f,g,k,j,m=/^item|^tmpl(\(\$?[\w\.\(\)\$,\"\']*\))?(\s+[^\s]+)?$/,l=document.body,n=b;if(o){j=b.nextSibling||b.parentNode;while(j!==(b=b.firstChild||b.nextSibling||b.parentNode.nextSibling))if(b.nodeType===8&&m.test(b.nodeValue)){f=a.view(b);if(f.prevNode===b)return f}return}b=b||l;if(h&&!h.views.length)c=h;else{while(!(g=d(j=b.parentNode||l,"view")).length){if(!j||b===l){d(l.parentNode,"view",e).push(c=h=new i);h.ctx={};break}b=j}if(!c&&b===l)c=g[0];while(!c&&b){if(b.nodeType===8)if(/^\/item|^\/tmpl$/.test(b.nodeValue)){k=g.length;while(k--){f=g[k];if(f.nextNode===b){c=b===n&&f;b=f.prevNode;break}}}else if(m.test(b.nodeValue)){k=g.length;while(k--){f=g[k];if(f.prevNode===b){c=f;break}}}b=b.previousSibling}c=c||a.view(j)}return c},cleanData:function(b){var c=b.length;while(c--)v(b[c]);B.call(a,b)}});c=a.views=a.views||{};a.extend(c,{presenters:{},activeViews:true,getProperty:function(c,b){return a.isFunction(b)?b.call(c):b},linkToAttr:"data-to",linkFromAttr:"data-from",getFromAttr:"data-getfrom",merge:{input:{from:{fromAttr:C},to:{toAttr:"value"}}},registerPresenters:registerPresenters=function(e,d){var g,f;if(typeof e==="object")for(g in e)registerPresenters(g,e[g]);else{d.ctx=d.ctx||{};f=(f=d.tag)===b?e:f;if(f){d.tag=f;c.tags[f]=d}plugin=(plugin=d.plugin)===b?e:plugin;if(plugin){a.fn[plugin]=a.fn[plugin]||function(b,a){return this.link(b,d,a)};d.plugin=plugin}c.presenters[e]=d}return this},view:{onDataChanged:function(a){if(a){var b=this,f=a.change,c=a.index,d=a.items;switch(f){case "insert":b.addViews(c,d);break;case "remove":b.removeViews(c,d.length);break;case "move":b.render();break;case "refresh":b.render()}}return e},render:function(){var c=this.prevNode,e=this.nextNode,d=c.parentNode;a(this.nodes).remove();this.removeViews(0,this.views.length);this.nodes=[];a(c).after(a.render(this.data,this.tmpl,this.ctx));d.removeChild(c.nextSibling);d.removeChild(e.previousSibling);g(d,this,e,0,b,b,c,0);j(this);return this},addViews:function(d,i,o){var h,m=i.length,k=this.ctx,l=this.views;if(d&&!l[d-1])return;if(m){if(this.path){h=this.parent;k=p(h.data,h,this.path)[1]}var n=a.render(i,o||this.tmpl,k,this,e),c=d?l[d-1].nextNode:this.prevNode,j=c.nextSibling,f=c.parentNode;a(c).after(n);f.removeChild(c.nextSibling);f.removeChild(j.previousSibling);g(f,this,j,0,b,b,c,d)}return this},removeViews:function(f,l,n){if(l){var h,k,m,i=this.views,o=f+l;while(o-->f){var c=i[o],g=c.views.length,e=c.prevNode,q=c.nextNode,p=[e];if(g)c.removeViews(0,g,n);h=h||d(c.parentElem,"view");g=h.length;while(g--&&k===b)if(h[g]===c)k=g;h.splice(k,1);if(!n){while(e&&e.parentNode&&e!==q){e=e.nextSibling;p.push(e)}a(p).remove()}c.data=b;j(c)}i.splice(f,l);m=i.length;while(f<m)a.observable(i[f]).setProperty("index",f++)}return this},context:function(c){var a=this,d=a.parent,e=d?d.ctx:{};if(!c)a.each(function(a){a.ctx=e;a._ctx=b});else if(c!==a.ctx)a.each(function(b){t(b,c,b!==a)});return this},each:function(a){a(this);var b=this.views.length;while(b--)this.views[b].each(a);return this},content:function(b){return b?a(b,this.nodes):a(this.nodes)}}});a.fn.extend({view:function(b){return a.view(this[0],b)},addLinks:function(c,b,a){return w(this,c,b,a)},link:function(e,c,d){if(!this.length)return this;if(c){c=c.tag&&c===a.views.tags[c.tag]?(d.tag=c.tag,d.tmpl||c.tmpl):a.isPlainObject(c)?(d=c,f):c;if(c&&(c=a.template(c))){q(this[0],declLinkTo);v(this[0]);this.empty();if(e)this.append(a.render(e,c,d))}}return w(this,e,b,d)}});i.prototype=c.view;D=c.decl;declLinkTo=[{filter:"input["+c.linkToAttr+"]"}]})(jQuery);(function(){"use strict";var b=window.jQuery,c=wLive.Controls.Notifications=wLive.Controls.Notifications||{},a=new function(){var a=this,c={},d=[];a.showDelay=600;a.start=function(){if(d){var b=d,c=b.length;d=null;for(var a=0;a<c;a++)b[a]()}};a.addNotification=function(e,f,b){if(d)d.push(function(){a.addNotification(e,f,b);a.showNextNotification(b.queueGroup)});else{var g=b.queueGroup||"default",i=b.queueMode||"fifo",h=c[g]=c[g]||{current:null,items:[]};h.items.push({mode:i,notification:e,callback:f})}};a.showNextNotification=function(f){var b=c[f],a,d,e=function(d){var a,f=d.length,b={mode:null,item:null},c,e;for(a=0;a<f;a++){c=d[a];e=b.mode=c.mode;b.item=c;if(e==="fifo")break}return b.item};if(b&&b.items.length>0){a=b.current;d=b.items;if(a&&a.mode==="filo"&&b.items.length>1){a.notification.hide();a=null}if(!a){a=b.current=e(d);a.callback()}}};a.removeNotification=function(d){b.each(c,function(g,e){var c=e.items,f=false;for(var b=c.length-1;b>=0;b--)if(c[b].notification===d){if(c[b]===e.current)e.current=null;c.splice(b,1);f=true;break}if(f)setTimeout(function(){a.showNextNotification(g)},a.showDelay)})};a.reset=function(){b.each(c,function(e,d){var b=d.items,c;for(var a=b.length-1;a>=0;a--){c=b[a];if(c===d.current)c.notification.dismiss();else b.splice(a,1)}})};a.registerSearchApi=function(e,d){a[e]=function(g){var l=[],a,j,h,i,k,e,f;g=g||function(){return true};if(!d||d.length===0)a=c;else a=b.map(d,function(a){return c[a]});j=a.length;for(e=0;e<j;e++){i=a[e].items;k=i.length;for(f=0;f<k;f++){h=i[f].notification;if(g(h))l.push(h)}}return l}}};c.getQueue=function(){return a};c.dispose=function(){if(a){a.reset();a=null}}})();(function(){"use strict";var c=window.jQuery,a=wLive.Controls.Notifications,b=a.AutomationOptions=new function(){var c=this,a,b;c.setModeAndLabels=function(d,c){a=d;b=c};c.getLabelAttribute=function(){return a};c.getLabelValue=function(d){var c;if(a&&a!==""&&b)c=b[d];return c};c.getLabel=function(f,d){var e="",c,g=function(a){return (d?d[a]:null)||b[a]};if(a&&a!==""&&b&&(c=g(f))&&c!=="")e=" "+a+'="'+c+'" ';return e}}})();(function(){"use strict";var m=27,o=9,a=window.jQuery,q=wLive.Animations,d=wLive.Controls.Notifications,n=a(d),c=d.InternalTools=d.InternalTools||{},f=d.AutomationOptions,k=a(window),b=a("BODY"),e=b[0],l={fadein:"fadeIn",fadeout:"fadeOut",slidein:"showEdgeUI",slideout:"hideEdgeUI",slidefadein:"enterContent",slidefadeout:"exitContent"},h=c.Toolkit={isEmptyString:function(a){return typeof a==="undefined"||a==null||a==""},checkEmptyArgument:function(b,a){if(h.isEmptyString(b))throw new Error(a);},getExtraDimensions:function(b){var c={},d=/\d+/,a=function(a){return parseInt(a)||0};c.left=a(b.css("marginLeft"))+a(b.css("borderLeftWidth"))+a(b.css("paddingLeft"));c.right=a(b.css("marginRight"))+a(b.css("borderRightWidth"))+a(b.css("paddingRight"));c.width=c.left+c.right;c.top=a(b.css("marginTop"))+a(b.css("borderTopWidth"))+a(b.css("paddingTop"));c.bottom=a(b.css("marginBottom"))+a(b.css("borderBottomWidth"))+a(b.css("paddingBottom"));c.height=c.top+c.bottom;return c},sanitizeOptions:function(b,e){var d=null;if(b){var c={};a.each(b,function(b,d){if(a.inArray(b,e)>=0)c[b]=d});d=c}return d},registerChangeUserOptionsApi:function(e,b,c){var f=function(d){a.extend(b,h.sanitizeOptions(d,c))};d["set"+e+"DefaultOptions"]=f},isLtr:function(){return a("BODY").css("direction")==="ltr"}},g=c.ButtonHelper=function(e,b){var h=this,c=[],f=a.extend({action:false,close:false,alternate:false},b&&b.excludes?b.excludes:{}),d=b&&b.renderOrder?b.renderOrder.split(","):g.buttonNames;(function(){var b,a,g,i,h;if(e){h=d.length;for(g=0;g<h;g++){b=d[g];a=e[b];if(!f[b]&&a&&typeof a==="string"&&a!=="")c.push({name:b,title:a})}}})();h.getNamesAndTitles=function(){return c}};g.buttonNames=["action","close","alternate"];g.automationKeys={};a.each(g.buttonNames,function(b,a){g.automationKeys[a]=a.charAt(0).toUpperCase()+a.substr(1)+"Button"});c.DeferredManager=function(g,e){var d=this,c=null,b=null;function f(){if(e)c=e();else c={}}f();d.getDeferred=function(){return b=b||a.Deferred()};d.updateState=function(b){if(b&&typeof b==="object")c=a.extend({},c,b)};d.resolve=function(){if(b){b.resolveWith(g,[c]);b=null}f()}};var j=c.TemplateHelper={basicContainer:'<div><div class="OuterContainer" {{#if backgroundColor}}style="background-color: {{=backgroundColor}};"{{/if}}><div class="InnerContainer"><div class="Content {{=contentCssClassnames}}">{0}</div></div></div></div>',defaultPartialTemplate:'{{each $data tmpl="Notifications.UserAreaSubTemplate"}}{{each $data tmpl="Notifications.ButtonSubTemplate"}}',registerTemplate:function(c){var b=c.html||j.defaultPartialTemplate;b=j.basicContainer.format(b);a.template(c.id,b)},render:function(i,k,o,e,m){var j=i.options.automationOptions,d=a.extend({contentCssClassnames:"",renderTitle:true,showNotificationArea:false,shouldRenderButtonArea:function(){return this.showNotificationArea&&e||this.buttons.length>0},prepareForAutomation:function(a){return f.getLabel(a,j)},buttons:a.map(m.getNamesAndTitles(),function(b){return a.extend({getButtonLabel:function(){return f.getLabel(c.ButtonHelper.automationKeys[this.name],j)}},b)})},i.options);if(h.isEmptyString(k)&&d.renderTitle)d.renderTitle=false;var g=a.views,l=g.activeViews;g.activeViews=false;var n=a.render(d,i.id);g.activeViews=l;var b=a(n);b.find(".UserTitle").append(k);b.find(".UserContent").append(o);if(d.showNotificationArea&&!h.isEmptyString(e))b.find(".NotificationArea").append(e);return b}};a.template("Notifications.ButtonSubTemplate",'{{#if shouldRenderButtonArea()}}<div class="ButtonArea">{{#if showNotificationArea}}<div class="NotificationArea" {{=prepareForAutomation("NotificationArea")!}}></div>{{/if}}{{#each buttons}}<button name="{{=name}}" type="button" {{#if name=="action"}}class="default c_nobdr"{{/if}} {{=$data.getButtonLabel()!}}>{{=title}}</button>{{/each}}</div>{{/if}}');a.template("Notifications.UserAreaSubTemplate",'<div class="UserArea"><div class="Clipper">{{#if renderTitle}}<div class="UserTitle{{#if titleCssClassnames}} {{=titleCssClassnames}}{{/if}}" {{=prepareForAutomation("Title")!}}></div>{{/if}}<div class="UserContent" {{=prepareForAutomation("Contents")!}}></div></div></div>');var p=c.TimerHelper=function(c,i,e){var h=this,a,d,b,f=function(){a=null;i()},k=function(){if(!b){b=new Date;clearTimeout(a);a=null}},j=function(){if(b&&d){var e=c-(b-d);b=null;d=new Date;a=setTimeout(f,e)}},g={mouseenter:k,mouseout:j};h.start=function(){if(c&&(c=parseInt(c))>0&&e&&e.length>0){e.bind(g);d=new Date;a=setTimeout(f,c)}};h.stop=function(){if(a){e.unbind(g);clearTimeout(a);a=null}}},i=c.NotificationBase=function(w){var u=this,qb=a(u),z=false,t=null,v=null,r=null,y=null,cb=false,s=w.instance,pb=a(s),A=a.extend({},i.defaultUserOptions,w.userOptions),g=a.extend({},i.defaultControlOptions,w.controlOptions),x=w.render=w.render||{},J=w.timer=w.timer||{},F=null,E=new c.DeferredManager(s),bb=new c.ButtonHelper(x.buttons,x.buttonOptions),D=null,P=false;x.template=x.template||{};x.template.options=x.template.options||{};x.template.options.automationOptions=h.sanitizeOptions(A.automation,["ActionButton","CloseButton","AlternateButton","Title","Contents"]);u.changeAnimation=function(d,c,a){if(g.changeAnimationOnUserInteraction){var b=d?"entrance":"exit";g.animation[b+"Type"]=c;if(typeof a!=="undefined")g.animation[b+"Arguments"]=a}};u.popoverElement=function(){return v};u.isHidden=function(){return z};u.getButton=function(c){var a=null,b;if(!c||(b=c.buttonName+"")==="")throw new Error("buttonName was not supplied.");if(r)a=r.find(".ButtonArea BUTTON[name="+b+"]");return a};u.getDeferredManager=function(){return E};u.reposition=function(){if(t){N();t.recalc()}};u.hide=function(){if(t&&!z){C("before","hide");B("beforehide");z=true;t.minimize();T();C("after","hide");B("afterhide")}};u.dismiss=function(c){var a,b=function(){d.getQueue().removeNotification(s)};if(t){a=C("before","dismiss");if(a===false)return;a=B("beforedismiss");if(a===false)return;G(c,"beforeDismiss");lb();ib();jb();S();hb();nb();W(false).then(function(){if(t){t.hide();r.remove();v=null;r=null;t.dispose();t=null;y=null;a=C("after","dismiss");if(a===false)return;a=B("afterdismiss");if(a===false)return;E.resolve();b();var c;if(A.returnFocusTo&&(c=A.returnFocusTo["focus"])&&typeof c==="function")A.returnFocusTo.focus()}})}else b()};u.show=function(c){var f=d.getQueue(),h=E.getDeferred(),b,e=false;if(!t){f.addNotification(s,function(){if(t&&z){T();t.restore();z=false}else if(!t){b=C("before","show");if(b!==false){b=B("beforeshow");if(b!==false){var d=j.render(x.template,x.title,x.content,x.notificationArea,bb);if(A.focusFirstButton&&bb.getNamesAndTitles().length>0)g.focusElement=d.find(".ButtonArea BUTTON").first()[0];G(c,"afterRendering",[d]);g.anchorElement=g.anchorElement||window;t=new $UI.Dialog(!!g.isModal,g.dialogZindex,!!w.positioner,"NotificationBase "+g.controlCss+" "+A.moreCss,g.anchorElement,g.trapTab);d.appendTo(A.notificationContainer||"#notificationContainer");v=t.setContents(d[0]);r=a(v);N();G(c,"beforeShow");kb();fb();ob();mb();t.show(g.focusElement,!g.setFocus);y=a("#UI_Dialog_BG");V(false);W(true).then(function(){if(!e){e=true;V(true);G(c,"afterShow");setTimeout(function(){gb();R();eb()},0);B("aftershow");b=C("after","show")}})}}}},g);f.showNextNotification(g.queueGroup)}else if(z)t.restore();return h.promise()};s.content=u.popoverElement;s.isHidden=u.isHidden;s.getButton=u.getButton;s.show=function(){return u.show()};s.dismiss=function(){u.dismiss()};s.hide=u.hide;s.reposition=u.reposition;function V(b){var a=b?"show":"hide";if(r){r[a]();y[a]()}}function C(c,b,a){a=a||[s];return n.triggerHandler(c+w.name+b,a)}function B(b,a){a=a||[s];return pb.triggerHandler(b,a)}function G(b,d,c){var a=b?b[d]:null;if(a&&typeof(a==="function"))a.apply({},c||[])}function mb(){var b=f.getLabelValue(g.automationKey);if(b)a(v).attr(f.getLabelAttribute(),b)}function T(){if(r){var a=f.getLabelAttribute();if(a){var b="automationtemp",c=r.attr(b);if(c&&c!==""){r.attr(a,c);r.attr(b,"")}else{var d=r.attr(a);if(d&&d!==""){r.attr(b,d);r.attr(a,"")}}}}}function ob(){if(J.timeoutInMsecs){F=new p(J.timeoutInMsecs,J.callback,J.getElements());F.start()}}function nb(){if(F){F.stop();F=null}}function N(){if(t&&v&&!z&&w.positioner){w.positioner(t.dock,v,g.anchorElement,g,A);var b=t.dock,a=null;if(b.y!==null)a={top:b.y};if(b.x!==null){a=a||{};a.left=b.x}if(a)r.css(a)}}function W(m){var b=g.animation||{},i=b.type||"none",k=b.entranceType||i+"in",n=b.exitType||i+"out",f,c,e,h,j=[v];if(y&&y.length>0)j.push(y[0]);if(m){f=k;c=b.entranceArguments}else{f=n;c=b.exitArguments}e=l[f];if(e){var d=[j];if(typeof c!=="undefined")d.push(c);d.push(false);h=q[e].apply({},d)}else h=a.Deferred().resolve();return h}function Y(a){if(a&&!L(a,v)){var b=$UI.Dialog.findFocusableElement(v,v,true);if(b)setTimeout(function(){try{b.focus()}catch(a){}},0)}}function H(a){var c=a.which;if(!z)if(c===m){u.changeAnimation(false,"none");a.stopPropagation();if(r.find(".ButtonArea button[name=close]").length>0){var b="close";E.updateState({buttonClicked:b});B("buttonclick",[s,b])}s.dismiss()}else if(c===o){Y(a.srcElement);if(!P){r.find("BUTTON.default.c_nobdr").removeClass("c_nobdr");P=true}}}function Z(a){Y(a.srcElement)}function kb(){if(g.dismissOnEsc)r.keydown(H);if(g.isModal){b.keyup(H);b.focusin(Z)}}function lb(){if(g.dismissOnEsc)r.unbind("keydown",H);if(g.isModal){b.unbind("keyup",H);b.unbind("focusin",Z)}}function X(b){var d=b&&b.srcElement&&b.srcElement.name||a(this).attr("name"),c;u.changeAnimation(false,"none");b.stopPropagation();E.updateState({buttonClicked:d});c=a(s).triggerHandler("buttonclick",[s,d]);if(c!==false&&A.dismissOnButtonClick)s.dismiss()}function fb(){r.find(".ButtonArea button").bind("click.notification",X)}function ib(){r.find(".ButtonArea button").unbind("click.notification",X)}function R(){k.bind({"resize.nbwindowchanged":M,"scroll.nbwindowchanged":M})}function S(){k.unbind(".nbwindowchanged",M)}function M(){if(!z){S();N();R()}}function U(){return _ge("UI_Dialog_BG")||e}function gb(){if(g.dismissOnOutsideClick){var b=U(),d=a(b),c=function(){if(b.addEventListener)b.addEventListener("click",I,true);else{b.attachEvent("onclick",I);if(!_ge("UI_Dialog_BG")&&e.setCapture){e._capturingClicks=true;e.attachEvent("onlosecapture",ab);O()}}D=null};if(g.delayOutsideClickDetectionByMsecs<=0)c();else D=setTimeout(c,g.delayOutsideClickDetectionByMsecs)}}function jb(){var b=U(),c=a(b);if(g.dismissOnOutsideClick){if(D!=null){clearTimeout(D);D=null}if(b.removeEventListener)b.removeEventListener("click",I,true);else{b.detachEvent("onclick",I);if(!_ge("UI_Dialog_BG")&&b.releaseCapture){b._capturingClicks=false;b.detachEvent("onlosecapture",ab);b.releaseCapture()}}}}function L(a,c){var b=false;while(a)if(a===c){a=null;b=true}else a=a.parentElement;return b}function I(a){if(z||a._alreadyCaptured)return;if(!L(a.srcElement,v))s.dismiss();if(!e.addEventListener&&e.setCapture){a._alreadyCaptured=true;a.srcElement.click();if(e._capturingClicks)O()}if(a._alreadyCaptured)a._alreadyCaptured=false}function ab(){if(b){var a=b[0];a.attachEvent("onmousemove",db);cb=false}}function O(){if(b){b[0].setCapture(true);cb=true}}function db(){if(b){O();b[0].detachEvent("onmousemove",db)}}function Q(a){a.stopImmediatePropagation();a.preventDefault();if(g.dismissOnOutsideClick)K(a)}function K(a){if(a&&a.srcElement&&!L(a.srcElement,v))s.dismiss()}function eb(){if(y&&g.isModal)y.bind("contextmenu",Q);if(b&&g.dismissOnOutsideClick)b.bind("contextmenu",K)}function hb(){if(y&&g.isModal)y.unbind("contextmenu",Q);if(b&&g.dismissOnOutsideClick)b.unbind("contextmenu",K)}};i.defaultControlOptions={anchorElement:null,ariaOptions:null,automationKey:null,changeAnimationOnUserInteraction:true,controlCss:null,dismissOnEsc:true,dismissOnOutsideClick:false,delayOutsideClickDetectionByMsecs:0,focusElement:null,isModal:false,returnFocusTo:null,setFocus:false,trapTab:true,queueGroup:null,queueMode:"fifo"};i.defaultUserOptions={dismissOnButtonClick:true,focusFirstButton:true,moreCss:null}})();(function(){"use strict";var a=window.jQuery,o=window.wLive,d=o.Controls.Notifications,q=a(d),p=d.AutomationOptions,i=d.InternalTools,b=i.Toolkit,l="Notifications.Bar";i.TemplateHelper.registerTemplate({id:l,html:'{{each $data tmpl="Notifications.UserAreaSubTemplate"}}{{each $data tmpl="Notifications.ButtonSubTemplate"}}<div class="Expand" {{=prepareForAutomation("ToggleExpansion")!}}></div>'});var n="#c_header",h=860,k=120,j=function(t,v,G,E,y,z){var B=a("HTML"),A=a("BODY"),o=a(v),m=o.find(".InnerContainer"),c=m.find(".Content"),C=b.isLtr(),p=Math.max(m.outerWidth(),h),e=c.find(".UserArea"),w=b.getExtraDimensions(e),j=w.width,g=e.find(".UserContent"),x=c.find(".ButtonArea"),f=x.outerWidth()||0,n=c.find(".Expand");c.width("").removeClass("MinWidth NormalWidth WideWidth");e.width("");n.removeClass("ShowImage").hide();g.addClass("ForMeasure").width("");var F=c.outerWidth()||0,l=g.outerWidth()||0,d=p-j-f,i=l+j+f;if(i<h){d=h-j-f;e.width(d);c.addClass("MinWidth")}else{var r=p-i>k,s=!r&&l>=d;if(r){c.width(i);c.addClass("WideWidth")}else{d-=k;s=l>=d;c.addClass("NormalWidth")}if(s){var D="margin"+(C?"Right":"Left");n.css(D,f).addClass("ShowImage").show();d-=n.outerWidth();g.width(d)}e.width(d)}m.css("left",-(B.scrollLeft()+A.scrollLeft()));if(z){var q=a(y.topBarOffsetJquerySelector);if(q.length>0){var u=$UI.Dialog.getLocation(q[0]);t.y=u.height}}else{o.css("bottom","0");t.y=""}g.removeClass("ForMeasure")},g={Top:{controlOptions:{animation:{entranceType:"slidein",entranceArguments:[{left:0,top:-50}],exitType:"slideout",exitArguments:[{left:0,top:-50}]},automationKey:"TopBar",controlCss:"NotificationBar TopBar",queueGroup:"TopBar"},positioner:function(e,a,d,b,c){j(e,a,d,b,c,true)}},Bottom:{controlOptions:{animation:{entranceType:"slidein",entranceArguments:[{left:0,top:50}],exitType:"slideout",exitArguments:[{left:0,top:50}]},automationKey:"BottomBar",controlCss:"NotificationBar BottomBar",queueGroup:"BottomBar"},positioner:j}},c=d.BarDismissalMode={Explicit:"Explicit",Implicit:"Implicit",Timeout:"Timeout"},e={};e[c.Explicit]={controlOptions:{queueMode:"filo"}};e[c.Implicit]={controlOptions:{dismissOnOutsideClick:true,delayOutsideClickDetectionByMsecs:1e3}};e[c.Timeout]={controlOptions:{dismissOnOutsideClick:true,delayOutsideClickDetectionByMsecs:1e3}};var f=function(o,j,z,p,y){b.checkEmptyArgument(j,"Dismissal mode was not supplied.");var h=this,A=a(h),s=e[j];b.checkEmptyArgument(s,"Dismissal mode was supplied but is invalid.");b.checkEmptyArgument(o,"Mode was not supplied.");var q=g[o];b.checkEmptyArgument(q,"Mode was supplied but is invalid.");if(q===g.Top&&j===c.Implicit)throw new Error("Top bars cannot be dismissed implictly.");else if(j===c.Explicit)if(b.isEmptyString(p.action)&&b.isEmptyString(p.close)&&b.isEmptyString(p.alternate))throw new Error("An explict dismissable bar should contain at least one button.");var B,m=false,x=a.extend({trapTab:false},s.controlOptions,q.controlOptions),k=a.extend({},f.defaultUserOptions,y);if(b.isEmptyString(k.topBarOffsetJquerySelector))k.topBarOffsetJquerySelector=n;var t={name:"bar",instance:h,controlOptions:x,userOptions:k,positioner:q.positioner,render:{content:z,buttons:p,buttonOptions:{renderOrder:"alternate,action,close"},template:{id:l,options:{contentCssClassnames:k.autoHeight?"":"Collapsed",backgroundColor:k.backgroundColor,renderTitle:false}}}};if(j===c.Timeout)t.timer={timeoutInMsecs:7e3,callback:function(){d.getDeferredManager().updateState({timedOut:true});A.triggerHandler("timedout",[h]);d.changeAnimation(false,"fadeout");h.dismiss()},getElements:function(){var b=a(d.popoverElement());return a().add(b).add(b.children()).add(b.find(".UserContent").children()).add(b.find(".ButtonArea BUTTON")).add(b.find(".Expand"))}};var d=new i.NotificationBase(t);h.barType=function(){return o};h.dismissalMode=function(){return j};h.show=function(){return d.show({beforeShow:function(){var b=a(d.popoverElement());if(o==="Bottom"&&j!==c.Timeout)b.find(".InnerContainer").addClass("WithMinWidth");b.find(".Clipper").addClass("transitionOnHeightChange");w();u()}})};h.dismiss=function(){d.dismiss({beforeDismiss:function(){v();m=false}})};function u(){if(m)a(d.popoverElement()).find(".Expand").click(r)}function v(){if(m)a(d.popoverElement()).find(".Expand").unbind("click",r)}function r(){var b=a(d.popoverElement()).find(".Content"),f=b.hasClass("Collapsed"),c=b.find(".Clipper"),e=b.find(".UserContent");c.toggleClass("ShowEllipsis");if(f){c.css("height",e.css("height"));b.removeClass("Collapsed")}else{c.css("height","");b.addClass("Collapsed")}d.reposition();return false}function w(){var e=a(d.popoverElement()),b=e.find(".UserArea"),c=b.find(".Clipper"),i=b.find(".UserContent"),f=e.find(".Expand"),h=c.innerHeight(),g=i.innerHeight();if(g>h){m=true;f.addClass("ShowImage");c.addClass("ShowEllipsis")}else f.attr("sutra","")}};f.defaultUserOptions={autoHeight:false,focusFirstButton:false,topBarOffsetJquerySelector:null};var m=function(b,a){if(!a)throw new Error("No parameters were supplied.");return new f(b,a.dismissalMode,a.content,a.buttons,a.options)};d.createTopBar=function(a){return m("Top",a)};d.createBottomBar=function(a){return m("Bottom",a)};b.registerChangeUserOptionsApi("Bar",f.defaultUserOptions,["autoHeight","topBarOffsetJquerySelector","moreCss","notificationContainer"]);d.getQueue().registerSearchApi("getNotificationBars",[g.Top.controlOptions.queueGroup,g.Bottom.controlOptions.queueGroup])})();(function(){"use strict";var b=window.jQuery,g=window.wLive,c=g.Controls.Notifications,h=c.AutomationOptions,e=c.InternalTools,d=e.Toolkit,f="Notifications.Flyout";e.TemplateHelper.registerTemplate({id:f});var a=function(n,g,h,m,l){d.checkEmptyArgument(g,"No content was supplied");if(h==null)throw new Error("No anchor was supplied.");var j=this,k=b.extend({},a.defaultUserOptions,l),c=b.extend({anchorElement:h},a.defaultControlOptions),i=new e.NotificationBase({name:"flyout",instance:j,controlOptions:c,userOptions:k,positioner:function(a,R,t,g){var Q=t.document||t.ownerDocument,B=Q.documentElement,P=B.clientWidth,O=B.clientHeight,n=b(R),j=n.find(".OuterContainer"),q=n.outerWidth(),p=n.outerHeight(),e=b(t),c=e.offset(),J=3;while(J-->0){var f=Math.max(Math.min(q,g.maxWidth),g.minWidth),i=Math.max(Math.min(p,g.maxHeight),g.minHeight),F=i/2,h=c.top,m=c.left,D=e.outerHeight(),E=e.outerWidth(),z=D/2;a.x=m+E/2-f/2;a.y=h-i;a.width=f;a.height=i;if(a.y<0)a.y=h+D;if(a.x<0){a.x=m+E;a.y=h+z-F}else if(a.x+f>P){a.x=m-f;a.y=h+z-F}var y=j.outerWidth(),w=j.outerHeight(),s={top:a.y,left:a.x};if(f!=q)s.width=f;if(i!=p)s.height=i;n.css(s);var x=j.outerWidth(),v=j.outerHeight();c=e.offset();if(y!==x||w!==v){var L=v-w,N=x-y;q+=N;p+=L}else if(h===c.top&&m===c.left)break}var C=d.getExtraDimensions(e),G=parseInt((C.width+e.width())/2+c.left),H=parseInt((C.height+e.height())/2+c.top),K=parseInt(a.width/2+a.x),M=parseInt(a.height/2+a.y),u=0,o=0,I=function(e,f,c){var a=0,b=e-f,d=Math.abs(b)>c;if(d)a=b>0?1:-1;return a},A=function(d,e,c){var a=0,b=I(d,e,5);if(b>0)a=-c;else if(b<0)a=c;return a},l=50;o=A(M,H,l);u=A(K,G,d.isLtr()?l:-l);var r=g.animation.entranceArguments[0];r.left=u;r.top=o;var k=a.y+a.height-O;if(k>0){if(o!==0){k+=l;r.top-=k}a.y-=k}a.y=Math.max(0,a.y)},render:{title:n,content:g,buttons:m,buttonOptions:{excludes:{dismiss:true}},template:{id:f}}});j.show=function(){return i.show({beforeShow:function(){if(c.width)b(i.popoverElement()).find(".UserContent").css({width:c.width})}})}};a.defaultUserOptions={};a.defaultControlOptions={animation:{entranceType:"slidefadein",entranceArguments:[{left:0,top:0}],exitType:"fadeout"},automationKey:"Flyout",changeAnimationOnUserInteraction:false,controlCss:"Flyout",dismissOnOutsideClick:true,isModal:true,maxHeight:758,maxWidth:510,minHeight:54,minWidth:70,queueGroup:"Flyout",setFocus:true,trapTab:false,width:null};c.createFlyout=function(b){if(!b)throw new Error("No parameters were supplied.");return new a(b.title,b.content,b.anchor,b.buttons,b.options)};d.registerChangeUserOptionsApi("Flyout",a.defaultUserOptions,["moreCss","notificationContainer"]);c.getQueue().registerSearchApi("getFlyouts",[a.defaultControlOptions.queueGroup])})();(function(){"use strict";var b=window.jQuery,g=window.wLive,c=g.Controls.Notifications,h=c.AutomationOptions,d=c.InternalTools,f=d.Toolkit,e="Notifications.ModalDialog";d.TemplateHelper.registerTemplate({id:e});var a=function(n,i,j,m,l){f.checkEmptyArgument(i,"No content was supplied");var c=this,g=null,k=b.extend({},a.defaultUserOptions,l),h=new d.NotificationBase({name:"dialog",instance:c,controlOptions:a.defaultControlOptions,userOptions:k,positioner:function(j,f){var i=b("HTML"),h=b("BODY"),a=b(f),c=a.find(".InnerContainer"),e=b(window).innerHeight(),d=a.height(),g=(e-d)/2;j.y=g;c.css("left",-(i.scrollLeft()+h.scrollLeft()))},render:{title:n,content:i,notificationArea:j,buttons:m,template:{id:e,options:{showNotificationArea:true}}}});c.show=function(){return h.show({beforeShow:function(){g=b(h.popoverElement()).find(".NotificationArea")}})};c.dismiss=function(){h.dismiss({beforeDismiss:function(){g=null}})};c.notificationArea=function(){return g}};a.defaultUserOptions={};a.defaultControlOptions={animation:{type:"fade"},automationKey:"ModalDialog",changeAnimationOnUserInteraction:false,controlCss:"ModalDialog",isModal:true,setFocus:true,queueGroup:"ModalDialog"};c.createModalDialog=function(b){return new a(b.title,b.content,b.notificationArea,b.buttons,b.options)};f.registerChangeUserOptionsApi("ModalDialog",a.defaultUserOptions,["moreCss","notificationContainer"]);c.getQueue().registerSearchApi("getModalDialogs",[a.defaultControlOptions.queueGroup])})();(function(){"use strict";var b=window.jQuery,g=window.wLive,d=g.Controls.Notifications,h=d.AutomationOptions,e=d.InternalTools,c=e.Toolkit,f="Notifications.Toast";e.TemplateHelper.registerTemplate({id:f,html:'{{#if contentImage}}<div class="ContentImage" {{=prepareForAutomation("ContentImage")!}}><img src="{{=contentImage}}"></div>{{/if}}{{each $data tmpl="Notifications.UserAreaSubTemplate"}}{{#if sourceIcon}}<div class="SourceIcon" {{=prepareForAutomation("SourceIcon")!}}><img src="{{=sourceIcon}}"></div>{{/if}}<div class="TimeoutTrap"></div><div class="CloseIcon" {{=prepareForAutomation("CloseIcon")!}}><div class="HoverArea"></div></div>'});var a=function(i,p,m,o,t){c.checkEmptyArgument(p,"No content was supplied");c.checkEmptyArgument(o,"No source icon was supplied");var n=b.extend({},a.defaultUserOptions,t),g=this,q=b(g),h={id:f,options:{backgroundColor:n.backgroundColor,contentImage:m,sourceIcon:o,renderTitle:!!i,titleCssClassnames:"TextSemiBold LineHeightStandard"}},j=function(b,a){if(b)h.options.contentCssClassnames=(h.options.contentCssClassnames||"")+" "+a};j(!c.isEmptyString(m),"WithContentImage");j(!c.isEmptyString(i),"WithTitle");var d=new e.NotificationBase({name:"toast",instance:g,controlOptions:a.defaultControlOptions,userOptions:n,positioner:function(a){a.x=null;a.y=null},render:{title:i,content:p,template:h},timer:{timeoutInMsecs:7e3,callback:function(){d.getDeferredManager().updateState({timedOut:true});q.triggerHandler("timedout",[g]);g.dismiss()},getElements:function(){var a=b(d.popoverElement);return b().add(a.find(".TimeoutTrap")).add(a.find("CloseIcon"))}}});g.show=function(){return d.show({beforeShow:function(){r()}})};g.dismiss=function(){d.dismiss({beforeDismiss:function(){s()}})};function r(){b(d.popoverElement()).click(l).find(".CloseIcon").click(k)}function s(){b(d.popoverElement()).unbind("click",l).find(".CloseIcon").unbind("click",k)}function l(){d.getDeferredManager().updateState({clicked:true});q.triggerHandler("click",[g]);d.changeAnimation(false,"none");g.dismiss()}function k(){d.changeAnimation(false,"none");g.dismiss()}};a.defaultUserOptions={};a.defaultControlOptions={animation:{entranceType:"slidein",entranceArguments:[{top:0,left:400}],exitType:"fadeout"},automationKey:"Toast",controlCss:"Toast",queueGroup:"Toast"};d.createToast=function(b){var c=window.top,e=null,d=null;try{if(c!==window&&c.wLive&&c.wLive.Controls&&c.wLive.Controls.Notifications){e=c.wLive.Controls.Notifications;e.getQueue().start();d=e.createToast(b)}}catch(f){}if(!d)d=new a(b.title,b.content,b.contentImage,b.sourceIcon,b.options);return d};c.registerChangeUserOptionsApi("Toast",a.defaultUserOptions,["backgroundColor","moreCss","notificationContainer"]);d.getQueue().registerSearchApi("getToasts",[a.defaultControlOptions.queueGroup])})();(function(){var a=wLive.Controls.Notifications;a.enableAriaSupport=function(){if(jQuery("#notificationContainer").length===0){var a={position:"absolute",padding:"0",margin:"0",height:"100%",width:"100%",top:"0"};a[wLive.Controls.Notifications.InternalTools.Toolkit.isLtr()?"left":"right"]="0";jQuery('<div id="notificationContainer" class="NotificationContainer" persist="1" aria-live="polite" aria-atomic="false"></div>').css(a).prependTo("BODY")}}})();(function(){$Do.register("NotificationControls")})();(function(){var g=wLive.Core,f=wLive.Controls,a=g.AleHelpers.getPCString,b="Office.TicketRedeem.",r=a(b+"Header"),p=a(b+"You"),v=a(b+"PleaseWait"),w=a(b+"Error"),q=a(b+"ContinueStr"),s=a(b+"SwitchAccounts"),i=a(b+"GoldenTicketBodyDocument"),n=a(b+"GoldenTicketBodyPhoto"),m=a(b+"GoldenTicketBodyFolder"),o=a(b+"GoldenTicketBodyVideo"),h=a(b+"InfiniteTicketBodyDocument"),k=a(b+"InfiniteTicketBodyPhoto"),j=a(b+"InfiniteTicketBodyFolder"),l=a(b+"InfiniteTicketBodyVideo"),t='<div class="ticketRedeemer"><div class="header"></div><div class="icPlaceholder"></div><div class="body"></div></div>',d="action",e="alternate",c="/API/2/RedeemPermissionToken",x;f.TicketRedeemer=u;function u(x){var u=this,b,M,N,O,A,a=jQuery(t),y=jQuery(_ce("div")).html(a),C=a.find(".icPlaceholder").css("padding-bottom","8px"),K=a.find(".header").css("padding-bottom","8px"),L=a.find(".body"),z=jQuery(_ce("div")).html(w).addClass("error");u.show=function(c){A=c;var i=c["callback"],g=c["item"],l=c["action"],k=c["authkey"],o=g.id,j=g.tokenType;if(!x.callerCid||x.callerCid==="")$BSI.navigateTo(H(g,l,k),"_top");else if(x.callerCid.toLowerCase()===g.ownerCid.toLowerCase()){u.dispose();i&&i()}else{J(g,j);var n=j===0?"GoldenTicketRedeem":"InfiniteTicketRedeem",m={buttons:{action:q,alternate:s},title:r,content:y};b=f.Notifications.createModalDialog(m);var h=jQuery(b);h.bind({"aftershow._dlg":function(){var h=a.closest(".ModalDialog");sutra(h,"$Sutra.SkyDrive."+n);var f=b.getButton(d);sutra(f,"$Sutra.SkyDrive.RedeemContinue");var g=b.getButton(e);sutra(g,"$Sutra.SkyDrive.RedeemSwitchAccounts");c.onShow&&c.onShow()},"afterdismiss._dlg":function(){h&&h.unbind("._dlg");h=null;b=null},"buttonclick._dlg":function(c,b,a){D(b,a,l,i,g,k)}});b.show()}};u.dispose=function(){a.remove();z.remove();b&&b.dismiss();b=null;A.onHide&&A.onHide()};function J(c,b){K.html(p.format($Config.email||""));L.html(G(c,b));var a=[];a.push([$Config.cid,"uniqueid"]);$ic.ic.createICsFromCids("TokenRedemptionTemplate",a,function(b,a){if(a)C.html(a["html"]);else C.html($Config.email)})}function D(j,b,i,h,f,c){if(b==e){var g=B(f,i,c);$BSI.navigateTo(FilesConfig.autoRedeemSignOut+("&lru="+g.encodeUrl()),"_top")}else if(b==d){I(f.id,c,h);a.detach();y.html(v);z.detach()}else u.dispose()}function I(f,d,a){var b=Object.toJSON({id:f,authKey:d}),e=new g.DataRequest(c,c,b,function(){F(a)},E);e.start()}function F(a){x.tokenHasBeenRedeemed=true;u.dispose();a&&a()}function E(){y.html(a);z.insertBefore(a.find(".header"))}function H(e,d,c){var a=B(e,d,c),b=FilesConfig.signInUrl+"&ru="+a.encodeUrl()+"&wreply="+a.encodeUrl();return b}function B(c,a,e){var b,f,g,d=a&&a.url;if(d)b=d;else b="/?id="+c.id.encodeUrl()+"&cid="+c.ownerCid.encodeUrl()+(a?"&action="+a.name.encodeUrl():"");return FilesConfig.autoRedeemUrl+"?resid="+c.id.encodeUrl()+"&authKey="+e.encodeUrl()+"&ru="+b.encodeUrl()}function G(c,d){var a,b=d==0;if(c.folder)a=b?m:j;else if(c.video)a=b?o:l;else if(c.photo)a=b?n:k;else a=b?i:h;return a}}})();(function(){var m=window,g=wLive.Core,f=wLive.Controls,c=g.AleHelpers.getPCString,i=795,l=18,k=3017,d="Doc",h="One",a="Ppt",b="Xls",e=j.iconTypeToFileType={Doc:d,Docm:d,Docx:d,Dot:d,Dotm:d,Dotx:d,Odp:a,Ods:b,Odt:d,One:h,Onepkg:h,Onetoc2:h,Notebook:"OneNotebook",Pot:a,Potm:a,Potx:a,Ppa:a,Ppam:a,Pps:a,Ppsm:a,Ppsx:a,Ppt:a,Pptm:a,Pptx:a,Xla:b,Xlam:b,Xls:b,Xlsb:b,Xlsm:b,Xlsx:b,Xlt:b,Xltm:b,Xltx:b};f.Embed=j;function j(G){var x=this,L=wLive.Controls.Notifications,h,T,p,U,r,w,s,j,n,q,o;x.dispose=function(){if(h){h.dismiss();h=null}};x.show=function(a,l,x,k,i){q=l;n=x;if(k)w=k;if(i)s=i;var m=function(c,a){jQuery("iframe#preview_iframe").attr({src:""});jQuery("#CancelIcon").unbind("click");S(a)};o=jQuery('<div id="embedLoading"></div>');var j=t(a);if(!q&&e[a.iconType]===b)r=c("Embed.Cancel");else r=c("Embed.Done");if(a.video&&f.Video&&f.Video.currentVideo)f.Video.currentVideo.stop();var v=jQuery(_ce("div")).attr({id:"mainBody"}).css({"min-height":j}).append(o);h=L.createModalDialog({buttons:{close:r},title:c("Embed.EmbedDocumentTitle").format(a.name),content:v});var d=jQuery(h);d.bind({"aftershow._dlg":function(){Q(j);p=jQuery(h.content());B(a,g,function(a){y(a,g)})},"afterdismiss._dlg":function(){d&&d.unbind("._dlg");d=null;h=null},"buttonclick._dlg":m});h.show();function g(a){z(a);u()}var u=function(){if(h){P();N(a,h);jQuery("#mainBody").height(function(){var c=jQuery("#column").height(),b=t(a,true);if(c>b)return c;else{jQuery("#column").height(b);return b}});C()}}};function Q(c){o.empty();var b=$f.createLoading(true);o.html(b);o.show();var a=(c-o.height())/2;o.css("padding-top",Math.ceil(a))}function P(){o.hide()}function N(a,f){if(f){var c=u(a),d=jQuery(_ce("div")).attr({id:"preview"}).width(c),e=jQuery(_ce("div")).attr({id:"column"}).width(i-c);O(d,a);D(e,a,f);jQuery("#mainBody").append(d,e);var b=_ge("generateButton");b&&b.focus()}}function O(h,c){if(!j){var f,i=e[c.iconType];if(n&&i===b)f=jQuery(_ce("img")).attr({id:"preview_iframe",src:FilesConfig.foldersImgBaseUrl+"/embed_excel.png",alt:"Excel",tabindex:"-1"});else if(n&&i===a)f=jQuery(_ce("img")).attr({id:"preview_iframe",src:FilesConfig.foldersImgBaseUrl+"/embed_ppt.png",alt:"PowerPoint",tabindex:"-1"});else if(n&&i===d)f=jQuery(_ce("img")).attr({id:"preview_iframe",src:FilesConfig.foldersImgBaseUrl+"/embed_word.png",alt:"Word",tabindex:"-1"});else f=jQuery(_ce("iframe")).attr({id:"preview_iframe",tabindex:"-1",scrolling:"no",frameborder:"0",width:""+u(c),height:""+t(c,true),src:g.ItemActionHelper.itemStringFormat("/embed?{cidQueryString}{resIdQueryString}",c,c.ownerCid,c.group)});h.append(f)}else{h.append(j.embedCode);h.children("iframe").attr({id:"preview_iframe",tabindex:"-1"})}}function M(a){if(n){a.html(j.embedCode);a.children("iframe").attr({id:"preview_iframe"})}}function D(e,a,g){var b=jQuery(_ce("div")).attr({id:"instructions"}),d=jQuery(_ce("div")).attr({id:"gen"}),f=jQuery(_ce("div")).attr({id:"disclaimer"}).html(c("Embed.Disclaimer"));I(b,a);H(d,a,g);e.append(b,d,f);J(e,a)}function I(a,b){if(!j)a.html(c("Embed.GenerateInstructions."+v(b)));else if(navigator.appName=="Microsoft Internet Explorer"){a.html(c("Embed.CopyInstructions."+v(b)).format('<span id="copyHtml">',"</span>"));jQuery(a).find("span").click(R)}else a.html(c("Embed.CopyInstructions."+v(b)).format("",""))}function R(){document.getElementById("embedTextbox").createTextRange().execCommand("Copy")}function H(b,d,f){if(!j){var e=jQuery(_ce("input")).attr({id:"generateButton","class":"default",name:c("Embed.Generate"),type:"button",value:c("Embed.Generate")}).click(function(){K(d,f)});b.html(e)}else{var a=jQuery(_ce("input")).attr({id:"embedTextbox",name:"HTML",type:"text",value:j.embedCode}).width(i-l-u(d));if(!($B.SF_iPhone&&!$B.Mobile))a.attr("readonly","readonly");a.click(function(){A(jQuery(this))});b.html(a)}}function A(a){a.focus();a.select()}function J(b){if(q&&j&&j.embedConfiguratorUrl){var a=jQuery(_ce("div")).attr({id:"configurator"});a.html(jQuery(_ce("a")).attr({href:j.embedConfiguratorUrl,target:"_blank"}).html(c("Embed.Configurator")));b.append(a)}}function K(b,a){jQuery("#generateButton").attr("disabled","disabled");G.embedLink(b,function(c,b){F(c,b,a)},E)}function S(a){if(w)w();a.dismiss();x.dispose()}function v(b){var a;if(b.photo)a="Photo";else if(b.folder&&b.folder.covers)a="Album";else if(b.folder)a="Folder";else a="File";return a}function u(c){if(c.photo||c.video){var f=c.video?c.video:c.photo,g=f.width<320?f.width:320;if(f.width>f.height)return g;else return Math.floor(g*(f.width/f.height))}else if(c.folder)return 165;else if(n&&e[c.iconType]===b)return 402;else if(n&&e[c.iconType]===a)return 402;else if(n&&e[c.iconType]===d)return 476;else return 98}function t(c,g){if(c.photo||c.video){var f=c.photo?c.photo:c.video,h=f.height<320?f.height:320;if(f.height>f.width)return h;else return Math.floor(h*(f.height/f.width))}else if(n&&e[c.iconType]===b)return 346;else if(n&&e[c.iconType]===a)return 327;else if(n&&e[c.iconType]===d)return 288;else if(g&&c.folder)return 128;else if(c.folder)return 139;else if(g)return 120;else return 125}function B(e,c,b){var a=m.FilesConfig.baseApiUrl+"GetEmbedInfo?"+"id="+e.id,d=new g.DataRequest(a,a,null,c,b);d.start()}function F(a,c,b){if(s){s(c);return}B(a,function(c){z(c);if(h){jQuery("#column").empty();D(jQuery("#column"),a,b);M(jQuery("#preview"),a);jQuery("div.Footer button").show();A(jQuery("#embedTextbox"));C()}},y)}function E(){jQuery("#instructions").html(c("Embed.PopoverError"));jQuery("#generateButton").removeAttr("disabled")}function z(a){if(a&&a.embedCode)j=a;else j=null}function y(a,b){if(a&&a.error&&a.error.code==k&&b)b(a);else jQuery("#mainBody").html(c("Embed.PopoverError"))}function C(){sutra(p.find(".Content"),"$Sutra.SkyDrive.EmbedPopover");sutra(p.find(".UserTitle"),"$Sutra.SkyDrive.EmbedTitle");sutra(jQuery("#preview"),"$Sutra.SkyDrive.EmbedPreview");sutra(jQuery("#preview_iframe"),"$Sutra.SkyDrive.EmbedPreviewIframe");sutra(jQuery("#embedTextbox"),"$Sutra.SkyDrive.EmbedTextbox");sutra(jQuery("#configurator"),"$Sutra.SkyDrive.EmbedExcelLink");sutra(jQuery("#generateButton"),"$Sutra.SkyDrive.EmbedGenerateBtn");sutra(jQuery(h.getButton({buttonName:"close"})),"$Sutra.SkyDrive.EmbedDoneBtn")}}})();(function(){var e=window,b=wLive.Core,c=wLive.Controls,a=b.AleHelpers.getPCString;c.SendForm=d;function d(n){var m=this,o,i=b.PermissionsProvider,E=i.Role,y=wLive.Controls.Notifications,z=a("SendSurvey.Title"),A=a("SendSurvey.Note"),q='<div id="sendFormBody"><div id="formIcon"></div><div id ="formNote"><div id="formText" type="text"></div><div id="errorText" type="text"></div><div id="LinkBox"><input id="LinkName" type="text" readonly="true"></input><input id="btnShorten" class="default" type="button" value="'+a("Sharing.ShortenLink")+'"></input>'+'<input id="btnGenerate" class="default" type="button" value="'+a("Sharing.CreateLink")+'"></input>'+"</div>"+"</div>"+"</div>",d,e=jQuery(q),l=jQuery("#formIcon",e),j=jQuery("#formText",e),f=jQuery("#errorText",e),h=jQuery("#btnGenerate",e),g=jQuery("#btnShorten",e),c=jQuery("#LinkName",e),p,k,s=204;m.dispose=function(){if(d){d.dismiss();d=null}};m.show=function(b){e.hide();if(FilesConfig.urlShorteningEnabled)g.click(function(){C(b)});else g.hide();var f=function(){h.unbind("click");g.unbind("click");m.dispose()};d=y.createModalDialog({buttons:{action:a("SendSurvey.DoneButton")},title:z.format(b.form&&b.form.title.encodeHtml()||b.name),content:e});var c=jQuery(d);c.bind({"aftershow._dlg":function(){k=jQuery(d.content());p=jQuery(d.getButton({buttonName:"action"}));B();n.fetchPermissions(b,x,r)},"afterdismiss._dlg":function(){c&&c.unbind("._dlg");c=null;d=null},"buttonclick._dlg":f});d.show()};function C(c){var a={id:c.id};a.type=i.EntityType.Link;a.linkType=i.LinkType.Form;a.cid=c.ownerCid;if(b.SkyDriveItemHelper.isGroupItem(c))a.group=c.group;var d=FilesConfig.baseApiUrl+"Shorten?"+$Utility.serialize(a),e=new b.DataRequest(d,d,null,u,t);e.start()}function u(a){c.val(a.url);c.click(function(){c.select()});c.focus().select();g.hide()}function t(){j.hide();f.text(a("SendSurvey.Error"));f.show()}function w(d,a){h.hide();if(FilesConfig.urlShorteningEnabled)g.show();c.show();var b=a.link;c.val(b);c.click(function(){c.select()});c.focus().select()}function v(l,b){j.hide();var g;if(b&&b.code==s){var i=b.data,d=b.message;if(i&&d){var e=Object.fromJSON(i),h=e.smsUrl,c=e.displayAction;if(h&&c){g=d.encodeHtml()+' <a href="'+h.encodeHtml()+'" target="_blank">'+c.encodeHtml()+"</a>";var k=true}f.html(g)}}else f.text(a("SendSurvey.Error"));f.show()}function x(j,l){var g=l.permissionScopes;for(var e=0;e<g.length;e++){var h=g[e],k=b.StringHelpers.caseInsensitiveStringEquals(h.id,j.id),f=h.entities;for(var c=0;c<f.length;c++){var a=f[c];if(k&&a.type==i.EntityType.Link)if(a.linkType==i.LinkType.Form)o=a}}D(j,o);d.reposition()}function r(){e.show();j.hide();h.hide();g.hide();c.hide();var b=jQuery(_ce("img")).attr({id:"img_element",src:FilesConfig.foldersImgBaseUrl+"/embed_form.png",tabindex:"-1"});l.append(b);f.text(a("SendSurvey.Error"));f.show();d.reposition()}function D(i,b){e.show();f.hide();j.text(A);var d=jQuery(_ce("img")).attr({id:"img_element",src:FilesConfig.foldersImgBaseUrl+"/embed_form.png",tabindex:"-1"});l.append(d);if(!b){c.hide();g.hide();h.click(function(){n.submitFormLink(i,w,v)})}else{h.hide();var a;a=b.link;c.val(a);c.click(function(){c.select()});c.focus().select()}}function B(){sutra(k,"$Sutra.SkyDrive.ShareFormDialog");sutra(jQuery(".UserTitle",k),"$Sutra.SkyDrive.ShareFormTitle");sutra(l,"$Sutra.SkyDrive.ShareFormIcon");sutra(j,"$Sutra.SkyDrive.ShareFormText");sutra(f,"$Sutra.SkyDrive.ShareFormError");sutra(c,"$Sutra.SkyDrive.ShareFormLink");sutra(h,"$Sutra.SkyDrive.ShareFormGenerateBtn");sutra(g,"$Sutra.SkyDrive.ShareFormShortenBtn");sutra(p,"$Sutra.SkyDrive.ShareFormDoneBtn")}}})();(function(){var b=wLive.Core,e=wLive.Controls,a=e.Notifications,i=jQuery(window),d=["CopyEditHandler","ShareHandler","EmbedHandler","OpenInClientHandler","VersionHistoryHandler","ShareFormHandler"];b.OfficePageController=g;function g(o,p,q,r,s,m,i){var l=this,c=new b.PostMessageHandler,n=h(),j=new b.DataModel(o,p,q,r,s,m),k=b.SkyDriveItem.getItemKey(WacConfig.viewParams.id,WacConfig.viewParams.cid,WacConfig.viewParams.group,WacConfig.viewParams.qt,WacConfig.viewParams.did);if(i)j.processResponse(i,k);a&&a.getQueue().start();var f=[];for(var g=0;g<d.length;g++)f.push(new e[d[g]](n,c,j.getItem(k)));l.dispose=function(){a&&a.getQueue().reset();c.dispose();for(var b=0;b<f.length;b++)f[b].dispose()};l.getPostMessageHandler=function(){return c}}function h(){var b={callerCid:$Config.hcid,tokenHasBeenRedeemed:false,notifications:a};return b}var c;b.OfficePageController.getInstance=function(){return c};function f(){var b=Object.fromJSON(WacConfig.GetItemsResponse),a=new wLive.Core.OfficePageController(FilesConfig.baseApiUrl,FilesConfig.canary,FilesConfig.appId,FilesConfig.hcid,$Config.mkt,FilesConfig.dataPageSize,b);$Do.when("$PF.attach",a,a.dispose);i.bind("unload",function(){a.dispose()});return a}$Do.when("Bucket1.js",0,function(){c=f()})})();(function(){var L=wLive.Core,S=wLive.Controls,K=0,e="sdx_ow_iframe",f="MessageId",g="Values",I="SendTime",G="UI_Close",q="UI_FileProperties",J="UI_Sharing",B="UI_FileEmbed",F="UI_CopyAndEdit",H="UI_ReplyWithChanges",v="UI_FileVersions",D="UI_ShareForm",p="UI_OpenInClient",s="UI_ReportAbuse",w="CheckPolicy",j="App_LoadingStatus",Q="control_left",T="control_top",M="control_height",N="control_width",W="click_x",X="click_y",U="ui_language",R="event_source",o="DocumentLoadedTime",P="CloseButton",V="FileMenu",O="OIC",A="BlurFocus",C="GrabFocus",E="CanEmbed",d=a.WacCloseEvent="Close",c=a.WacFilePropertiesEvent="FileProperties",z=a.WacShareEvent="Share",r=a.WacFileEmbedEvent="FileEmbed",u=a.WacCopyEditEvent="CopyEdit",y=a.WacReplyEvent="Reply",k=a.WacFileVersionsEvent="FileVersions",t=a.WacShareFormEvent="ShareForm",l=a.WacOpenInClientEvent="OpenInClient",b=a.WacLoadingStatusEvent="AppLoadingStatus",n=a.WacReportAbuseEvent="ReportAbuse",m=a.WacCheckPolicyEvent="CheckPolicy",x="BP",i=".postMessageHandler",h=jQuery(window);L.PostMessageHandler=a;function a(){var M=this,a=jQuery(M),L=i+K++,O;h.bind("message"+L,S);a.bind(d+L,U);a.bind(c+L,Q);a.bind(b+L,P);M.sendBlurFocus=function(){N(A)};M.sendGrabFocus=function(){N(C)};M.sendCanEmbed=function(a){N(E,{HostEmbeddedViewUrl:a})};M.sendCheckPolicyResponse=function(a){N("CheckPolicyResponse",a||{})};M.dispose=function(){h.unbind(L);a.unbind(L)};function S(A){var h=A.originalEvent,i=R();if(i&&T(i,h.origin)){O=h.origin;var o=jQuery.parseJSON(h.data),x=o[f],e=o[g];switch(x){case G:a.trigger(d,e);break;case q:a.trigger(c,e);break;case J:a.trigger(z,e);break;case B:a.trigger(r,e);break;case F:a.trigger(u,e);break;case H:a.trigger(y,e);break;case v:a.trigger(k,e);break;case D:a.trigger(t,e);break;case p:a.trigger(l,e);break;case j:a.trigger(b,e);break;case s:a.trigger(n,e);break;case w:a.trigger(m,e)}}}function R(){var c,d=document.getElementById(e);if(d){var b=d.src;if(b){var a=b.split("/");if(a.length>=3)c=a[0]+"//"+a[2]}}return c}function T(a,b){if(a&&b){a=a.substr(a.indexOf("."));b=b.substr(b.indexOf("."))}return a===b}function U(){$BSI.navigateTo(WacConfig.CloseUrl)}function Q(){$BSI.navigateTo(WacConfig.FilePropertiesUrl)}function P(d,a){var c=$Utility.deserialize($Cookie.getCookie(x)).ST;if(a)$CSIPerf._ttg=a[o];$BSI.informLoaded();var b={Iframe:window.g_iframeTime};if(c)b["Click"]=c;N("Host_PerfTiming",b)}function N(h,b){var c=new Date,i=b?Object.toJSON(b):null;if(O){var d=document.getElementById(e),a=d.contentWindow;if(a&&a["postMessage"])a["postMessage"]('{ "'+f+'": "'+h+'", "'+g+'":'+i+', "'+I+'": '+c.getTime()+"}",O)}}}})();(function(){var e=wLive.Core,a=wLive.Controls,d=0,b=".versionHistoryHandler";a.VersionHistoryHandler=c;function c(h,c,k){var l=this,f=jQuery(c),g=b+d++;f.bind(e.PostMessageHandler.WacFileVersionsEvent+g,j);l.dispose=function(){f.unbind(g)};function j(){var b=new a["TicketRedeemer"](h);b.show(i())}function i(){var a={item:k,action:{url:WacConfig.FileVersionUrl},authkey:WacConfig.authkey,callback:function(){$BSI.navigateTo(WacConfig.FileVersionUrl)},onHide:function(){c.sendGrabFocus()},onShow:function(){c.sendBlurFocus()}};return a}}})();(function(){var a=wLive.Controls,e=wLive.Core,d=0,b=".copyEditHandler";a.CopyEditHandler=c;function c(h,c,k){var l=this,f=jQuery(c),g=b+d++;f.bind(e.PostMessageHandler.WacCopyEditEvent+g,j);l.dispose=function(){f.unbind(g)};function j(){var b=new a["TicketRedeemer"](h);b.show(i())}function i(){var a={item:k,action:{url:WacConfig.EditUrl},authkey:WacConfig.authkey,callback:function(){$BSI.navigateTo(WacConfig.EditUrl)},onHide:function(){c.sendGrabFocus()},onShow:function(){c.sendBlurFocus()}};return a}}})();(function(){var e=wLive.Core,a=wLive.Controls,d=0,b=".openInClientHandler";a.OpenInClientHandler=c;function c(i,c,l){var m=this,f=jQuery(c),h=b+d++;f.bind(e.PostMessageHandler.WacOpenInClientEvent+h,k);m.dispose=function(){f.unbind(h)};function k(){var b=new a["TicketRedeemer"](i);b.show(j())}function j(){var a={item:l,action:{url:g()},authkey:WacConfig.authkey,callback:function(){$BSI.navigateTo(g())},onHide:function(){c.sendGrabFocus()},onShow:function(){c.sendBlurFocus()}};return a}function g(){return WacConfig.FilePropertiesUrl+"&action="+WacConfig.OpenInClientAction}}})();(function(){var a=wLive.Core,b=wLive.Controls,f=a.AleHelpers.getPCString,e=0,c=".shareFormHandler";b.ShareFormHandler=d;function d(h,g,j){var k=this,d=jQuery(g),f=c+e++;d.bind(a.PostMessageHandler.WacShareFormEvent+f,i);k.dispose=function(){d.unbind(f)};function i(){a.BiciHelpers.reportClickAction("SF","WAC","WAC");$Do.wE("Bucket4.js",0,function(){var c=new a.PermissionsProvider(h.callerCid),d=new b.SendForm(c);d.show(j)})}}})();(function(){var c=wLive.Core,b=wLive.Controls,a=c.AleHelpers.getPCString,p=$B.rtl?"right":"left",o=$B.rtl?"left":"right",j=0,f='<div class="sd_pop_wrapper wac_permissions"><div class="sd_content"><div class="sd_datacontainer"><h2 class="sd_header"></h2><ul class="ips_list"></ul></div><br /><br /><div class="sd_btns"><input class="sd_shareMore default" type="button" /><input class="sd_done" type="button" /></div></div></div>',i=".shareHandler",n="Done",d="Office.Sharing.",h=a(d+"Done"),m=a("Cancel"),k=a(d+"ShareMore"),e=a(d+"CurrentPermissions"),g=false;b.ShareHandler=l;function l(B,r,m){var I=this,x=jQuery(r),C=i+j++,u=!m.isViewerOwner(),d,z=b.Notifications,J=z.getQueue(),K,p,L,A,l,s=false,o=false,w=m.invalidate;m.invalidate=function(){w&&w.apply(m);m._dataModel.getItem(m.key);if(d)t()};x.bind(c.PostMessageHandler.WacShareEvent+C,H);I.dispose=function(){x.unbind(C);m.invalidate=w};function H(){c.BiciHelpers.reportClickAction("SH","WAC","WAC");F()}function t(){var g=new c.PermissionsProvider(B.callerCid);g.fetchPermissions(m,function(f,a){if(!s&&d){var c=0;if(a&&a.permissionScopes)for(var b=0;b<a.permissionScopes.length;b++){var e=a.permissionScopes[b];if(e)c+=e.entities.length}if(c>0||u)D(g,a);else y(g)}},function(){var g=a("Sharing.GetPermissionsError"),c=jQuery('<div class="ips_error"></div>'),d=new b.InlineError(c,g);d.render();l=jQuery(f);l.find(".sd_header").text(e);l.find(".ips_list").hide();l.find(".sd_shareMore").hide();l.find(".sd_done").val(h).click(n);c.insertBefore(l.find(".ips_list"));q(l);v()},true)}function D(c,a){var p={render:t};l=jQuery(f);q(l);l.find(".sd_header").text(e);l.find(".sd_done").val(h).click(n);var i=l.find(".ips_list");sutra(i,"$Sutra.SkyDrive.InfoPaneSharingScopes");var s=a.permissionScopes,o=s.length;for(var b=0;b<o;b++){var g=a.permissionScopes[b],r=a.canChange&&g.id==m.id,j=new wLive.Controls.PermissionScopeControl(B,c,i,m,g,u,r,p);j.render(0)}var d=l.find(".sd_shareMore");if(!u)d.val(k).click(function(){y(c)});else d.remove();v();sutra(l.closest(".NoficicationBase.ModalDialog"),"$Sutra.SkyDrive.WacSharing");sutra(l.find(".sd_shareMore"),"$Sutra.SkyDrive.ShareWithMore")}function G(){if(!g){g=true;window.$Network.fetchCSS(FilesConfig.bucket3CssLocation,function(){$Do.register("Bucket3.css")})}}function y(a){G();$Do.wE("Bucket3.css",0,function(){var c=jQuery('<div class="sd_pop_wrapper"></div>');q(c);var d=new b.ShareDialog(c,a,m,n);d.render();v();s=true;sutra(c.closest(".ModalDialog"),"$Sutra.SkyDrive.WacSharing")})}function F(){if(d){d.dismiss();d=null}A=jQuery('<div style="min-height:270px;"></div>');d=z.createModalDialog({content:A[0]});var a=jQuery(d);a.bind({"beforeshow._dlg":function(){p=jQuery(".ModalDialog");p.hide()},"aftershow._dlg":function(){r.sendBlurFocus();t();jQuery(".UserArea").on("click",".sd_cancel",function(){n()});d&&d.reposition()},"afterdismiss._dlg":function(){jQuery(".UserArea").off("click",".sd_cancel");o=false;p.unbind("onclose._dlg");a&&a.unbind("._dlg");a=null;d=null},"buttonclick._dlg":E});d.show()}function v(){if(d&&!o){o=true;p.show()}}function E(){n();return true}function n(){if(d){d.dismiss();d=null}s=false;o=false;r.sendGrabFocus()}function q(a){if(d){jQuery(".UserContent").html(a);setTimeout(function(){d.reposition()},0)}}}})();(function(){var a=wLive.Core,b=wLive.Controls,d=0;b.EmbedHandler=e;var c=".embedHandler";function e(o,e,f){var q=this,i=jQuery(e),l=c+d++,g=a.PermissionsProvider,j=new g(o.callerCid),m=b.Embed;i.bind(a.PostMessageHandler.WacFileEmbedEvent+l,p);q.dispose=function(){i.unbind(l)};function p(){a.BiciHelpers.reportClickAction("EM","WAC","WAC");f.expire=function(){};f.invalidate=function(){};if(FilesConfig.shouldSendCanEmbed)j.fetchPermissions(f,n,h,true);else h()}function n(n,m){var b,j=m.permissionScopes;for(var f=0;f<j.length;f++){var l=j[f];if(a.StringHelpers.caseInsensitiveStringEquals(l.id,n.id)){var i=l.entities;for(var d=0;d<i.length;d++){var c=i[d];if(c.type==g.EntityType.Link&&c.linkType==g.LinkType.Embed){b=k(c);break}}break}}if(b)e.sendCanEmbed(b);else h()}function k(a){return a.link+"&em=2"}function h(){var d=function(){e.sendGrabFocus()},b=FilesConfig.shouldSendCanEmbed&&function(b){a.dispose();e.sendCanEmbed(k(b))},a=new m(j);e.sendBlurFocus();var c=f.commands.indexOf("em,2")!=-1;a.show(f,false,c,d,b)}}})()