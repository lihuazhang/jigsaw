/* Copyright (C) 2012 Microsoft Corporation */(function(){var h=window,c=h.jQuery,a=h.$Feedback={},d=$Config.fdbk,g,i,b,f,e,k='<div id="fdbk_ctr"><iframe id="fdbk_frame" style="display: none" frameborder="0" src="/handlers/feedback.mvc?scid={0}&hostdm={1}&params={2}{3}"></iframe></div>';a.showSurvey=function(b,h,d,c){e=c;f=d;$BSI.reportEvent("View.Feedback.Shown",{SurveyId:b});clearTimeout(i);j(b,h);g=setTimeout(a.onBadLoad,1e4)};a.hideSurvey=function(){if(a.modalDialog)a.modalDialog.hide();var b=function(a){return function(){if(a&&a.dismiss)a.dismiss()}};i=setTimeout(b(a.modalDialog),1e3)};a._surveySubmitted=function(){a.hideSurvey();if(f&&typeof f==="function")f()};a._showThankYou=function(){a._changeTitle(d.tyu)};a._changeTitle=function(a){if(b)b.find(".UserTitle").text(a)};a._surveyCancelled=function(){clearTimeout(g);a.hideSurvey();if(e&&typeof e==="function")e()};a.isSurveyHidden=function(){if(a.modalDialog)return a.modalDialog.isHidden();return null};a.doneLoading=function(l){clearTimeout(g);if(a.modalDialog){if(!b)b=c(a.modalDialog.content());b.find(".ButtonArea").css({display:"none"});var h=b.height(),f=b.find("#fdbk_frame").css({display:"block",opacity:0,border:0,width:"100%"}),d=0;l.each(function(){var a=c(this).height();d=a>d?a:d});var e=Math.min(d,465),k=b.find(".OuterContainer").addClass("moveAndResize"),m=c(window).height(),j={height:e+h,top:(m-(e+h))/2};k.height(j.height);b.addClass("moveAndResize").css(j);var i=function(a){f.css({height:e,opacity:1});f.focus();if(a)wLive.Animations.fadeIn(f)};if(wLive.Animations.Enabled)setTimeout(function(){i(true)},367);else i(false)}};a.onBadLoad=function(){if(b){b.find(".UserTitle").text(d.errHd);b.find(".UserContent").text(d.errTxt)}$BSI.reportEvent("Log.WL.ErrorDisplayed",{WLErrorProduct:$Config.prop,WLErrorCode:"Feedback"})};function j(n,h){var j=wLive.Controls.Notifications,e=h&&h.join?h:[],g=l(d.clbk);if(g&&typeof g==="function"){var i=g();e=i?e.concat(i):e}var m=encodeURIComponent(e.join(",").substr(0,1e3));if(a.modalDialog&&a.modalDialog.dismiss)a.modalDialog.dismiss();var f="&theme=";if(window.$theme&&$theme.current)f+=$theme.current;else if($Config.Themes&&$Config.Themes.current)f+=$Config.Themes.current;else f="";a.modalDialog=j.createModalDialog({content:k.format(n,document.domain,m,f),title:$f.createLoading({text:d.ldHd}),buttons:{action:d.cb}});b=null;c(a.modalDialog).bind({"aftershow.dialog":function(){b=c(a.modalDialog.content())},"buttonclick.dialog":a._surveyCancelled});a.modalDialog.show();j.getQueue().start()}function l(b){if(b){var a=null;c.each(b.split("."),function(c,b){a=a?a[b]:h[b];if(!a)return false});return a}}})()